[0m08:28:02.913601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086aa090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d3ef0>]}


============================== 08:28:02.916013 | b7cdea77-724a-40ae-a46a-c7d8c4eda9bf ==============================
[0m08:28:02.916013 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:28:02.916258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'profiles_dir': '/Users/williampetrosino/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init nyc_yellow_taxi', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:28:02.924498 [debug] [MainThread]: Starter project path: /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/include/starter_project
[0m08:28:02.927253 [info ] [MainThread]: 
Your new dbt project "nyc_yellow_taxi" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m08:28:02.927397 [info ] [MainThread]: Setting up your profile.
[0m08:28:02.929332 [error] [MainThread]: Encountered an error:

[0m08:28:02.931215 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 346, in run
    self.setup_profile(profile_name)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 248, in setup_profile
    if not self.check_if_can_write_profile(profile_name=profile_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 211, in check_if_can_write_profile
    response = click.confirm(
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/click/termui.py", line 235, in confirm
    raise Abort() from None
click.exceptions.Abort

[0m08:28:02.932213 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 0.060763333, "process_in_blocks": "0", "process_kernel_time": 0.09169, "process_mem_max_rss": "94404608", "process_out_blocks": "0", "process_user_time": 0.479419}
[0m08:28:02.932483 [debug] [MainThread]: Command `dbt init` failed at 08:28:02.932436 after 0.06 seconds
[0m08:28:02.932664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e38140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084111c0>]}
[0m08:28:02.932856 [debug] [MainThread]: Flushing usage events
[0m08:28:03.111436 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:28:50.667937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107164860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a96630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a96210>]}


============================== 08:28:50.669784 | 38228b91-6378-43fb-bfc3-69228223eb5d ==============================
[0m08:28:50.669784 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:28:50.670032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt init nyc_yellow_taxi', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:28:50.673876 [debug] [MainThread]: Starter project path: /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/include/starter_project
[0m08:28:50.676033 [info ] [MainThread]: 
Your new dbt project "nyc_yellow_taxi" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m08:28:50.676179 [info ] [MainThread]: Setting up your profile.
[0m08:28:50.677994 [error] [MainThread]: Encountered an error:

[0m08:28:50.678808 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 346, in run
    self.setup_profile(profile_name)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 248, in setup_profile
    if not self.check_if_can_write_profile(profile_name=profile_name):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 211, in check_if_can_write_profile
    response = click.confirm(
               ^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/click/termui.py", line 235, in confirm
    raise Abort() from None
click.exceptions.Abort

[0m08:28:50.679546 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 0.050536916, "process_in_blocks": "0", "process_kernel_time": 0.076122, "process_mem_max_rss": "94961664", "process_out_blocks": "0", "process_user_time": 0.466908}
[0m08:28:50.679794 [debug] [MainThread]: Command `dbt init` failed at 08:28:50.679753 after 0.05 seconds
[0m08:28:50.679964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107164860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071648c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c2c60>]}
[0m08:28:50.680130 [debug] [MainThread]: Flushing usage events
[0m08:28:50.827684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:30.715853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108822210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e30b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e32300>]}


============================== 08:36:30.718296 | 7edd8631-79f6-42e0-9c4f-5624e8b5aae2 ==============================
[0m08:36:30.718296 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:36:30.718597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init nyc_yellow_taxi', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:36:30.725445 [debug] [MainThread]: Starter project path: /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/include/starter_project
[0m08:36:30.728147 [info ] [MainThread]: 
Your new dbt project "nyc_yellow_taxi" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m08:36:30.728302 [info ] [MainThread]: Setting up your profile.
[0m08:36:55.333193 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 24.656599, "process_in_blocks": "0", "process_kernel_time": 0.100961, "process_mem_max_rss": "102203392", "process_out_blocks": "0", "process_user_time": 0.516798}
[0m08:36:55.333558 [debug] [MainThread]: Command `dbt init` succeeded at 08:36:55.333495 after 24.66 seconds
[0m08:36:55.333762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a5b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108822210>]}
[0m08:36:55.333950 [debug] [MainThread]: Flushing usage events
[0m08:36:55.519051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:21.761926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106501340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bc0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121bc0110>]}


============================== 08:39:21.763858 | b8a20e21-3650-41ff-b31e-a3546acd4b5d ==============================
[0m08:39:21.763858 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:39:21.764116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/Users/williampetrosino/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt init nyc_yellow_taxi', 'send_anonymous_usage_stats': 'True'}
[0m08:39:21.767919 [info ] [MainThread]: A project called nyc_yellow_taxi already exists here.
[0m08:39:21.768623 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 0.045409, "process_in_blocks": "0", "process_kernel_time": 0.075696, "process_mem_max_rss": "96092160", "process_out_blocks": "0", "process_user_time": 0.469689}
[0m08:39:21.768842 [debug] [MainThread]: Command `dbt init` succeeded at 08:39:21.768803 after 0.05 seconds
[0m08:39:21.768996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121931c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121a52600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121b8ff20>]}
[0m08:39:21.769143 [debug] [MainThread]: Flushing usage events
[0m08:39:21.933899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:39:49.358835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e65f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec0110>]}


============================== 08:39:49.360682 | bfe2a52b-52c7-4571-b55c-9bfdb2db91c7 ==============================
[0m08:39:49.360682 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:39:49.360928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt init nyc_yellow_taxi', 'send_anonymous_usage_stats': 'True'}
[0m08:39:49.364771 [debug] [MainThread]: Starter project path: /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/include/starter_project
[0m08:39:49.366867 [info ] [MainThread]: 
Your new dbt project "nyc_yellow_taxi" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m08:39:49.367008 [info ] [MainThread]: Setting up your profile.
[0m08:39:49.367283 [error] [MainThread]: Encountered an error:

[0m08:39:49.369379 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 477, in init
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 346, in run
    self.setup_profile(profile_name)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/init.py", line 242, in ask_for_adapter_choice
    numeric_choice = click.prompt(prompt_msg, type=click.INT)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m08:39:49.370216 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 0.050290626, "process_in_blocks": "0", "process_kernel_time": 0.074006, "process_mem_max_rss": "94519296", "process_out_blocks": "0", "process_user_time": 0.467196}
[0m08:39:49.370474 [debug] [MainThread]: Command `dbt init` failed at 08:39:49.370427 after 0.05 seconds
[0m08:39:49.370662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065574a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec1c40>]}
[0m08:39:49.370836 [debug] [MainThread]: Flushing usage events
[0m08:39:49.516888 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:41:13.329855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dff2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f2a420>]}


============================== 08:41:13.331709 | bba22ca3-6105-4139-813f-11b1aad9fb8d ==============================
[0m08:41:13.331709 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:41:13.331961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/williampetrosino/.dbt', 'log_path': 'logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt init nyc_yellow_taxi', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:41:13.335606 [debug] [MainThread]: Starter project path: /Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/include/starter_project
[0m08:41:13.337741 [info ] [MainThread]: 
Your new dbt project "nyc_yellow_taxi" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m08:41:13.337893 [info ] [MainThread]: Setting up your profile.
[0m08:41:15.636114 [info ] [MainThread]: Profile nyc_yellow_taxi written to /Users/williampetrosino/.dbt/profiles.yml using target's sample configuration. Once updated, you'll be able to start developing with dbt.
[0m08:41:15.637030 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 2.3445172, "process_in_blocks": "0", "process_kernel_time": 0.083139, "process_mem_max_rss": "100597760", "process_out_blocks": "0", "process_user_time": 0.51562}
[0m08:41:15.637335 [debug] [MainThread]: Command `dbt init` succeeded at 08:41:15.637272 after 2.34 seconds
[0m08:41:15.637544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dff2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041775c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8ec60>]}
[0m08:41:15.637748 [debug] [MainThread]: Flushing usage events
[0m08:41:15.826271 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:48.406805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a89ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc0320>]}


============================== 09:55:48.409036 | d426d612-f82d-47b4-8f2a-0ba4527f379c ==============================
[0m09:55:48.409036 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:55:48.409283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:55:48.512515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a6240>]}
[0m09:55:48.531168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8ec60>]}
[0m09:55:48.533072 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:55:48.574180 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:55:48.574548 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:55:48.574698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd1c40>]}
[0m09:55:48.952925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d94f0>]}
[0m09:55:48.977592 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m09:55:48.978664 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m09:55:48.989124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068396a0>]}
[0m09:55:48.989363 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m09:55:48.989513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c65bb0>]}
[0m09:55:48.990255 [info ] [MainThread]: 
[0m09:55:48.990411 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:55:48.990525 [info ] [MainThread]: 
[0m09:55:48.990724 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:55:48.992507 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m09:55:49.039326 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m09:55:49.039570 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m09:55:49.039696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:49.046544 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m09:55:49.047396 [debug] [ThreadPool]: On list_dbt: Close
[0m09:55:49.048374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m09:55:49.048569 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m09:55:49.051110 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m09:55:49.051240 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m09:55:49.051350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:49.055443 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:55:49.055964 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m09:55:49.056081 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m09:55:49.056240 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:55:49.056339 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m09:55:49.056438 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m09:55:49.056652 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:55:49.057010 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m09:55:49.057120 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m09:55:49.057216 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m09:55:49.057360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:55:49.057462 [debug] [ThreadPool]: On create_dbt_main: Close
[0m09:55:49.058559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m09:55:49.060600 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m09:55:49.060710 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m09:55:49.060817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:49.064497 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:55:49.064614 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m09:55:49.064724 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m09:55:49.071948 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m09:55:49.072480 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m09:55:49.073299 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m09:55:49.073419 [debug] [ThreadPool]: On list_dbt_main: Close
[0m09:55:49.074335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067bd640>]}
[0m09:55:49.074515 [debug] [MainThread]: Using duckdb connection "master"
[0m09:55:49.074623 [debug] [MainThread]: On master: BEGIN
[0m09:55:49.074721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:55:49.078586 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m09:55:49.078705 [debug] [MainThread]: On master: COMMIT
[0m09:55:49.078809 [debug] [MainThread]: Using duckdb connection "master"
[0m09:55:49.078908 [debug] [MainThread]: On master: COMMIT
[0m09:55:49.079058 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:55:49.079160 [debug] [MainThread]: On master: Close
[0m09:55:49.080266 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m09:55:49.080479 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m09:55:49.080661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m09:55:49.080807 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m09:55:49.083697 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:55:49.084143 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m09:55:49.096034 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:55:49.096502 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:55:49.096640 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m09:55:49.096755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:49.100693 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:55:49.100842 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:55:49.100975 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m09:55:49.103165 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:55:49.105906 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:55:49.106099 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:55:49.106935 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:49.111928 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m09:55:49.112098 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:55:49.112224 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m09:55:49.113342 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:49.115031 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:55:49.115166 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:55:49.115383 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:55:49.116288 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m09:55:49.118719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10321d700>]}
[0m09:55:49.118981 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m09:55:49.119198 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m09:55:49.119363 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m09:55:49.119648 [info ] [Thread-1 (]: 2 of 3 START sql view model main.taxi_rides_raw ................................ [RUN]
[0m09:55:49.119860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m09:55:49.120006 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m09:55:49.120758 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:55:49.121177 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m09:55:49.128821 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:55:49.129214 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:55:49.129351 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m09:55:49.129471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:49.133635 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:55:49.133822 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:55:49.133969 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
  create view "dbt"."main"."taxi_rides_raw__dbt_tmp" as (
    with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
  );

[0m09:55:50.378809 [debug] [Thread-1 (]: SQL status: OK in 1.244 seconds
[0m09:55:50.384698 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:55:50.385401 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter view "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m09:55:50.386404 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:50.388026 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m09:55:50.388440 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:55:50.388810 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m09:55:50.390414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:55:50.392631 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:55:50.392986 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop view if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m09:55:50.393517 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:55:50.394743 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m09:55:50.397337 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063c9550>]}
[0m09:55:50.397972 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.taxi_rides_raw ........................... [[32mOK[0m in 1.28s]
[0m09:55:50.398440 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m09:55:50.398764 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m09:55:50.399160 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m09:55:50.399495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m09:55:50.399769 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m09:55:50.401841 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:55:50.402302 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m09:55:50.404202 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:55:50.404620 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:55:50.404847 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m09:55:50.405059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:50.411615 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m09:55:50.411879 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:55:50.412200 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m09:55:50.412800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:55:50.414424 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:55:50.414647 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:55:50.414986 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:55:50.415835 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m09:55:50.416054 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:55:50.416242 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m09:55:50.416735 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:55:50.417776 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:55:50.417970 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m09:55:50.418240 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:55:50.418871 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m09:55:50.420367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd426d612-f82d-47b4-8f2a-0ba4527f379c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106553bf0>]}
[0m09:55:50.420692 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m09:55:50.420967 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m09:55:50.421656 [debug] [MainThread]: Using duckdb connection "master"
[0m09:55:50.421901 [debug] [MainThread]: On master: BEGIN
[0m09:55:50.422067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:55:50.427504 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m09:55:50.427712 [debug] [MainThread]: On master: COMMIT
[0m09:55:50.427861 [debug] [MainThread]: Using duckdb connection "master"
[0m09:55:50.427997 [debug] [MainThread]: On master: COMMIT
[0m09:55:50.428189 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:55:50.428326 [debug] [MainThread]: On master: Close
[0m09:55:50.429321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:50.429490 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m09:55:50.429674 [info ] [MainThread]: 
[0m09:55:50.429836 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m09:55:50.430251 [debug] [MainThread]: Command end result
[0m09:55:50.439625 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m09:55:50.440536 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m09:55:50.442991 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m09:55:50.443130 [info ] [MainThread]: 
[0m09:55:50.443283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:55:50.443404 [info ] [MainThread]: 
[0m09:55:50.443538 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:55:50.444612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0786119, "process_in_blocks": "0", "process_kernel_time": 0.211124, "process_mem_max_rss": "151355392", "process_out_blocks": "0", "process_user_time": 1.283111}
[0m09:55:50.444859 [debug] [MainThread]: Command `dbt run` succeeded at 09:55:50.444817 after 2.08 seconds
[0m09:55:50.445034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d8dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106707260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106707950>]}
[0m09:55:50.445198 [debug] [MainThread]: Flushing usage events
[0m09:55:50.629053 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:32.290829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a93d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c05c0>]}


============================== 09:59:32.293397 | 78ca412f-27b2-4122-9508-a1e09f9853a0 ==============================
[0m09:59:32.293397 [info ] [MainThread]: Running with dbt=1.9.2
[0m09:59:32.293675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:59:32.393520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054aa120>]}
[0m09:59:32.411865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054589b0>]}
[0m09:59:32.413859 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m09:59:32.455755 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m09:59:32.498414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:59:32.498666 [debug] [MainThread]: Partial parsing: updated file: nyc_yellow_taxi://models/taxi_rides/taxi_rides_raw.sql
[0m09:59:32.580461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105902cc0>]}
[0m09:59:32.604174 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m09:59:32.605196 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m09:59:32.615778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cc9b0>]}
[0m09:59:32.616005 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m09:59:32.616148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550b050>]}
[0m09:59:32.616877 [info ] [MainThread]: 
[0m09:59:32.617029 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:59:32.617143 [info ] [MainThread]: 
[0m09:59:32.617354 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:59:32.619115 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m09:59:32.643637 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m09:59:32.643876 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m09:59:32.644001 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:59:32.690233 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m09:59:32.690874 [debug] [ThreadPool]: On list_dbt: Close
[0m09:59:32.692670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m09:59:32.692901 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m09:59:32.695463 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m09:59:32.695596 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m09:59:32.695702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:32.699782 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:59:32.700307 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m09:59:32.700417 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m09:59:32.700575 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:59:32.700681 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m09:59:32.700792 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m09:59:32.701015 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:59:32.701336 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m09:59:32.701446 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m09:59:32.701541 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m09:59:32.701681 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:59:32.701795 [debug] [ThreadPool]: On create_dbt_main: Close
[0m09:59:32.702799 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m09:59:32.704914 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m09:59:32.705041 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m09:59:32.705137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:59:32.708894 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m09:59:32.709005 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m09:59:32.709114 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m09:59:32.717603 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m09:59:32.718181 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m09:59:32.718948 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m09:59:32.719080 [debug] [ThreadPool]: On list_dbt_main: Close
[0m09:59:32.720254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105484410>]}
[0m09:59:32.720467 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:32.720599 [debug] [MainThread]: On master: BEGIN
[0m09:59:32.720698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:59:32.724631 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m09:59:32.724788 [debug] [MainThread]: On master: COMMIT
[0m09:59:32.724911 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:32.725021 [debug] [MainThread]: On master: COMMIT
[0m09:59:32.725169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:59:32.725283 [debug] [MainThread]: On master: Close
[0m09:59:32.726429 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m09:59:32.726745 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m09:59:32.726921 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m09:59:32.727061 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m09:59:32.729812 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:59:32.730113 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m09:59:32.741849 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:59:32.742192 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:59:32.742321 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m09:59:32.742439 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:32.746372 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:59:32.746525 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:59:32.746659 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m09:59:32.747734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:32.749992 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:59:32.750129 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m09:59:32.750386 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:32.751319 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:59:32.751445 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m09:59:32.751645 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:32.757584 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m09:59:32.757806 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:59:32.757937 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m09:59:32.758889 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:59:32.760533 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m09:59:32.760665 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m09:59:32.760964 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:32.761947 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m09:59:32.764333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104142630>]}
[0m09:59:32.764600 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m09:59:32.764813 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m09:59:32.764979 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m09:59:32.765233 [info ] [Thread-1 (]: 2 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m09:59:32.765422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m09:59:32.765569 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m09:59:32.766495 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:59:32.766736 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m09:59:32.768548 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:59:32.768813 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:59:32.768941 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m09:59:32.769056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:32.773166 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:59:32.773345 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:59:32.773476 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m09:59:33.858679 [debug] [Thread-1 (]: SQL status: OK in 1.085 seconds
[0m09:59:33.859960 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:59:33.860114 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter view "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m09:59:33.860433 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:33.861390 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:59:33.861526 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m09:59:33.861763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:33.862336 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m09:59:33.862469 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:59:33.862597 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m09:59:33.866119 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m09:59:33.866906 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m09:59:33.867034 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop view if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m09:59:33.867408 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:33.867955 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m09:59:33.876395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e2660>]}
[0m09:59:33.876773 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.11s]
[0m09:59:33.877006 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m09:59:33.877178 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m09:59:33.877397 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m09:59:33.877584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m09:59:33.877728 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m09:59:33.878882 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:59:33.879184 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m09:59:33.885863 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:59:33.886148 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:59:33.886277 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m09:59:33.886393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:59:33.890924 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m09:59:33.891155 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:59:33.891310 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m09:59:33.891631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:33.892779 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:59:33.892914 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m09:59:33.893136 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:33.894111 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:59:33.894240 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m09:59:33.894449 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:33.894990 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m09:59:33.895118 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:59:33.895233 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m09:59:33.895583 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:33.896341 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m09:59:33.896467 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m09:59:33.896709 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:59:33.897153 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m09:59:33.901097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78ca412f-27b2-4122-9508-a1e09f9853a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c36cc0>]}
[0m09:59:33.901393 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m09:59:33.901612 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m09:59:33.902098 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:33.902236 [debug] [MainThread]: On master: BEGIN
[0m09:59:33.902349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:59:33.906740 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m09:59:33.906981 [debug] [MainThread]: On master: COMMIT
[0m09:59:33.907124 [debug] [MainThread]: Using duckdb connection "master"
[0m09:59:33.907246 [debug] [MainThread]: On master: COMMIT
[0m09:59:33.907445 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:59:33.907617 [debug] [MainThread]: On master: Close
[0m09:59:33.908593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:59:33.908748 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m09:59:33.908908 [info ] [MainThread]: 
[0m09:59:33.909046 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m09:59:33.909415 [debug] [MainThread]: Command end result
[0m09:59:33.916982 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m09:59:33.917632 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m09:59:33.919748 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m09:59:33.919871 [info ] [MainThread]: 
[0m09:59:33.920010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:59:33.920123 [info ] [MainThread]: 
[0m09:59:33.920251 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m09:59:33.921144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.670103, "process_in_blocks": "0", "process_kernel_time": 0.322886, "process_mem_max_rss": "522633216", "process_out_blocks": "0", "process_user_time": 2.504063}
[0m09:59:33.921338 [debug] [MainThread]: Command `dbt run` succeeded at 09:59:33.921305 after 1.67 seconds
[0m09:59:33.921483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c08c0>]}
[0m09:59:33.921624 [debug] [MainThread]: Flushing usage events
[0m09:59:34.410930 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:07.285140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106235340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659c2c0>]}


============================== 17:37:07.287665 | f39e755f-de3e-479f-a8dd-aafd48683360 ==============================
[0m17:37:07.287665 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:37:07.287963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:37:07.295376 [info ] [MainThread]: dbt version: 1.9.2
[0m17:37:07.295542 [info ] [MainThread]: python version: 3.12.3
[0m17:37:07.295670 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
[0m17:37:07.295785 [info ] [MainThread]: os info: macOS-15.3.1-arm64-arm-64bit
[0m17:37:07.358003 [info ] [MainThread]: Using profiles dir at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi
[0m17:37:07.358235 [info ] [MainThread]: Using profiles.yml file at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/profiles.yml
[0m17:37:07.358373 [info ] [MainThread]: Using dbt_project.yml file at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/dbt_project.yml
[0m17:37:07.359905 [info ] [MainThread]: adapter type: duckdb
[0m17:37:07.360036 [info ] [MainThread]: adapter version: 1.9.1
[0m17:37:07.391193 [info ] [MainThread]: Configuration:
[0m17:37:07.391472 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:37:07.391604 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:37:07.391732 [info ] [MainThread]: Required dependencies:
[0m17:37:07.391901 [debug] [MainThread]: Executing "git --help"
[0m17:37:07.400431 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:37:07.400842 [debug] [MainThread]: STDERR: "b''"
[0m17:37:07.400991 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:37:07.401123 [info ] [MainThread]: Connection:
[0m17:37:07.401261 [info ] [MainThread]:   database: dbt
[0m17:37:07.401372 [info ] [MainThread]:   schema: main
[0m17:37:07.401477 [info ] [MainThread]:   path: dbt.duckdb
[0m17:37:07.401587 [info ] [MainThread]:   config_options: None
[0m17:37:07.401688 [info ] [MainThread]:   extensions: None
[0m17:37:07.401797 [info ] [MainThread]:   settings: {}
[0m17:37:07.401900 [info ] [MainThread]:   external_root: .
[0m17:37:07.402002 [info ] [MainThread]:   use_credential_provider: None
[0m17:37:07.402108 [info ] [MainThread]:   attach: None
[0m17:37:07.402208 [info ] [MainThread]:   filesystems: None
[0m17:37:07.402309 [info ] [MainThread]:   remote: None
[0m17:37:07.402414 [info ] [MainThread]:   plugins: None
[0m17:37:07.402650 [info ] [MainThread]:   disable_transactions: False
[0m17:37:07.403593 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:37:07.452809 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m17:37:07.474323 [debug] [MainThread]: Using duckdb connection "debug"
[0m17:37:07.474497 [debug] [MainThread]: On debug: select 1 as id
[0m17:37:07.474607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:07.519157 [debug] [MainThread]: SQL status: OK in 0.045 seconds
[0m17:37:07.519683 [debug] [MainThread]: On debug: Close
[0m17:37:07.521327 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:37:07.521515 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:37:07.522235 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.27609387, "process_in_blocks": "0", "process_kernel_time": 0.14085, "process_mem_max_rss": "121061376", "process_out_blocks": "0", "process_user_time": 0.611079}
[0m17:37:07.522490 [debug] [MainThread]: Command `dbt debug` succeeded at 17:37:07.522442 after 0.28 seconds
[0m17:37:07.522646 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:37:07.522812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d31a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068042f0>]}
[0m17:37:07.523009 [debug] [MainThread]: Flushing usage events
[0m17:37:07.680742 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:37:16.892220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ca570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104730950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104730470>]}


============================== 17:37:16.894029 | e4160fd9-bf8f-4dae-be02-94f77e02c874 ==============================
[0m17:37:16.894029 [info ] [MainThread]: Running with dbt=1.9.2
[0m17:37:16.894280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:37:16.988299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047f3290>]}
[0m17:37:17.006645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041decf0>]}
[0m17:37:17.007996 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m17:37:17.048054 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m17:37:17.092166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:37:17.092371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:37:17.105728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be1c70>]}
[0m17:37:17.129979 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m17:37:17.130724 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m17:37:17.138212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc4230>]}
[0m17:37:17.138449 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m17:37:17.138598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da40e0>]}
[0m17:37:17.139363 [info ] [MainThread]: 
[0m17:37:17.139516 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:37:17.139632 [info ] [MainThread]: 
[0m17:37:17.139843 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:37:17.141609 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m17:37:17.159874 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m17:37:17.160076 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m17:37:17.160197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:17.167020 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m17:37:17.167619 [debug] [ThreadPool]: On list_dbt: Close
[0m17:37:17.168588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m17:37:17.168796 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m17:37:17.171287 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m17:37:17.171450 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m17:37:17.171572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:17.175673 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:37:17.176189 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m17:37:17.176303 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m17:37:17.176468 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:17.176562 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m17:37:17.176662 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m17:37:17.176866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:17.177146 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m17:37:17.177252 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m17:37:17.177348 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m17:37:17.177492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:17.177594 [debug] [ThreadPool]: On create_dbt_main: Close
[0m17:37:17.178651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m17:37:17.180722 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m17:37:17.180866 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m17:37:17.180972 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:17.185271 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m17:37:17.185405 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m17:37:17.185518 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m17:37:17.193963 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:37:17.194522 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m17:37:17.195266 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m17:37:17.195381 [debug] [ThreadPool]: On list_dbt_main: Close
[0m17:37:17.196603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db7ef0>]}
[0m17:37:17.196806 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:17.196918 [debug] [MainThread]: On master: BEGIN
[0m17:37:17.197020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:17.200841 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m17:37:17.200983 [debug] [MainThread]: On master: COMMIT
[0m17:37:17.201102 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:17.201210 [debug] [MainThread]: On master: COMMIT
[0m17:37:17.201395 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:17.201568 [debug] [MainThread]: On master: Close
[0m17:37:17.202717 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m17:37:17.203015 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m17:37:17.203200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m17:37:17.203340 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m17:37:17.206223 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m17:37:17.206724 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m17:37:17.219280 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m17:37:17.219642 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m17:37:17.219775 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m17:37:17.219894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:17.224402 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:37:17.224639 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m17:37:17.224796 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m17:37:17.226021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:37:17.228427 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m17:37:17.228573 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:37:17.228829 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:17.229806 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m17:37:17.229934 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:37:17.230137 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:17.235543 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m17:37:17.235684 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m17:37:17.235802 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m17:37:17.236677 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:37:17.238478 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m17:37:17.238637 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m17:37:17.238976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:17.239982 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m17:37:17.245175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105101460>]}
[0m17:37:17.245463 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m17:37:17.245703 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m17:37:17.245863 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m17:37:17.246084 [info ] [Thread-1 (]: 2 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m17:37:17.246319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m17:37:17.246494 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m17:37:17.247508 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m17:37:17.247770 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m17:37:17.248865 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m17:37:17.249122 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m17:37:17.249261 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m17:37:17.249383 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:17.253513 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:37:17.253670 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m17:37:17.253816 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m17:37:19.203614 [debug] [Thread-1 (]: SQL status: OK in 1.950 seconds
[0m17:37:19.204901 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m17:37:19.205053 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m17:37:19.205369 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:19.206296 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m17:37:19.206449 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m17:37:19.206700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:19.207265 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m17:37:19.207388 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m17:37:19.207499 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m17:37:19.232588 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m17:37:19.233552 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m17:37:19.233696 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m17:37:19.234310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:19.234802 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m17:37:19.244210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051dd640>]}
[0m17:37:19.244558 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 2.00s]
[0m17:37:19.244788 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m17:37:19.244952 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m17:37:19.245163 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m17:37:19.245360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m17:37:19.245512 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m17:37:19.246619 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m17:37:19.247202 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m17:37:19.254429 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m17:37:19.254875 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m17:37:19.255006 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m17:37:19.255122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:19.259839 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m17:37:19.260067 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m17:37:19.260212 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m17:37:19.260490 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:19.261599 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m17:37:19.261729 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m17:37:19.261957 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:19.262904 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m17:37:19.263032 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:37:19.263225 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:19.263749 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m17:37:19.263869 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m17:37:19.263980 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m17:37:19.264354 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:19.265147 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m17:37:19.265276 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m17:37:19.265526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:19.265998 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m17:37:19.270011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4160fd9-bf8f-4dae-be02-94f77e02c874', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054500e0>]}
[0m17:37:19.270259 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m17:37:19.270476 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m17:37:19.270950 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:19.271077 [debug] [MainThread]: On master: BEGIN
[0m17:37:19.271185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:37:19.275802 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m17:37:19.276324 [debug] [MainThread]: On master: COMMIT
[0m17:37:19.276452 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:19.276560 [debug] [MainThread]: On master: COMMIT
[0m17:37:19.276723 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:19.276841 [debug] [MainThread]: On master: Close
[0m17:37:19.277698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:19.277825 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m17:37:19.277969 [info ] [MainThread]: 
[0m17:37:19.278098 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m17:37:19.278463 [debug] [MainThread]: Command end result
[0m17:37:19.285757 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m17:37:19.286482 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m17:37:19.288657 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m17:37:19.288783 [info ] [MainThread]: 
[0m17:37:19.288930 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:37:19.289051 [info ] [MainThread]: 
[0m17:37:19.289183 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:37:19.290021 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.436767, "process_in_blocks": "0", "process_kernel_time": 0.357647, "process_mem_max_rss": "520536064", "process_out_blocks": "0", "process_user_time": 2.460753}
[0m17:37:19.290292 [debug] [MainThread]: Command `dbt run` succeeded at 17:37:19.290251 after 2.44 seconds
[0m17:37:19.290469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104065a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104730800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047306b0>]}
[0m17:37:19.290629 [debug] [MainThread]: Flushing usage events
[0m17:37:19.436735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:31:11.407501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10435ff20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ffe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048fffb0>]}


============================== 06:31:11.410146 | 0730f288-8b18-480c-8063-835fae8672a7 ==============================
[0m06:31:11.410146 [info ] [MainThread]: Running with dbt=1.9.2
[0m06:31:11.410414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:31:11.418236 [info ] [MainThread]: dbt version: 1.9.2
[0m06:31:11.418408 [info ] [MainThread]: python version: 3.12.3
[0m06:31:11.418535 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
[0m06:31:11.418649 [info ] [MainThread]: os info: macOS-15.3.1-arm64-arm-64bit
[0m06:31:11.482258 [info ] [MainThread]: Using profiles dir at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi
[0m06:31:11.482523 [info ] [MainThread]: Using profiles.yml file at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/profiles.yml
[0m06:31:11.482650 [info ] [MainThread]: Using dbt_project.yml file at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/dbt_project.yml
[0m06:31:11.484298 [info ] [MainThread]: adapter type: duckdb
[0m06:31:11.484471 [info ] [MainThread]: adapter version: 1.9.1
[0m06:31:11.516108 [info ] [MainThread]: Configuration:
[0m06:31:11.516355 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m06:31:11.516486 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m06:31:11.516611 [info ] [MainThread]: Required dependencies:
[0m06:31:11.516780 [debug] [MainThread]: Executing "git --help"
[0m06:31:11.525319 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m06:31:11.525741 [debug] [MainThread]: STDERR: "b''"
[0m06:31:11.525888 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m06:31:11.526015 [info ] [MainThread]: Connection:
[0m06:31:11.526148 [info ] [MainThread]:   database: dbt
[0m06:31:11.526260 [info ] [MainThread]:   schema: main
[0m06:31:11.526364 [info ] [MainThread]:   path: dbt.duckdb
[0m06:31:11.526468 [info ] [MainThread]:   config_options: None
[0m06:31:11.526577 [info ] [MainThread]:   extensions: None
[0m06:31:11.526681 [info ] [MainThread]:   settings: {}
[0m06:31:11.526786 [info ] [MainThread]:   external_root: .
[0m06:31:11.526885 [info ] [MainThread]:   use_credential_provider: None
[0m06:31:11.526989 [info ] [MainThread]:   attach: None
[0m06:31:11.527091 [info ] [MainThread]:   filesystems: None
[0m06:31:11.527190 [info ] [MainThread]:   remote: None
[0m06:31:11.527293 [info ] [MainThread]:   plugins: None
[0m06:31:11.527395 [info ] [MainThread]:   disable_transactions: False
[0m06:31:11.527721 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:31:11.567360 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m06:31:11.592875 [debug] [MainThread]: Using duckdb connection "debug"
[0m06:31:11.596324 [debug] [MainThread]: On debug: select 1 as id
[0m06:31:11.596471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:31:11.642862 [debug] [MainThread]: SQL status: OK in 0.046 seconds
[0m06:31:11.643385 [debug] [MainThread]: On debug: Close
[0m06:31:11.645139 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m06:31:11.645310 [info ] [MainThread]: [32mAll checks passed![0m
[0m06:31:11.646048 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.27884167, "process_in_blocks": "0", "process_kernel_time": 0.146131, "process_mem_max_rss": "121847808", "process_out_blocks": "0", "process_user_time": 0.610612}
[0m06:31:11.646297 [debug] [MainThread]: Command `dbt debug` succeeded at 06:31:11.646251 after 0.28 seconds
[0m06:31:11.646448 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m06:31:11.646607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a481a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f50380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104947ec0>]}
[0m06:31:11.646790 [debug] [MainThread]: Flushing usage events
[0m06:31:11.836867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:31:18.388341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ead490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114bcb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114bc680>]}


============================== 06:31:18.390202 | d1647a27-023b-478f-a536-a71c0636fe11 ==============================
[0m06:31:18.390202 [info ] [MainThread]: Running with dbt=1.9.2
[0m06:31:18.390459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:31:18.484100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111808230>]}
[0m06:31:18.502877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d38c0>]}
[0m06:31:18.504244 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m06:31:18.545552 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m06:31:18.589841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:31:18.590037 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:31:18.603265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11160f5c0>]}
[0m06:31:18.627488 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m06:31:18.628349 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m06:31:18.635409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119dc8c0>]}
[0m06:31:18.635622 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m06:31:18.635770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161da90>]}
[0m06:31:18.636522 [info ] [MainThread]: 
[0m06:31:18.636671 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:31:18.636787 [info ] [MainThread]: 
[0m06:31:18.636997 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m06:31:18.638833 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m06:31:18.656996 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m06:31:18.657212 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m06:31:18.657333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:31:18.664509 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m06:31:18.665169 [debug] [ThreadPool]: On list_dbt: Close
[0m06:31:18.666164 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m06:31:18.666401 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m06:31:18.668977 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m06:31:18.669119 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m06:31:18.669227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:31:18.673514 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m06:31:18.674016 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m06:31:18.674132 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m06:31:18.674290 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:31:18.674386 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m06:31:18.674486 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m06:31:18.674698 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:31:18.674978 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m06:31:18.675098 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m06:31:18.675194 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m06:31:18.675350 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m06:31:18.675456 [debug] [ThreadPool]: On create_dbt_main: Close
[0m06:31:18.676599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m06:31:18.678716 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m06:31:18.678840 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m06:31:18.678958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:31:18.683088 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m06:31:18.683213 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m06:31:18.683324 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m06:31:18.691708 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m06:31:18.692298 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m06:31:18.693060 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m06:31:18.693189 [debug] [ThreadPool]: On list_dbt_main: Close
[0m06:31:18.694420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161f230>]}
[0m06:31:18.694627 [debug] [MainThread]: Using duckdb connection "master"
[0m06:31:18.694759 [debug] [MainThread]: On master: BEGIN
[0m06:31:18.694872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:31:18.698917 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m06:31:18.699066 [debug] [MainThread]: On master: COMMIT
[0m06:31:18.699190 [debug] [MainThread]: Using duckdb connection "master"
[0m06:31:18.699300 [debug] [MainThread]: On master: COMMIT
[0m06:31:18.699488 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m06:31:18.699672 [debug] [MainThread]: On master: Close
[0m06:31:18.700861 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m06:31:18.701182 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m06:31:18.701364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m06:31:18.701508 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m06:31:18.704293 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m06:31:18.704787 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m06:31:18.717629 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m06:31:18.718040 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m06:31:18.718176 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m06:31:18.718295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:18.722352 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m06:31:18.722514 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m06:31:18.722657 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m06:31:18.723906 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m06:31:18.726189 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m06:31:18.726328 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m06:31:18.726608 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:18.727561 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m06:31:18.727693 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m06:31:18.727898 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:18.733464 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m06:31:18.733641 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m06:31:18.733765 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m06:31:18.734736 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m06:31:18.736390 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m06:31:18.736523 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m06:31:18.736840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:18.737847 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m06:31:18.742906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ffcb00>]}
[0m06:31:18.743167 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m06:31:18.743382 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m06:31:18.743546 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m06:31:18.743814 [info ] [Thread-1 (]: 2 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m06:31:18.744021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m06:31:18.744223 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m06:31:18.745291 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m06:31:18.745599 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m06:31:18.746631 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m06:31:18.746873 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m06:31:18.746993 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m06:31:18.747108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:18.751103 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m06:31:18.751263 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m06:31:18.751401 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m06:31:20.329936 [debug] [Thread-1 (]: SQL status: OK in 1.578 seconds
[0m06:31:20.331350 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m06:31:20.331506 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m06:31:20.331838 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:20.332817 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m06:31:20.332950 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m06:31:20.333168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:20.333778 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m06:31:20.333901 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m06:31:20.334017 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m06:31:20.355694 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m06:31:20.356690 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m06:31:20.356835 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m06:31:20.357540 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m06:31:20.358064 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m06:31:20.370428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112314f20>]}
[0m06:31:20.370797 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.63s]
[0m06:31:20.371031 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m06:31:20.371202 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m06:31:20.371419 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m06:31:20.371602 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m06:31:20.371748 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m06:31:20.372865 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m06:31:20.373123 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m06:31:20.380561 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m06:31:20.381043 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m06:31:20.381176 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m06:31:20.381295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:31:20.385865 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m06:31:20.386118 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m06:31:20.386261 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m06:31:20.386539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:20.387657 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m06:31:20.387792 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m06:31:20.388025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:20.388986 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m06:31:20.389111 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m06:31:20.389305 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:20.389817 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m06:31:20.389940 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m06:31:20.390054 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m06:31:20.390385 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:20.391108 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m06:31:20.391232 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m06:31:20.391463 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m06:31:20.391887 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m06:31:20.396172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1647a27-023b-478f-a536-a71c0636fe11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112330590>]}
[0m06:31:20.396469 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m06:31:20.396698 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m06:31:20.397255 [debug] [MainThread]: Using duckdb connection "master"
[0m06:31:20.397441 [debug] [MainThread]: On master: BEGIN
[0m06:31:20.397575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:31:20.401806 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m06:31:20.401956 [debug] [MainThread]: On master: COMMIT
[0m06:31:20.402073 [debug] [MainThread]: Using duckdb connection "master"
[0m06:31:20.402172 [debug] [MainThread]: On master: COMMIT
[0m06:31:20.402338 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m06:31:20.402472 [debug] [MainThread]: On master: Close
[0m06:31:20.403295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:31:20.403408 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m06:31:20.403546 [info ] [MainThread]: 
[0m06:31:20.403672 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m06:31:20.404019 [debug] [MainThread]: Command end result
[0m06:31:20.411993 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m06:31:20.412828 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m06:31:20.416358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m06:31:20.416563 [info ] [MainThread]: 
[0m06:31:20.416729 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:31:20.416857 [info ] [MainThread]: 
[0m06:31:20.416990 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:31:20.417976 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.0691829, "process_in_blocks": "0", "process_kernel_time": 0.307186, "process_mem_max_rss": "504725504", "process_out_blocks": "0", "process_user_time": 2.277898}
[0m06:31:20.418255 [debug] [MainThread]: Command `dbt run` succeeded at 06:31:20.418211 after 2.07 seconds
[0m06:31:20.418444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a41ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111657dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c640b0>]}
[0m06:31:20.418626 [debug] [MainThread]: Flushing usage events
[0m06:31:20.567235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:04.936541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbc680>]}


============================== 14:18:04.938920 | f283340b-1843-4f5f-9434-de3e2654af8b ==============================
[0m14:18:04.938920 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:18:04.939172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:18:05.057091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104882930>]}
[0m14:18:05.076122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431e480>]}
[0m14:18:05.078171 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:18:05.120099 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:18:05.164562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:05.164850 [debug] [MainThread]: Partial parsing: updated file: nyc_yellow_taxi://models/taxi_rides/taxi_rides_raw.sql
[0m14:18:05.246697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb7710>]}
[0m14:18:05.270273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:18:05.271388 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:18:05.281885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053b8ce0>]}
[0m14:18:05.282114 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m14:18:05.282267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053fa1e0>]}
[0m14:18:05.283126 [info ] [MainThread]: 
[0m14:18:05.283339 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:05.283475 [info ] [MainThread]: 
[0m14:18:05.283704 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:18:05.285553 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:18:05.312058 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:18:05.312261 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:18:05.312378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:05.358052 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m14:18:05.358690 [debug] [ThreadPool]: On list_dbt: Close
[0m14:18:05.360467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:18:05.360693 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:18:05.363222 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:05.363369 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:18:05.363480 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:05.367874 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:18:05.368486 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:05.368622 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:18:05.368788 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:05.368898 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:05.369008 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:18:05.369235 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:05.369547 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:18:05.369670 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:05.369767 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:18:05.369924 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:05.370034 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:18:05.371138 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:18:05.373197 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:18:05.373310 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:18:05.373404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:05.377280 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:18:05.377388 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:18:05.377495 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:18:05.386995 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:18:05.387595 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:18:05.388330 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:18:05.388463 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:18:05.389660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b8f680>]}
[0m14:18:05.389866 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:05.389984 [debug] [MainThread]: On master: BEGIN
[0m14:18:05.390094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:05.393882 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:18:05.394013 [debug] [MainThread]: On master: COMMIT
[0m14:18:05.394127 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:05.394233 [debug] [MainThread]: On master: COMMIT
[0m14:18:05.394423 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:05.394603 [debug] [MainThread]: On master: Close
[0m14:18:05.395681 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:05.395981 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:18:05.396165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:18:05.396308 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:05.399164 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:05.399654 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:05.411465 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:05.412038 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:05.412195 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:18:05.412316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:05.416508 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:05.416668 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:05.416809 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:18:05.417963 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:05.420785 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:05.420962 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:18:05.421287 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:05.422296 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:05.422437 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:18:05.422654 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:05.427937 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:18:05.428071 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:05.428187 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:18:05.429045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:05.430647 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:05.430776 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:18:05.431043 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:05.431911 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:18:05.437398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbc560>]}
[0m14:18:05.437673 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:18:05.437894 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:05.438054 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:05.438314 [info ] [Thread-1 (]: 2 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:18:05.438500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:18:05.438642 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:05.439584 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:05.440033 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:05.441841 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:05.442219 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:05.442342 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:18:05.442454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:05.446644 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:05.446808 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:05.446938 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet');

select * from source_data
    );
  
  
[0m14:18:05.449226 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet');

select * from source_data
    );
  
  
[0m14:18:05.449382 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:18:05.449548 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: ROLLBACK
[0m14:18:05.453609 [debug] [Thread-1 (]: Failed to rollback 'model.nyc_yellow_taxi.taxi_rides_raw'
[0m14:18:05.453802 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:18:05.455579 [debug] [Thread-1 (]: Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near "select"
[0m14:18:05.455772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8b0e0>]}
[0m14:18:05.456021 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.taxi_rides_raw ...................... [[31mERROR[0m in 0.02s]
[0m14:18:05.456226 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:05.456387 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:05.456578 [debug] [Thread-4 (]: Marking all children of 'model.nyc_yellow_taxi.taxi_rides_raw' to be skipped because of status 'error'.  Reason: Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near "select".
[0m14:18:05.456767 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:18:05.457260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:18:05.457459 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:05.458495 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:05.458775 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:05.465055 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:05.465495 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:05.465625 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:18:05.465741 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:05.470835 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:18:05.471058 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:05.471192 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:18:05.471484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:05.472691 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:05.472825 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:18:05.473053 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:05.473942 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:05.474070 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:18:05.474266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:05.474866 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:18:05.474988 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:05.475100 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:18:05.475462 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:05.476151 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:05.476321 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:18:05.476564 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:05.476994 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:18:05.480937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f283340b-1843-4f5f-9434-de3e2654af8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f52d80>]}
[0m14:18:05.481176 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:18:05.481382 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:05.481902 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:05.482062 [debug] [MainThread]: On master: BEGIN
[0m14:18:05.482183 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:05.486607 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:18:05.486803 [debug] [MainThread]: On master: COMMIT
[0m14:18:05.486915 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:05.487015 [debug] [MainThread]: On master: COMMIT
[0m14:18:05.487167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:05.487288 [debug] [MainThread]: On master: Close
[0m14:18:05.488092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:05.488191 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:18:05.488327 [info ] [MainThread]: 
[0m14:18:05.488446 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:18:05.488800 [debug] [MainThread]: Command end result
[0m14:18:05.496325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:18:05.497006 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:18:05.499402 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:18:05.499554 [info ] [MainThread]: 
[0m14:18:05.499704 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:18:05.499834 [info ] [MainThread]: 
[0m14:18:05.499982 [error] [MainThread]:   Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near "select"
[0m14:18:05.500097 [info ] [MainThread]: 
[0m14:18:05.500356 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:18:05.501455 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.60749644, "process_in_blocks": "0", "process_kernel_time": 0.161011, "process_mem_max_rss": "146817024", "process_out_blocks": "0", "process_user_time": 0.876743}
[0m14:18:05.501835 [debug] [MainThread]: Command `dbt run` failed at 14:18:05.501781 after 0.61 seconds
[0m14:18:05.502042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041d0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b46840>]}
[0m14:18:05.502209 [debug] [MainThread]: Flushing usage events
[0m14:18:05.701654 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:20.540515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103daf470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104404aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104404680>]}


============================== 14:18:20.542350 | bca39623-e4b2-439e-b2a2-6d631d5145e9 ==============================
[0m14:18:20.542350 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:18:20.542599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:18:20.623778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044047a0>]}
[0m14:18:20.641980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036fb3b0>]}
[0m14:18:20.643285 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:18:20.681211 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:18:20.717730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:20.717997 [debug] [MainThread]: Partial parsing: updated file: nyc_yellow_taxi://models/taxi_rides/taxi_rides_raw.sql
[0m14:18:20.797840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104406840>]}
[0m14:18:20.820849 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:18:20.821570 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:18:20.827217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f0b30>]}
[0m14:18:20.827418 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m14:18:20.827554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030d4080>]}
[0m14:18:20.828309 [info ] [MainThread]: 
[0m14:18:20.828464 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:20.828580 [info ] [MainThread]: 
[0m14:18:20.828785 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:18:20.830596 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:18:20.848784 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:18:20.849014 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:18:20.849136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:20.854456 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:18:20.854973 [debug] [ThreadPool]: On list_dbt: Close
[0m14:18:20.855909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:18:20.856087 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:18:20.858584 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:20.858716 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:18:20.858823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:20.862904 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:18:20.863477 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:20.863622 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:18:20.863803 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:20.863901 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:20.864002 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:18:20.864186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:20.864496 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:18:20.864619 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:20.864717 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:18:20.864862 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:20.864965 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:18:20.866100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:18:20.868215 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:18:20.868346 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:18:20.868448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:20.872481 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:18:20.872599 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:18:20.872709 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:18:20.880130 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:18:20.880687 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:18:20.881166 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:18:20.881280 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:18:20.882451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c0500>]}
[0m14:18:20.882645 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:20.882755 [debug] [MainThread]: On master: BEGIN
[0m14:18:20.882855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:20.886633 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:18:20.886763 [debug] [MainThread]: On master: COMMIT
[0m14:18:20.886867 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:20.886961 [debug] [MainThread]: On master: COMMIT
[0m14:18:20.887106 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:20.887204 [debug] [MainThread]: On master: Close
[0m14:18:20.888334 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:20.888634 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:18:20.888812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:18:20.888954 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:20.891748 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:20.892069 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:20.903643 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:20.904003 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:20.904134 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:18:20.904252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:20.908268 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:20.908431 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:20.908576 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:18:20.908982 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.911232 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:20.911372 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:18:20.911600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.912600 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:20.912751 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:18:20.913015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.918761 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:18:20.918950 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:20.919073 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:18:20.919573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.921195 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:20.921327 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:18:20.921613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.922482 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:18:20.927397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eaec60>]}
[0m14:18:20.927651 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:18:20.927856 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:20.928015 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:20.928254 [info ] [Thread-1 (]: 2 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:18:20.928488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:18:20.928635 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:20.929642 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:20.929948 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:20.931727 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:20.932004 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:20.932129 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:18:20.932244 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:20.936194 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:20.936347 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:20.936481 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'));

select * from source_data
    );
  
  
[0m14:18:20.936756 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'));

select * from source_data
    );
  
  
[0m14:18:20.936888 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:18:20.937045 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: ROLLBACK
[0m14:18:20.938697 [debug] [Thread-1 (]: Failed to rollback 'model.nyc_yellow_taxi.taxi_rides_raw'
[0m14:18:20.938824 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:18:20.940511 [debug] [Thread-1 (]: Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near ";"
[0m14:18:20.940709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec3410>]}
[0m14:18:20.940978 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.taxi_rides_raw ...................... [[31mERROR[0m in 0.01s]
[0m14:18:20.941202 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:20.941360 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:20.941576 [debug] [Thread-4 (]: Marking all children of 'model.nyc_yellow_taxi.taxi_rides_raw' to be skipped because of status 'error'.  Reason: Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near ";".
[0m14:18:20.941794 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:18:20.942358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:18:20.942546 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:20.943574 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:20.943896 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:20.950340 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:20.950683 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:20.950811 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:18:20.950927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:20.955084 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:20.955237 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:20.955381 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:18:20.955678 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.956908 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:20.957040 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:18:20.957265 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.958144 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:20.958267 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:18:20.958464 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.959060 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:18:20.959181 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:20.959294 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:18:20.959673 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.960351 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:20.960520 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:18:20.960765 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:20.961197 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:18:20.965514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca39623-e4b2-439e-b2a2-6d631d5145e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6b8c0>]}
[0m14:18:20.965808 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:18:20.966009 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:20.966519 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:20.966672 [debug] [MainThread]: On master: BEGIN
[0m14:18:20.966792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:20.970962 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:18:20.971107 [debug] [MainThread]: On master: COMMIT
[0m14:18:20.971220 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:20.971318 [debug] [MainThread]: On master: COMMIT
[0m14:18:20.971463 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:20.971577 [debug] [MainThread]: On master: Close
[0m14:18:20.972376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:20.972484 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:18:20.972623 [info ] [MainThread]: 
[0m14:18:20.972753 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:18:20.973114 [debug] [MainThread]: Command end result
[0m14:18:20.980921 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:18:20.981653 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:18:20.983795 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:18:20.983913 [info ] [MainThread]: 
[0m14:18:20.984053 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:18:20.984171 [info ] [MainThread]: 
[0m14:18:20.984320 [error] [MainThread]:   Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near ";"
[0m14:18:20.984431 [info ] [MainThread]: 
[0m14:18:20.984559 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:18:20.985265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.48305166, "process_in_blocks": "0", "process_kernel_time": 0.120804, "process_mem_max_rss": "141410304", "process_out_blocks": "0", "process_user_time": 0.857932}
[0m14:18:20.985478 [debug] [MainThread]: Command `dbt run` failed at 14:18:20.985442 after 0.48 seconds
[0m14:18:20.985646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104404440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044047d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104404680>]}
[0m14:18:20.985786 [debug] [MainThread]: Flushing usage events
[0m14:18:21.130409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:25.496333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068179e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106874890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068744a0>]}


============================== 14:18:25.498128 | 2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1 ==============================
[0m14:18:25.498128 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:18:25.498373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:18:25.578022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e2ae0>]}
[0m14:18:25.596289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ebc20>]}
[0m14:18:25.597606 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:18:25.635108 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:18:25.671752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:18:25.671933 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:18:25.685021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b91e50>]}
[0m14:18:25.708971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:18:25.709693 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:18:25.715393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b906e0>]}
[0m14:18:25.715599 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m14:18:25.715739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a4cfe0>]}
[0m14:18:25.716505 [info ] [MainThread]: 
[0m14:18:25.716667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:25.716785 [info ] [MainThread]: 
[0m14:18:25.717062 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:18:25.718998 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:18:25.737343 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:18:25.737551 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:18:25.737671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:25.742972 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:18:25.743481 [debug] [ThreadPool]: On list_dbt: Close
[0m14:18:25.744455 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:18:25.744665 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:18:25.747191 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:25.747326 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:18:25.747436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:25.751790 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:18:25.752325 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:25.752442 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:18:25.752603 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:25.752703 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:25.752800 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:18:25.752973 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:25.753247 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:18:25.753356 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:25.753450 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:18:25.753593 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:25.753694 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:18:25.754723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:18:25.756841 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:18:25.756984 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:18:25.757095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:25.761051 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:18:25.761166 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:18:25.761293 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:18:25.768408 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:18:25.768944 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:18:25.769428 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:18:25.769544 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:18:25.770697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb5a30>]}
[0m14:18:25.770890 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:25.770996 [debug] [MainThread]: On master: BEGIN
[0m14:18:25.771095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:25.774881 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:18:25.774993 [debug] [MainThread]: On master: COMMIT
[0m14:18:25.775095 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:25.775190 [debug] [MainThread]: On master: COMMIT
[0m14:18:25.775384 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:25.775557 [debug] [MainThread]: On master: Close
[0m14:18:25.776692 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:25.776992 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:18:25.777174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:18:25.777314 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:25.780071 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:25.780397 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:25.792615 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:25.793008 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:25.793140 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:18:25.793262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:25.797426 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:25.797585 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:25.797733 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:18:25.798187 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.800732 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:25.800918 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:18:25.801207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.802207 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:25.802335 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:18:25.802542 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.807859 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:18:25.807995 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:25.808116 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:18:25.808547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.810107 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:25.810236 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:18:25.810497 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.811365 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:18:25.815929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107162e70>]}
[0m14:18:25.816250 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:18:25.816491 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:25.816665 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:25.816947 [info ] [Thread-1 (]: 2 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:18:25.817159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:18:25.817311 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:25.818411 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:25.818740 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:25.819816 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:25.820078 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:25.820207 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:18:25.820321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:25.824603 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:25.824758 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:25.824889 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'));

select * from source_data
    );
  
  
[0m14:18:25.825151 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'));

select * from source_data
    );
  
  
[0m14:18:25.825280 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m14:18:25.825439 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: ROLLBACK
[0m14:18:25.827074 [debug] [Thread-1 (]: Failed to rollback 'model.nyc_yellow_taxi.taxi_rides_raw'
[0m14:18:25.827202 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:18:25.828893 [debug] [Thread-1 (]: Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near ";"
[0m14:18:25.829114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731e1b0>]}
[0m14:18:25.829367 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.taxi_rides_raw ...................... [[31mERROR[0m in 0.01s]
[0m14:18:25.829588 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:25.829748 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:25.829943 [debug] [Thread-4 (]: Marking all children of 'model.nyc_yellow_taxi.taxi_rides_raw' to be skipped because of status 'error'.  Reason: Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near ";".
[0m14:18:25.830141 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:18:25.830626 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:18:25.830783 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:25.831899 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:25.832231 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:25.838865 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:25.839264 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:25.839399 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:18:25.839517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:25.843519 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:25.843670 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:25.843813 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:18:25.844115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.845314 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:25.845447 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:18:25.845670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.846566 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:25.846739 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:18:25.846937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.847459 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:18:25.847580 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:25.847694 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:18:25.848054 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.849521 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:25.849648 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:18:25.849909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:25.850378 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:18:25.854505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ab0ca3f-62ff-4dcf-ab50-4ea6953e61d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ab590>]}
[0m14:18:25.854787 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:18:25.854994 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:25.855485 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:25.855613 [debug] [MainThread]: On master: BEGIN
[0m14:18:25.855720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:25.859717 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:18:25.859850 [debug] [MainThread]: On master: COMMIT
[0m14:18:25.859961 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:25.860055 [debug] [MainThread]: On master: COMMIT
[0m14:18:25.860223 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:25.860386 [debug] [MainThread]: On master: Close
[0m14:18:25.861213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:25.861346 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:18:25.861500 [info ] [MainThread]: 
[0m14:18:25.861637 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m14:18:25.861999 [debug] [MainThread]: Command end result
[0m14:18:25.869275 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:18:25.869994 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:18:25.872138 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:18:25.872251 [info ] [MainThread]: 
[0m14:18:25.872385 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:18:25.872502 [info ] [MainThread]: 
[0m14:18:25.872645 [error] [MainThread]:   Runtime Error in model taxi_rides_raw (models/taxi_rides/taxi_rides_raw.sql)
  Parser Error: syntax error at or near ";"
[0m14:18:25.872783 [info ] [MainThread]: 
[0m14:18:25.872915 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:18:25.873641 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.41576412, "process_in_blocks": "0", "process_kernel_time": 0.112461, "process_mem_max_rss": "143720448", "process_out_blocks": "0", "process_user_time": 0.791845}
[0m14:18:25.873856 [debug] [MainThread]: Command `dbt run` failed at 14:18:25.873818 after 0.42 seconds
[0m14:18:25.874017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abb680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106874890>]}
[0m14:18:25.874150 [debug] [MainThread]: Flushing usage events
[0m14:18:26.021597 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:37.853855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bd95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db0620>]}


============================== 14:18:37.855685 | fab99367-3bf2-4295-87b7-9d217d780081 ==============================
[0m14:18:37.855685 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:18:37.855938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:18:37.936407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e00260>]}
[0m14:18:37.954801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e74950>]}
[0m14:18:37.956128 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:18:37.993857 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:18:38.033276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:38.033551 [debug] [MainThread]: Partial parsing: updated file: nyc_yellow_taxi://models/taxi_rides/taxi_rides_raw.sql
[0m14:18:38.114909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107319640>]}
[0m14:18:38.138386 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:18:38.139145 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:18:38.145201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c0da0>]}
[0m14:18:38.145429 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m14:18:38.145566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107319be0>]}
[0m14:18:38.146354 [info ] [MainThread]: 
[0m14:18:38.146509 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:18:38.146626 [info ] [MainThread]: 
[0m14:18:38.146832 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:18:38.148594 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:18:38.170228 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:18:38.170455 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:18:38.170594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:38.176155 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:18:38.176834 [debug] [ThreadPool]: On list_dbt: Close
[0m14:18:38.177986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:18:38.178242 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:18:38.180872 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:38.181011 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:18:38.181120 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:38.185868 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:18:38.186434 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:38.186550 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:18:38.186722 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:38.186817 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:38.186928 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:18:38.187108 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:38.187387 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:18:38.187497 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:18:38.187591 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:18:38.187736 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:18:38.187845 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:18:38.188984 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:18:38.191062 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:18:38.191185 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:18:38.191287 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:18:38.195623 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:18:38.195776 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:18:38.195887 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:18:38.203182 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:18:38.203703 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:18:38.204217 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:18:38.204356 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:18:38.205546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e745f0>]}
[0m14:18:38.205744 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:38.205849 [debug] [MainThread]: On master: BEGIN
[0m14:18:38.205944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:38.210046 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:18:38.210215 [debug] [MainThread]: On master: COMMIT
[0m14:18:38.210339 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:38.210441 [debug] [MainThread]: On master: COMMIT
[0m14:18:38.210599 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:38.210704 [debug] [MainThread]: On master: Close
[0m14:18:38.211952 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:38.212261 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:18:38.212442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:18:38.212595 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:38.215329 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:38.215683 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:38.227440 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:38.227946 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:38.228089 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:18:38.228217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:38.232482 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:38.232631 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:38.232777 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:18:38.233188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:38.235527 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:38.235662 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:18:38.235884 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:38.236836 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:38.236962 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:18:38.237175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:38.242524 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:18:38.242674 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:38.242790 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:18:38.243230 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:38.245308 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:18:38.245480 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:18:38.245848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:38.246744 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:18:38.251564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784fcb0>]}
[0m14:18:38.251819 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:18:38.252035 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:18:38.252195 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:38.252466 [info ] [Thread-1 (]: 2 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:18:38.252678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:18:38.252829 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:38.253800 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:38.254070 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:38.255872 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:38.256119 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:38.256242 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:18:38.256357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:38.260623 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:38.260801 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:38.260943 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m14:18:39.616965 [debug] [Thread-1 (]: SQL status: OK in 1.356 seconds
[0m14:18:39.618326 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:39.618494 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m14:18:39.618842 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:39.619773 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:39.619906 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m14:18:39.620138 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:39.620706 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:18:39.620829 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:39.620944 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:18:39.644370 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:18:39.645371 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:18:39.645516 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m14:18:39.646206 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:18:39.646726 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:18:39.654464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788fbf0>]}
[0m14:18:39.654770 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.40s]
[0m14:18:39.654984 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:18:39.655143 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:39.655404 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:18:39.655635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:18:39.655798 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:39.656902 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:39.657202 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:39.663855 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:39.664151 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:39.664281 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:18:39.664400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:39.668557 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:18:39.668738 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:39.668882 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:18:39.669201 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:39.670487 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:39.670637 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:18:39.670892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:39.671880 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:39.672008 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:18:39.672210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:39.672724 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:18:39.672847 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:39.672959 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:18:39.673334 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:39.674066 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:18:39.674188 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:18:39.674421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:18:39.674846 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:18:39.678810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fab99367-3bf2-4295-87b7-9d217d780081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ce930>]}
[0m14:18:39.679101 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:18:39.679315 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:18:39.679815 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:39.679946 [debug] [MainThread]: On master: BEGIN
[0m14:18:39.680062 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:39.684142 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:18:39.684290 [debug] [MainThread]: On master: COMMIT
[0m14:18:39.684410 [debug] [MainThread]: Using duckdb connection "master"
[0m14:18:39.684518 [debug] [MainThread]: On master: COMMIT
[0m14:18:39.684692 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:18:39.684895 [debug] [MainThread]: On master: Close
[0m14:18:39.685912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:39.686052 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:18:39.686201 [info ] [MainThread]: 
[0m14:18:39.686337 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m14:18:39.686690 [debug] [MainThread]: Command end result
[0m14:18:39.694276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:18:39.695035 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:18:39.697221 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:18:39.697340 [info ] [MainThread]: 
[0m14:18:39.697478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:39.697594 [info ] [MainThread]: 
[0m14:18:39.697717 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:18:39.698452 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8831471, "process_in_blocks": "0", "process_kernel_time": 0.362231, "process_mem_max_rss": "470810624", "process_out_blocks": "0", "process_user_time": 3.326572}
[0m14:18:39.698673 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:39.698635 after 1.88 seconds
[0m14:18:39.698819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107319760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3e5a0>]}
[0m14:18:39.698958 [debug] [MainThread]: Flushing usage events
[0m14:18:39.842750 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:19:09.307015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109601a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c0590>]}


============================== 14:19:09.308822 | 7752fbed-1df5-4afb-a239-9c0db19c43fb ==============================
[0m14:19:09.308822 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:19:09.309069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:19:09.391147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d2f590>]}
[0m14:19:09.409787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11032cf80>]}
[0m14:19:09.411135 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:19:09.447944 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:19:09.485505 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:19:09.485703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:19:09.498892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d94a10>]}
[0m14:19:09.522703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:19:09.523452 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:19:09.529381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129a4080>]}
[0m14:19:09.529593 [info ] [MainThread]: Found 3 models, 4 data tests, 426 macros
[0m14:19:09.529730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f251c0>]}
[0m14:19:09.530463 [info ] [MainThread]: 
[0m14:19:09.530613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:09.530734 [info ] [MainThread]: 
[0m14:19:09.530966 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:19:09.532760 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:19:09.554430 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:19:09.554637 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:19:09.554760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:09.560098 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:19:09.560603 [debug] [ThreadPool]: On list_dbt: Close
[0m14:19:09.561504 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:19:09.561675 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:19:09.564219 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:19:09.564349 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:19:09.564453 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:09.568533 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:19:09.569068 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:19:09.569185 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:19:09.569348 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:19:09.569442 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:19:09.569542 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:19:09.569713 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:19:09.569989 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:19:09.570099 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:19:09.570195 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:19:09.570343 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:19:09.570443 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:19:09.571513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:19:09.573633 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:19:09.573781 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:19:09.573889 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:09.577880 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:19:09.578000 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:19:09.578114 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:19:09.585142 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:19:09.585657 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:19:09.586143 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:19:09.586250 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:19:09.587333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b80680>]}
[0m14:19:09.587555 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:09.587678 [debug] [MainThread]: On master: BEGIN
[0m14:19:09.587780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:09.591662 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:19:09.591793 [debug] [MainThread]: On master: COMMIT
[0m14:19:09.591902 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:09.592000 [debug] [MainThread]: On master: COMMIT
[0m14:19:09.592148 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:19:09.592248 [debug] [MainThread]: On master: Close
[0m14:19:09.593360 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:19:09.593620 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:19:09.593780 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:19:09.593922 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:19:09.596654 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:19:09.596982 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:19:09.609225 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:19:09.609610 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:19:09.609746 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:19:09.609863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:09.613930 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:19:09.614077 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:19:09.614220 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:19:09.614596 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:09.616809 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:19:09.616941 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:19:09.617161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:09.618162 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:19:09.618309 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:19:09.618536 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:09.623983 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:19:09.624144 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:19:09.624260 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:19:09.624729 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:09.626386 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:19:09.626517 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:19:09.626810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:09.627694 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:19:09.632198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c01220>]}
[0m14:19:09.632440 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:19:09.632652 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:19:09.632807 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:19:09.633021 [info ] [Thread-1 (]: 2 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:19:09.633224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:19:09.633365 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:19:09.634327 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:19:09.634618 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:19:09.635782 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:19:09.636076 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:19:09.636210 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:19:09.636335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:09.640445 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:19:09.640599 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:19:09.640729 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m14:19:10.936076 [debug] [Thread-1 (]: SQL status: OK in 1.295 seconds
[0m14:19:10.937387 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:19:10.937534 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m14:19:10.937854 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:10.938769 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:19:10.938895 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m14:19:10.939119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:10.939676 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:19:10.939797 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:19:10.939910 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:19:10.946344 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m14:19:10.947279 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:19:10.947425 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m14:19:10.948052 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:10.948552 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:19:10.956498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112db3f80>]}
[0m14:19:10.956823 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.32s]
[0m14:19:10.957056 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:19:10.957227 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:19:10.957454 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:19:10.957638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:19:10.957783 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:19:10.958827 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:19:10.959127 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:19:10.966116 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:19:10.966414 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:19:10.966556 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:19:10.966691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:10.971010 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:19:10.971197 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:19:10.971346 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:19:10.971736 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:10.972918 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:19:10.973059 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:19:10.973297 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:10.974237 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:19:10.974365 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:19:10.974565 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:10.975081 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:19:10.975203 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:19:10.975316 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:19:10.975684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:10.976408 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:19:10.976531 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:19:10.976796 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:19:10.977356 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:19:10.981307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7752fbed-1df5-4afb-a239-9c0db19c43fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11385ffe0>]}
[0m14:19:10.981597 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:19:10.981824 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:19:10.982346 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:10.982472 [debug] [MainThread]: On master: BEGIN
[0m14:19:10.982583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:10.986554 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:19:10.986792 [debug] [MainThread]: On master: COMMIT
[0m14:19:10.986929 [debug] [MainThread]: Using duckdb connection "master"
[0m14:19:10.987043 [debug] [MainThread]: On master: COMMIT
[0m14:19:10.987250 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:19:10.987439 [debug] [MainThread]: On master: Close
[0m14:19:10.988300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:10.988470 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:19:10.988639 [info ] [MainThread]: 
[0m14:19:10.988777 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 1.46 seconds (1.46s).
[0m14:19:10.989142 [debug] [MainThread]: Command end result
[0m14:19:10.996213 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:19:10.996840 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:19:10.999075 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:19:10.999202 [info ] [MainThread]: 
[0m14:19:10.999338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:19:10.999453 [info ] [MainThread]: 
[0m14:19:10.999581 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:19:11.000316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7317855, "process_in_blocks": "0", "process_kernel_time": 0.271208, "process_mem_max_rss": "506609664", "process_out_blocks": "0", "process_user_time": 2.451911}
[0m14:19:11.000540 [debug] [MainThread]: Command `dbt run` succeeded at 14:19:11.000502 after 1.73 seconds
[0m14:19:11.000696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c07a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c0a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c0920>]}
[0m14:19:11.000835 [debug] [MainThread]: Flushing usage events
[0m14:19:11.146694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:15.887770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c0920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c0470>]}


============================== 14:53:15.890162 | 9f312413-c876-4953-a2ed-6c4e4d82dbbe ==============================
[0m14:53:15.890162 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:53:15.890436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:16.012802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098471d0>]}
[0m14:53:16.031784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109654fe0>]}
[0m14:53:16.033556 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:53:16.075688 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:53:16.120260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:53:16.120545 [debug] [MainThread]: Partial parsing: added file: nyc_yellow_taxi://models/taxi_rides/total_creditcard_riders_by_day.sql
[0m14:53:16.202194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a87b9e0>]}
[0m14:53:16.225920 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:53:16.226991 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:53:16.238033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9d1370>]}
[0m14:53:16.238266 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m14:53:16.238414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a901df0>]}
[0m14:53:16.239223 [info ] [MainThread]: 
[0m14:53:16.239379 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:16.239492 [info ] [MainThread]: 
[0m14:53:16.239701 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:53:16.241558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:53:16.269890 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:53:16.270102 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:53:16.270226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:16.325528 [debug] [ThreadPool]: SQL status: OK in 0.055 seconds
[0m14:53:16.326234 [debug] [ThreadPool]: On list_dbt: Close
[0m14:53:16.328087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:53:16.328287 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:53:16.330817 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:53:16.330950 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:53:16.331058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:16.335710 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:53:16.336406 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:53:16.336527 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:53:16.336693 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:53:16.336799 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:53:16.336909 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:53:16.337141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:53:16.337455 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:53:16.337569 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:53:16.337664 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:53:16.337810 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:53:16.337923 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:53:16.339053 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:53:16.341148 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:53:16.341282 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:53:16.341384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:16.345334 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:53:16.345452 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:53:16.345561 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:53:16.354846 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:53:16.355361 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:53:16.356109 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:53:16.356267 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:53:16.357495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991c560>]}
[0m14:53:16.357705 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:16.357824 [debug] [MainThread]: On master: BEGIN
[0m14:53:16.357922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:16.361725 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:53:16.361855 [debug] [MainThread]: On master: COMMIT
[0m14:53:16.361972 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:16.362078 [debug] [MainThread]: On master: COMMIT
[0m14:53:16.362226 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:53:16.362342 [debug] [MainThread]: On master: Close
[0m14:53:16.363461 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:53:16.363781 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:53:16.363954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:53:16.364109 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:53:16.366868 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:53:16.367360 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:53:16.379281 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:53:16.379667 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:53:16.379795 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:53:16.379908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:16.383866 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:53:16.384019 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:53:16.384154 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:53:16.385486 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:53:16.387764 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:53:16.387903 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:53:16.388167 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:16.389114 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:53:16.389241 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:53:16.389442 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:16.394920 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:53:16.395104 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:53:16.395234 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:53:16.396489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:53:16.399202 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:53:16.399372 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:53:16.399738 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:16.400677 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:53:16.406333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864e630>]}
[0m14:53:16.406580 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:53:16.406795 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:53:16.406951 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:53:16.407257 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:53:16.407490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:53:16.407648 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:53:16.408667 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:53:16.408937 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:53:16.410089 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:53:16.410390 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:53:16.410528 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:53:16.410650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:16.414966 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:53:16.415126 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:53:16.415253 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m14:53:17.665039 [debug] [Thread-1 (]: SQL status: OK in 1.250 seconds
[0m14:53:17.666295 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:53:17.666444 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m14:53:17.666762 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.667730 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:53:17.667858 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m14:53:17.668079 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.668668 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:53:17.668792 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:53:17.668903 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:53:17.689591 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m14:53:17.690426 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:53:17.690559 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m14:53:17.691184 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:53:17.691634 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:53:17.699117 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae547a0>]}
[0m14:53:17.699433 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.29s]
[0m14:53:17.699662 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:53:17.699829 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:53:17.700043 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m14:53:17.700218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m14:53:17.700363 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:53:17.701060 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:53:17.701339 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:53:17.707999 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:53:17.708279 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:53:17.708410 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m14:53:17.708526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:17.713625 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m14:53:17.713856 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:53:17.713995 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m14:53:17.715049 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:53:17.716152 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:53:17.716285 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m14:53:17.716522 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.717099 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m14:53:17.717228 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:53:17.717344 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m14:53:17.717686 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.718378 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:53:17.718522 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m14:53:17.718737 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.719221 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m14:53:17.723236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae1b050>]}
[0m14:53:17.723475 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m14:53:17.723689 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:53:17.723845 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:53:17.724043 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:53:17.724206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:53:17.724346 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:53:17.725363 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:53:17.725615 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:53:17.727393 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:53:17.728007 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:53:17.728219 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:53:17.728374 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:17.732831 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:53:17.733059 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:53:17.733198 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:53:17.733471 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.734612 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:53:17.734758 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:53:17.734973 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.735935 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:53:17.736063 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:53:17.736266 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.736873 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:53:17.737012 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:53:17.737138 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:53:17.737569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.738500 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:53:17.738707 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:53:17.739029 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:53:17.739559 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:53:17.743579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f312413-c876-4953-a2ed-6c4e4d82dbbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aedb9b0>]}
[0m14:53:17.743827 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:53:17.744037 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:53:17.744547 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:17.744764 [debug] [MainThread]: On master: BEGIN
[0m14:53:17.745014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:17.749775 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m14:53:17.750018 [debug] [MainThread]: On master: COMMIT
[0m14:53:17.750146 [debug] [MainThread]: Using duckdb connection "master"
[0m14:53:17.750252 [debug] [MainThread]: On master: COMMIT
[0m14:53:17.750428 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:53:17.750565 [debug] [MainThread]: On master: Close
[0m14:53:17.751429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:17.751551 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:53:17.751701 [info ] [MainThread]: 
[0m14:53:17.751832 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m14:53:17.752244 [debug] [MainThread]: Command end result
[0m14:53:17.759261 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:53:17.759915 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:53:17.762785 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:53:17.762983 [info ] [MainThread]: 
[0m14:53:17.763144 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:17.763264 [info ] [MainThread]: 
[0m14:53:17.763395 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:53:17.764402 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9187751, "process_in_blocks": "0", "process_kernel_time": 0.351991, "process_mem_max_rss": "494600192", "process_out_blocks": "0", "process_user_time": 2.583577}
[0m14:53:17.764667 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:17.764623 after 1.92 seconds
[0m14:53:17.764843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105032c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109846840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad54b90>]}
[0m14:53:17.764993 [debug] [MainThread]: Flushing usage events
[0m14:53:17.930581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:54:20.952345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10596c410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c0440>]}


============================== 14:54:20.954159 | 35035a1f-f7f9-4df8-be24-df35ba6353b0 ==============================
[0m14:54:20.954159 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:54:20.954411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:54:21.035251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103032360>]}
[0m14:54:21.053598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482ede0>]}
[0m14:54:21.054952 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:54:21.093019 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:54:21.131059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:21.131251 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:21.144627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b7ef0>]}
[0m14:54:21.169049 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:54:21.169764 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:54:21.175584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064e08c0>]}
[0m14:54:21.175822 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m14:54:21.175959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ad340>]}
[0m14:54:21.176720 [info ] [MainThread]: 
[0m14:54:21.176863 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:21.176979 [info ] [MainThread]: 
[0m14:54:21.177212 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:54:21.179028 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:54:21.200849 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:54:21.201053 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:54:21.201176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:21.206492 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m14:54:21.207010 [debug] [ThreadPool]: On list_dbt: Close
[0m14:54:21.207950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:54:21.208168 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:54:21.210701 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:54:21.210842 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:54:21.210952 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:21.215240 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:54:21.215767 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:54:21.215884 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:54:21.216101 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:21.216260 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:54:21.216377 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:54:21.216621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:21.216951 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:54:21.217069 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:54:21.217167 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:54:21.217316 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:54:21.217425 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:54:21.218539 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:54:21.220547 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:54:21.220673 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:54:21.220771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:21.224703 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:54:21.224827 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:54:21.224942 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:54:21.232168 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:54:21.232692 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:54:21.233173 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:54:21.233288 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:54:21.234516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061dbef0>]}
[0m14:54:21.234701 [debug] [MainThread]: Using duckdb connection "master"
[0m14:54:21.234806 [debug] [MainThread]: On master: BEGIN
[0m14:54:21.234901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:21.239005 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:54:21.239122 [debug] [MainThread]: On master: COMMIT
[0m14:54:21.239237 [debug] [MainThread]: Using duckdb connection "master"
[0m14:54:21.239331 [debug] [MainThread]: On master: COMMIT
[0m14:54:21.239507 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:54:21.239632 [debug] [MainThread]: On master: Close
[0m14:54:21.240893 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:54:21.241086 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:54:21.241257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:54:21.241396 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:54:21.244131 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:54:21.244461 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:54:21.256817 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:54:21.257182 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:54:21.257315 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:54:21.257431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:21.261472 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:54:21.261644 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:54:21.261794 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:54:21.262206 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:21.264685 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:54:21.264872 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:54:21.265148 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:21.266163 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:54:21.266292 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:54:21.266501 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:21.271800 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:54:21.271940 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:54:21.272055 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:54:21.272487 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:21.274074 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:54:21.274204 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:54:21.274477 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:21.275346 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:54:21.279734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a02690>]}
[0m14:54:21.280004 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:54:21.280236 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:54:21.280399 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:54:21.280709 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:54:21.280939 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:54:21.281098 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:54:21.282185 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:54:21.282491 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:54:21.283533 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:54:21.283773 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:54:21.283899 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:54:21.284012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:21.288158 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:54:21.288315 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:54:21.288446 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m14:54:22.317035 [debug] [Thread-1 (]: SQL status: OK in 1.028 seconds
[0m14:54:22.318287 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:54:22.318441 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m14:54:22.318755 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.319696 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:54:22.319831 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m14:54:22.320046 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.320634 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:54:22.320771 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:54:22.320885 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:54:22.327964 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m14:54:22.328885 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:54:22.329032 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m14:54:22.329665 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.330265 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:54:22.338285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a192e0>]}
[0m14:54:22.338588 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.06s]
[0m14:54:22.338805 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:54:22.338968 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:54:22.339178 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m14:54:22.339354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m14:54:22.339500 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:54:22.340233 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:54:22.340524 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:54:22.347792 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:54:22.348140 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:54:22.348280 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m14:54:22.348413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:22.352762 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:54:22.352951 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:54:22.353103 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m14:54:22.353507 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.354602 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:54:22.354738 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m14:54:22.354970 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.355924 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:54:22.356052 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m14:54:22.356247 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.356796 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m14:54:22.356921 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:54:22.357038 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m14:54:22.357405 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.358183 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:54:22.358309 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m14:54:22.358546 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.358990 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m14:54:22.365381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482e750>]}
[0m14:54:22.365788 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.03s]
[0m14:54:22.366029 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:54:22.366192 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:54:22.366427 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:54:22.366619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:54:22.366765 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:54:22.367909 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:54:22.368188 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:54:22.369289 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:54:22.369544 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:54:22.369668 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:54:22.369782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:22.373902 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:54:22.374062 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:54:22.374206 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:54:22.374474 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.375496 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:54:22.375639 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:54:22.375937 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.376847 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:54:22.376973 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:54:22.377172 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.377782 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:54:22.377908 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:54:22.378025 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:54:22.378388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.379228 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:54:22.379442 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:54:22.379743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:54:22.380243 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:54:22.384375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35035a1f-f7f9-4df8-be24-df35ba6353b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a191f0>]}
[0m14:54:22.384684 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:54:22.384893 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:54:22.385432 [debug] [MainThread]: Using duckdb connection "master"
[0m14:54:22.385588 [debug] [MainThread]: On master: BEGIN
[0m14:54:22.385707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:22.389740 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:54:22.389875 [debug] [MainThread]: On master: COMMIT
[0m14:54:22.389994 [debug] [MainThread]: Using duckdb connection "master"
[0m14:54:22.390101 [debug] [MainThread]: On master: COMMIT
[0m14:54:22.390269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:54:22.390403 [debug] [MainThread]: On master: Close
[0m14:54:22.391198 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:22.391373 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:54:22.391548 [info ] [MainThread]: 
[0m14:54:22.391689 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m14:54:22.392098 [debug] [MainThread]: Command end result
[0m14:54:22.400196 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:54:22.400971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:54:22.403180 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:54:22.403305 [info ] [MainThread]: 
[0m14:54:22.403441 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:22.403554 [info ] [MainThread]: 
[0m14:54:22.403680 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:54:22.404407 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4904352, "process_in_blocks": "0", "process_kernel_time": 0.29153, "process_mem_max_rss": "483524608", "process_out_blocks": "0", "process_user_time": 3.173765}
[0m14:54:22.404621 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:22.404584 after 1.49 seconds
[0m14:54:22.404783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c25ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c0830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d92f60>]}
[0m14:54:22.404937 [debug] [MainThread]: Flushing usage events
[0m14:54:22.546144 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:00.429724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a493d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106808a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106808680>]}


============================== 14:55:00.431535 | 64f163af-5028-4a3f-874c-660b33ad3131 ==============================
[0m14:55:00.431535 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:55:00.431782 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:55:00.512347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068a2600>]}
[0m14:55:00.530639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060463c0>]}
[0m14:55:00.531985 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:55:00.569283 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:55:00.606747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:00.606931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:00.620114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cde4b0>]}
[0m14:55:00.643883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:55:00.644612 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:55:00.650521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdd220>]}
[0m14:55:00.650732 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m14:55:00.650866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb2510>]}
[0m14:55:00.651617 [info ] [MainThread]: 
[0m14:55:00.651760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:55:00.651880 [info ] [MainThread]: 
[0m14:55:00.652109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:55:00.653903 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:55:00.675207 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:55:00.675412 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:55:00.675535 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:00.681110 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m14:55:00.681679 [debug] [ThreadPool]: On list_dbt: Close
[0m14:55:00.682682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:55:00.682856 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:55:00.685334 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:55:00.685463 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:55:00.685567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:00.689762 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:55:00.690260 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:55:00.690374 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:55:00.690532 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:00.690625 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:55:00.690721 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:55:00.690890 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:00.691163 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:55:00.691270 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:55:00.691363 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:55:00.691506 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:55:00.691607 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:55:00.692720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:55:00.694849 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:55:00.695003 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:55:00.695110 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:00.699509 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:55:00.699638 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:55:00.699748 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:55:00.706796 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m14:55:00.707383 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:55:00.707887 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:55:00.708006 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:55:00.709229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106869e50>]}
[0m14:55:00.709433 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:00.709547 [debug] [MainThread]: On master: BEGIN
[0m14:55:00.709645 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:00.713513 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:55:00.713634 [debug] [MainThread]: On master: COMMIT
[0m14:55:00.713740 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:00.713837 [debug] [MainThread]: On master: COMMIT
[0m14:55:00.713993 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:00.714105 [debug] [MainThread]: On master: Close
[0m14:55:00.715320 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:55:00.715538 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:55:00.715711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:55:00.715854 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:55:00.718641 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:55:00.718972 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:55:00.731327 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:55:00.731730 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:55:00.731863 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:55:00.731976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:00.736065 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:00.736194 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:55:00.736343 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:55:00.736731 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:00.738956 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:55:00.739103 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:55:00.739345 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:00.740288 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:55:00.740418 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:55:00.740627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:00.745932 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:55:00.746079 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:55:00.746215 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:55:00.746731 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:00.748712 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:55:00.748870 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:55:00.749215 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:00.750130 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:55:00.754756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f1b9e0>]}
[0m14:55:00.755032 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:55:00.755248 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:55:00.755415 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:55:00.755659 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:55:00.755840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:55:00.755981 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:55:00.756945 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:55:00.757210 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:55:00.758232 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:55:00.758478 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:55:00.758596 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:55:00.758710 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:00.762866 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:00.763032 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:55:00.763177 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m14:55:01.829808 [debug] [Thread-1 (]: SQL status: OK in 1.066 seconds
[0m14:55:01.831069 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:55:01.831218 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m14:55:01.831540 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.832478 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:55:01.832606 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m14:55:01.832826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.833384 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:55:01.833507 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:55:01.833617 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:55:01.856419 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m14:55:01.857407 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:55:01.857558 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m14:55:01.858216 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:55:01.858724 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:55:01.866463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b7f20>]}
[0m14:55:01.866788 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.11s]
[0m14:55:01.867021 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:55:01.867185 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:55:01.867454 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m14:55:01.867693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m14:55:01.867864 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:55:01.868595 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:55:01.868892 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:55:01.876594 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:55:01.876923 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:55:01.877055 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m14:55:01.877173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:01.881618 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:01.881818 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:55:01.881968 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m14:55:01.882331 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.883399 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:55:01.883532 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m14:55:01.883754 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.884706 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:55:01.884836 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m14:55:01.885042 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.885574 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m14:55:01.885699 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:55:01.885812 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m14:55:01.886220 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.887239 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:55:01.887423 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m14:55:01.887763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.888299 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m14:55:01.892435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10761ed80>]}
[0m14:55:01.892680 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m14:55:01.892886 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:55:01.893042 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:55:01.893233 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:55:01.893396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:55:01.893534 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:55:01.894575 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:55:01.894834 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:55:01.895948 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:55:01.896189 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:55:01.896326 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:55:01.896453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:01.900562 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:55:01.900718 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:55:01.900856 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:55:01.901111 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.902078 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:55:01.902201 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:55:01.902457 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.903364 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:55:01.903506 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:55:01.903719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.904354 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:55:01.904483 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:55:01.904597 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:55:01.904941 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.905627 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:55:01.905790 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:55:01.906033 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:55:01.906489 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:55:01.910870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64f163af-5028-4a3f-874c-660b33ad3131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f2c9e0>]}
[0m14:55:01.911145 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:55:01.911361 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:55:01.911877 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:01.912031 [debug] [MainThread]: On master: BEGIN
[0m14:55:01.912149 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:01.916349 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:55:01.916504 [debug] [MainThread]: On master: COMMIT
[0m14:55:01.916625 [debug] [MainThread]: Using duckdb connection "master"
[0m14:55:01.916736 [debug] [MainThread]: On master: COMMIT
[0m14:55:01.916911 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:55:01.917052 [debug] [MainThread]: On master: Close
[0m14:55:01.917830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:01.917942 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:55:01.918081 [info ] [MainThread]: 
[0m14:55:01.918204 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m14:55:01.918597 [debug] [MainThread]: Command end result
[0m14:55:01.926365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:55:01.927019 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:55:01.929176 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:55:01.929295 [info ] [MainThread]: 
[0m14:55:01.929435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:01.929550 [info ] [MainThread]: 
[0m14:55:01.929681 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:55:01.930784 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5408632, "process_in_blocks": "0", "process_kernel_time": 0.289136, "process_mem_max_rss": "484524032", "process_out_blocks": "0", "process_user_time": 3.173274}
[0m14:55:01.930986 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:01.930954 after 1.54 seconds
[0m14:55:01.931134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a493d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d49ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107692ea0>]}
[0m14:55:01.931275 [debug] [MainThread]: Flushing usage events
[0m14:55:02.115261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:59:24.027694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11446fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ac0710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ac0320>]}


============================== 14:59:24.030261 | 6fa293ee-1efd-4b79-bfee-38236b47acbd ==============================
[0m14:59:24.030261 [info ] [MainThread]: Running with dbt=1.9.2
[0m14:59:24.030527 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:59:24.155001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11261e3c0>]}
[0m14:59:24.173770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11491b2f0>]}
[0m14:59:24.175610 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m14:59:24.217927 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m14:59:24.263068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:59:24.263250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:59:24.276828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d8c830>]}
[0m14:59:24.300685 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:59:24.301601 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:59:24.312788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158abf20>]}
[0m14:59:24.312998 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m14:59:24.313148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c0c230>]}
[0m14:59:24.313902 [info ] [MainThread]: 
[0m14:59:24.314051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:59:24.314167 [info ] [MainThread]: 
[0m14:59:24.314373 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m14:59:24.316190 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m14:59:24.341560 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m14:59:24.341765 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m14:59:24.341890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:59:24.388658 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m14:59:24.389338 [debug] [ThreadPool]: On list_dbt: Close
[0m14:59:24.391155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m14:59:24.391384 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m14:59:24.393982 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:59:24.394117 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m14:59:24.394226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:24.398706 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:59:24.399256 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:59:24.399367 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m14:59:24.399519 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:59:24.399629 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:59:24.399739 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m14:59:24.400224 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:59:24.400632 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:59:24.400760 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m14:59:24.400870 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m14:59:24.401023 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m14:59:24.401142 [debug] [ThreadPool]: On create_dbt_main: Close
[0m14:59:24.402310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m14:59:24.404660 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:59:24.404797 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m14:59:24.404898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:59:24.408950 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m14:59:24.409079 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m14:59:24.409203 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m14:59:24.417881 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m14:59:24.418475 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m14:59:24.419256 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m14:59:24.419376 [debug] [ThreadPool]: On list_dbt_main: Close
[0m14:59:24.420662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c84320>]}
[0m14:59:24.420899 [debug] [MainThread]: Using duckdb connection "master"
[0m14:59:24.421021 [debug] [MainThread]: On master: BEGIN
[0m14:59:24.421125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:59:24.425257 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:59:24.425404 [debug] [MainThread]: On master: COMMIT
[0m14:59:24.425525 [debug] [MainThread]: Using duckdb connection "master"
[0m14:59:24.425632 [debug] [MainThread]: On master: COMMIT
[0m14:59:24.425785 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:59:24.425903 [debug] [MainThread]: On master: Close
[0m14:59:24.427204 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:59:24.427418 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m14:59:24.427588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m14:59:24.427726 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:59:24.430513 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:59:24.431015 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:59:24.443513 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:59:24.443905 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:59:24.444038 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m14:59:24.444156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:24.448309 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:59:24.448476 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:59:24.448614 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m14:59:24.449798 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:59:24.452148 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:59:24.452290 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:59:24.452574 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:24.453722 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:59:24.453888 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:59:24.454156 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:24.459792 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:59:24.459948 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:59:24.460067 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m14:59:24.461099 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:59:24.462738 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m14:59:24.462872 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m14:59:24.463161 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:24.464096 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m14:59:24.469211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d0c560>]}
[0m14:59:24.469485 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m14:59:24.469723 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m14:59:24.469957 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:59:24.470243 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m14:59:24.470447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m14:59:24.470592 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:59:24.471703 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:59:24.471998 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:59:24.473058 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:59:24.473312 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:59:24.473437 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m14:59:24.473553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:24.477707 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:59:24.477875 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:59:24.478011 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m14:59:26.098664 [debug] [Thread-1 (]: SQL status: OK in 1.620 seconds
[0m14:59:26.099996 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:59:26.100150 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m14:59:26.100458 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.101426 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:59:26.101558 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m14:59:26.101775 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.102384 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:59:26.102506 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:59:26.102618 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m14:59:26.124483 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m14:59:26.125458 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m14:59:26.125601 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m14:59:26.126269 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:59:26.126773 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m14:59:26.138255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115de5a30>]}
[0m14:59:26.138573 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.67s]
[0m14:59:26.138804 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m14:59:26.138971 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:59:26.139219 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m14:59:26.139459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m14:59:26.139629 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:59:26.140350 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:59:26.140661 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:59:26.147822 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:59:26.148110 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:59:26.148244 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m14:59:26.148365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:26.152733 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:59:26.152930 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:59:26.153074 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m14:59:26.153896 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m14:59:26.155041 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:59:26.155214 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m14:59:26.155484 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.156547 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:59:26.156681 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m14:59:26.156896 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.157425 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m14:59:26.157552 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:59:26.157667 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m14:59:26.158055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.158850 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m14:59:26.158983 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m14:59:26.159244 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.159702 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m14:59:26.163711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116030200>]}
[0m14:59:26.163959 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m14:59:26.164162 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m14:59:26.164313 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:59:26.164504 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m14:59:26.164670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m14:59:26.164809 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:59:26.165903 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:59:26.166180 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:59:26.167303 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:59:26.167726 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:59:26.167858 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m14:59:26.167977 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:59:26.172099 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m14:59:26.172263 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:59:26.172416 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m14:59:26.172705 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.173836 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:59:26.173970 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m14:59:26.174252 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.175120 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:59:26.175246 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:59:26.175444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.176033 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:59:26.176156 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:59:26.176270 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m14:59:26.176619 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.177302 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m14:59:26.177471 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m14:59:26.177748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m14:59:26.178271 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m14:59:26.182276 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6fa293ee-1efd-4b79-bfee-38236b47acbd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115db3bc0>]}
[0m14:59:26.182572 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m14:59:26.182793 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m14:59:26.183324 [debug] [MainThread]: Using duckdb connection "master"
[0m14:59:26.183457 [debug] [MainThread]: On master: BEGIN
[0m14:59:26.183570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:59:26.187644 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m14:59:26.187771 [debug] [MainThread]: On master: COMMIT
[0m14:59:26.187884 [debug] [MainThread]: Using duckdb connection "master"
[0m14:59:26.187979 [debug] [MainThread]: On master: COMMIT
[0m14:59:26.188128 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m14:59:26.188250 [debug] [MainThread]: On master: Close
[0m14:59:26.189107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:59:26.189251 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m14:59:26.189413 [info ] [MainThread]: 
[0m14:59:26.189552 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.88 seconds (1.88s).
[0m14:59:26.189948 [debug] [MainThread]: Command end result
[0m14:59:26.197845 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m14:59:26.198718 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m14:59:26.200905 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m14:59:26.201042 [info ] [MainThread]: 
[0m14:59:26.201194 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:59:26.201314 [info ] [MainThread]: 
[0m14:59:26.201439 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:59:26.202369 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.216041, "process_in_blocks": "0", "process_kernel_time": 0.377226, "process_mem_max_rss": "521961472", "process_out_blocks": "0", "process_user_time": 2.396602}
[0m14:59:26.202594 [debug] [MainThread]: Command `dbt run` succeeded at 14:59:26.202560 after 2.22 seconds
[0m14:59:26.202741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11446fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116092f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116093f80>]}
[0m14:59:26.202879 [debug] [MainThread]: Flushing usage events
[0m14:59:26.378305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:17.034061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4b0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c0290>]}


============================== 15:01:17.035844 | 7983f430-8b41-404a-acdf-c14e7ad15037 ==============================
[0m15:01:17.035844 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:01:17.036102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:01:17.116460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10868d1c0>]}
[0m15:01:17.134697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cf260>]}
[0m15:01:17.136018 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m15:01:17.173876 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:01:17.211463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:17.211644 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:17.224821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108646c00>]}
[0m15:01:17.248733 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m15:01:17.249447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m15:01:17.255486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc8830>]}
[0m15:01:17.255729 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m15:01:17.255882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4adb0>]}
[0m15:01:17.256651 [info ] [MainThread]: 
[0m15:01:17.256804 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:17.256922 [info ] [MainThread]: 
[0m15:01:17.257134 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:01:17.258958 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m15:01:17.280375 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m15:01:17.280581 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m15:01:17.280703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:17.286054 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:01:17.286616 [debug] [ThreadPool]: On list_dbt: Close
[0m15:01:17.287594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m15:01:17.287776 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m15:01:17.290423 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m15:01:17.290558 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m15:01:17.290665 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:17.295063 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:01:17.295575 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m15:01:17.295689 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m15:01:17.295848 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:01:17.295943 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m15:01:17.296043 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m15:01:17.296215 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:01:17.296489 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m15:01:17.296596 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m15:01:17.296689 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m15:01:17.296833 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:01:17.296937 [debug] [ThreadPool]: On create_dbt_main: Close
[0m15:01:17.298108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m15:01:17.300247 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m15:01:17.300382 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m15:01:17.300482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:01:17.304548 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:01:17.304720 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m15:01:17.304852 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m15:01:17.312052 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m15:01:17.312585 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m15:01:17.313067 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m15:01:17.313183 [debug] [ThreadPool]: On list_dbt_main: Close
[0m15:01:17.314436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061af5f0>]}
[0m15:01:17.314620 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:17.314727 [debug] [MainThread]: On master: BEGIN
[0m15:01:17.314829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:17.318727 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m15:01:17.318851 [debug] [MainThread]: On master: COMMIT
[0m15:01:17.318955 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:17.319049 [debug] [MainThread]: On master: COMMIT
[0m15:01:17.319196 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:01:17.319300 [debug] [MainThread]: On master: Close
[0m15:01:17.320486 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m15:01:17.320699 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:01:17.320895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m15:01:17.321135 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m15:01:17.323977 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:01:17.324337 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m15:01:17.336504 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:01:17.336863 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:01:17.336993 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m15:01:17.337107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:17.341891 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:01:17.342136 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:01:17.342283 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:01:17.342735 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:17.345010 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:01:17.345157 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:01:17.345387 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:17.346334 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:01:17.346463 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:01:17.346668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:17.351960 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m15:01:17.352114 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:01:17.352234 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m15:01:17.352669 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:17.354335 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:01:17.354470 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m15:01:17.354812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:17.355797 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m15:01:17.360494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ae2d0>]}
[0m15:01:17.360771 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m15:01:17.360996 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m15:01:17.361164 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m15:01:17.361395 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m15:01:17.361661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m15:01:17.361835 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m15:01:17.362883 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:01:17.363161 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m15:01:17.364216 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:01:17.364456 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:01:17.364581 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m15:01:17.364696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:17.368988 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:01:17.369156 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:01:17.369302 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m15:01:18.400923 [debug] [Thread-1 (]: SQL status: OK in 1.031 seconds
[0m15:01:18.402168 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:01:18.402315 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m15:01:18.402637 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.403556 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:01:18.403689 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m15:01:18.403917 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.404509 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m15:01:18.404641 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:01:18.404753 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m15:01:18.426503 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m15:01:18.427466 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:01:18.427611 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m15:01:18.428279 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:01:18.428840 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m15:01:18.437472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b3680>]}
[0m15:01:18.437764 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.08s]
[0m15:01:18.437986 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m15:01:18.438152 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m15:01:18.438369 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m15:01:18.438545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m15:01:18.438687 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m15:01:18.439382 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:01:18.439700 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m15:01:18.446750 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:01:18.447026 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:01:18.447159 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m15:01:18.447280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:18.451430 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:01:18.451600 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:01:18.451752 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m15:01:18.452144 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.453306 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:01:18.453473 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m15:01:18.453723 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.454687 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:01:18.454815 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m15:01:18.455020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.455579 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m15:01:18.455719 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:01:18.455847 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m15:01:18.456285 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.457299 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:01:18.457452 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m15:01:18.457763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.458285 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m15:01:18.462597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d62690>]}
[0m15:01:18.462856 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m15:01:18.463082 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m15:01:18.463233 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m15:01:18.463435 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:01:18.463604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m15:01:18.463746 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m15:01:18.464800 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:01:18.465064 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m15:01:18.466152 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:01:18.466403 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:01:18.466527 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m15:01:18.466644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:18.470832 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:01:18.470995 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:01:18.471134 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:01:18.471393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.472459 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:01:18.472608 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:01:18.472894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.473877 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:01:18.474015 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:01:18.474228 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.474853 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m15:01:18.474994 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:01:18.475121 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m15:01:18.475602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.476443 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:01:18.476632 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m15:01:18.476916 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:01:18.477417 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m15:01:18.481514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7983f430-8b41-404a-acdf-c14e7ad15037', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099b3f80>]}
[0m15:01:18.481819 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m15:01:18.482047 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m15:01:18.482563 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:18.482710 [debug] [MainThread]: On master: BEGIN
[0m15:01:18.482832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:18.486984 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m15:01:18.487116 [debug] [MainThread]: On master: COMMIT
[0m15:01:18.487232 [debug] [MainThread]: Using duckdb connection "master"
[0m15:01:18.487341 [debug] [MainThread]: On master: COMMIT
[0m15:01:18.487488 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:01:18.487599 [debug] [MainThread]: On master: Close
[0m15:01:18.488500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:18.488673 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m15:01:18.488857 [info ] [MainThread]: 
[0m15:01:18.489006 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m15:01:18.489431 [debug] [MainThread]: Command end result
[0m15:01:18.497259 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m15:01:18.497907 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m15:01:18.500047 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m15:01:18.500165 [info ] [MainThread]: 
[0m15:01:18.500307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:01:18.500419 [info ] [MainThread]: 
[0m15:01:18.500549 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:01:18.501268 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5056702, "process_in_blocks": "0", "process_kernel_time": 0.276231, "process_mem_max_rss": "505724928", "process_out_blocks": "0", "process_user_time": 3.147402}
[0m15:01:18.501490 [debug] [MainThread]: Command `dbt run` succeeded at 15:01:18.501449 after 1.51 seconds
[0m15:01:18.501651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10854e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d92e70>]}
[0m15:01:18.501801 [debug] [MainThread]: Flushing usage events
[0m15:01:18.660385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:09.292308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105525a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627ff50>]}


============================== 15:13:09.294094 | dee263ef-7eae-4077-8339-7d87153d863d ==============================
[0m15:13:09.294094 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:13:09.294343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:13:09.373294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dee263ef-7eae-4077-8339-7d87153d863d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639b560>]}
[0m15:13:09.391503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dee263ef-7eae-4077-8339-7d87153d863d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ee9f0>]}
[0m15:13:22.420501 [error] [MainThread]: Encountered an error:

[0m15:13:22.427367 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:13:22.429878 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 13.175697, "process_in_blocks": "0", "process_kernel_time": 0.090251, "process_mem_max_rss": "106201088", "process_out_blocks": "0", "process_user_time": 0.5657}
[0m15:13:22.430672 [debug] [MainThread]: Command `dbt docs serve` failed at 15:13:22.430560 after 13.18 seconds
[0m15:13:22.431202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653a030>]}
[0m15:13:22.431626 [debug] [MainThread]: Flushing usage events
[0m15:13:22.634906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:27.771206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10397db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104684800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046844a0>]}


============================== 15:13:27.772975 | a17ed90b-53cc-4bf9-8c23-c25d4053d8bc ==============================
[0m15:13:27.772975 [info ] [MainThread]: Running with dbt=1.9.2
[0m15:13:27.773222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m15:13:27.851681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a17ed90b-53cc-4bf9-8c23-c25d4053d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104770740>]}
[0m15:13:27.869763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a17ed90b-53cc-4bf9-8c23-c25d4053d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103073350>]}
[0m15:13:27.871017 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m15:13:27.907189 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m15:13:27.944591 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:27.944752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:27.957795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a17ed90b-53cc-4bf9-8c23-c25d4053d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a8c80>]}
[0m15:13:27.964345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a17ed90b-53cc-4bf9-8c23-c25d4053d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b87020>]}
[0m15:13:27.964537 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m15:13:27.964703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a17ed90b-53cc-4bf9-8c23-c25d4053d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485d700>]}
[0m15:13:27.965468 [info ] [MainThread]: 
[0m15:13:27.965619 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:13:27.965729 [info ] [MainThread]: 
[0m15:13:27.965911 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:13:27.967606 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt_main'
[0m15:13:27.989308 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m15:13:27.989495 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m15:13:27.989602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:27.993816 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m15:13:27.993944 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m15:13:27.994055 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m15:13:27.998891 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m15:13:27.999446 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m15:13:27.999925 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m15:13:28.000038 [debug] [ThreadPool]: On list_dbt_main: Close
[0m15:13:28.001022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a17ed90b-53cc-4bf9-8c23-c25d4053d8bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d6090>]}
[0m15:13:28.002007 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m15:13:28.002174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m15:13:28.002301 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m15:13:28.005014 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m15:13:28.005317 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m15:13:28.005546 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m15:13:28.005678 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m15:13:28.005803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m15:13:28.005992 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m15:13:28.006815 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m15:13:28.007064 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m15:13:28.007294 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m15:13:28.007424 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m15:13:28.007556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m15:13:28.007669 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m15:13:28.008804 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m15:13:28.009018 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m15:13:28.009220 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m15:13:28.009348 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m15:13:28.009473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m15:13:28.009585 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m15:13:28.010339 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m15:13:28.010549 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m15:13:28.010742 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m15:13:28.010873 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:13:28.011028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_second_dbt_model, now test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710)
[0m15:13:28.011163 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:13:28.015273 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:13:28.015568 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:13:28.015781 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:13:28.015903 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m15:13:28.016031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710, now test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321)
[0m15:13:28.016143 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m15:13:28.018089 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321"
[0m15:13:28.018285 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m15:13:28.018496 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m15:13:28.018618 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m15:13:28.018751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321, now test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778)
[0m15:13:28.018860 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m15:13:28.020034 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778"
[0m15:13:28.020237 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m15:13:28.020434 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m15:13:28.020553 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m15:13:28.020676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778, now test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493)
[0m15:13:28.020787 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m15:13:28.021892 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:13:28.022084 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m15:13:28.022273 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m15:13:28.022629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:13:28.022766 [debug] [MainThread]: Connection 'test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:13:28.023267 [debug] [MainThread]: Command end result
[0m15:13:28.046703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m15:13:28.047392 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m15:13:28.049625 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m15:13:28.050440 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m15:13:28.050546 [info ] [MainThread]: Building catalog
[0m15:13:28.053316 [debug] [ThreadPool]: Acquiring new duckdb connection 'dbt.information_schema'
[0m15:13:28.055665 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m15:13:28.055767 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m15:13:28.055852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:28.059143 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m15:13:28.059251 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m15:13:28.059379 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dbt'
    )
    select
        'dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m15:13:28.066184 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m15:13:28.073623 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m15:13:28.073965 [debug] [ThreadPool]: Failed to rollback 'dbt.information_schema'
[0m15:13:28.074065 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m15:13:28.083650 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m15:13:28.090871 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m15:13:28.091440 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m15:13:28.091548 [info ] [MainThread]: Catalog written to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m15:13:28.092209 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.35869628, "process_in_blocks": "0", "process_kernel_time": 0.119446, "process_mem_max_rss": "137691136", "process_out_blocks": "0", "process_user_time": 0.737841}
[0m15:13:28.092444 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:13:28.092410 after 0.36 seconds
[0m15:13:28.092557 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:13:28.092640 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m15:13:28.092755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104723230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104771af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb4410>]}
[0m15:13:28.092884 [debug] [MainThread]: Flushing usage events
[0m15:13:28.242887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:37:01.873491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107842060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ebb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101bc230>]}


============================== 08:37:01.876023 | d9d39c22-3d80-4afe-b59c-ba97aa28c6f5 ==============================
[0m08:37:01.876023 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:37:01.876286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m08:37:02.484975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9d39c22-3d80-4afe-b59c-ba97aa28c6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11018c770>]}
[0m08:37:02.503188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9d39c22-3d80-4afe-b59c-ba97aa28c6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110147ef0>]}
[0m08:37:02.504928 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:37:02.569683 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:37:02.614440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:02.614623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:02.627943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9d39c22-3d80-4afe-b59c-ba97aa28c6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105dcbc0>]}
[0m08:37:02.637900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9d39c22-3d80-4afe-b59c-ba97aa28c6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c2cc0>]}
[0m08:37:02.638118 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:37:02.638259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d39c22-3d80-4afe-b59c-ba97aa28c6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042cd40>]}
[0m08:37:02.639071 [info ] [MainThread]: 
[0m08:37:02.639209 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:37:02.639313 [info ] [MainThread]: 
[0m08:37:02.639501 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:37:02.641217 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt_main'
[0m08:37:02.665875 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:37:02.666043 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:37:02.666145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:02.675624 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m08:37:02.675782 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:37:02.675906 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:37:02.681806 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m08:37:02.682399 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:37:02.683273 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:37:02.683386 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:37:02.684357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9d39c22-3d80-4afe-b59c-ba97aa28c6f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105fee10>]}
[0m08:37:02.685519 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:37:02.685676 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:37:02.685797 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:37:02.688458 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:37:02.688729 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:37:02.688952 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:37:02.689079 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:37:02.689264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:37:02.689389 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:37:02.690172 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:37:02.690370 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:37:02.690567 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:37:02.690687 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:37:02.690814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:37:02.690924 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:37:02.692033 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:37:02.692241 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:37:02.692455 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:37:02.692588 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:37:02.692716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:37:02.692827 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:37:02.693614 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:37:02.693809 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:37:02.694002 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:37:02.694128 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:02.694285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_second_dbt_model, now test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710)
[0m08:37:02.694440 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:02.698590 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:37:02.698840 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:02.699065 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:02.699192 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:37:02.699332 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710, now test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321)
[0m08:37:02.699447 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:37:02.701381 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321"
[0m08:37:02.701601 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:37:02.701798 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:37:02.701923 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:37:02.702047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321, now test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778)
[0m08:37:02.702158 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:37:02.703317 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778"
[0m08:37:02.703510 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:37:02.703702 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:37:02.703825 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:37:02.703948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778, now test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:37:02.704059 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:37:02.705183 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:37:02.705394 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:37:02.705606 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:37:02.705977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:02.706082 [debug] [MainThread]: Connection 'test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:37:02.706560 [debug] [MainThread]: Command end result
[0m08:37:02.730163 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:37:02.731005 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:37:02.733466 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:37:02.734618 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m08:37:02.734716 [info ] [MainThread]: Building catalog
[0m08:37:02.737621 [debug] [ThreadPool]: Acquiring new duckdb connection 'dbt.information_schema'
[0m08:37:02.740074 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m08:37:02.740190 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m08:37:02.740283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:02.743722 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m08:37:02.743887 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m08:37:02.744033 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dbt'
    )
    select
        'dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m08:37:02.750124 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m08:37:02.757625 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m08:37:02.757975 [debug] [ThreadPool]: Failed to rollback 'dbt.information_schema'
[0m08:37:02.758078 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m08:37:02.767873 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m08:37:02.774895 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:37:02.775437 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:37:02.775552 [info ] [MainThread]: Catalog written to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m08:37:02.803699 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.9738755, "process_in_blocks": "0", "process_kernel_time": 0.179343, "process_mem_max_rss": "141328384", "process_out_blocks": "0", "process_user_time": 0.840093}
[0m08:37:02.803981 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:37:02.803941 after 0.97 seconds
[0m08:37:02.804109 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:37:02.804207 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m08:37:02.804336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101bc320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101bc170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106e4ec0>]}
[0m08:37:02.804482 [debug] [MainThread]: Flushing usage events
[0m08:37:03.020505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:45:34.239035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e500b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb0b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb0710>]}


============================== 08:45:34.241977 | 43059424-2a50-40ba-84e9-e378d63589ac ==============================
[0m08:45:34.241977 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:45:34.242230 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:45:34.325493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43059424-2a50-40ba-84e9-e378d63589ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f0e990>]}
[0m08:45:34.344374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43059424-2a50-40ba-84e9-e378d63589ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc8170>]}
[0m08:45:34.345758 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:45:34.383362 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:45:34.421444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m08:45:34.421714 [debug] [MainThread]: Partial parsing: added file: nyc_yellow_taxi://models/taxi_rides/model_properties.yml
[0m08:45:34.482192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43059424-2a50-40ba-84e9-e378d63589ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e3b920>]}
[0m08:45:34.487533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43059424-2a50-40ba-84e9-e378d63589ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105588f80>]}
[0m08:45:34.487732 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:45:34.487873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43059424-2a50-40ba-84e9-e378d63589ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105347c20>]}
[0m08:45:34.488719 [info ] [MainThread]: 
[0m08:45:34.488876 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:45:34.488992 [info ] [MainThread]: 
[0m08:45:34.489190 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:45:34.490993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt_main'
[0m08:45:34.512327 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:45:34.512539 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:45:34.512659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:34.518063 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:45:34.518267 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:45:34.518390 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:45:34.525686 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:45:34.526330 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:45:34.526824 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:45:34.526943 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:45:34.528220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43059424-2a50-40ba-84e9-e378d63589ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fa7b0>]}
[0m08:45:34.529255 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:45:34.529445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:45:34.529588 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:45:34.532450 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:45:34.532780 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:45:34.533034 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:45:34.533179 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:45:34.533342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:45:34.533475 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:45:34.534315 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:45:34.534567 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:45:34.534774 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:45:34.534906 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:45:34.535035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:45:34.535162 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:45:34.535759 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:45:34.536012 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:45:34.536245 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:45:34.536381 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:45:34.536524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:45:34.536645 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:45:34.537465 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:45:34.537682 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:45:34.537959 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:45:34.538103 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:45:34.538287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_second_dbt_model, now test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710)
[0m08:45:34.538419 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:45:34.542434 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:45:34.542661 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:45:34.542887 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:45:34.543020 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:45:34.543159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710, now test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321)
[0m08:45:34.543279 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:45:34.545214 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321"
[0m08:45:34.545430 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:45:34.545634 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:45:34.545773 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:45:34.545906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321, now test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778)
[0m08:45:34.546025 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:45:34.547201 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778"
[0m08:45:34.547402 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:45:34.547605 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:45:34.547742 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:45:34.547877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778, now test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:45:34.547998 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:45:34.549198 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:45:34.549416 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:45:34.549640 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:45:34.550025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:34.550144 [debug] [MainThread]: Connection 'test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:45:34.550629 [debug] [MainThread]: Command end result
[0m08:45:34.574756 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:45:34.575490 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:45:34.577696 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:45:34.578422 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m08:45:34.578539 [info ] [MainThread]: Building catalog
[0m08:45:34.581422 [debug] [ThreadPool]: Acquiring new duckdb connection 'dbt.information_schema'
[0m08:45:34.584108 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m08:45:34.584246 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m08:45:34.584344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:34.588475 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:45:34.588610 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m08:45:34.588750 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dbt'
    )
    select
        'dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m08:45:34.597917 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m08:45:34.605797 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m08:45:34.606220 [debug] [ThreadPool]: Failed to rollback 'dbt.information_schema'
[0m08:45:34.606338 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m08:45:34.616655 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m08:45:34.623594 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:45:34.624157 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:45:34.624277 [info ] [MainThread]: Catalog written to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m08:45:34.625048 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.42475995, "process_in_blocks": "0", "process_kernel_time": 0.122919, "process_mem_max_rss": "145801216", "process_out_blocks": "0", "process_user_time": 0.800308}
[0m08:45:34.625290 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:45:34.625251 after 0.43 seconds
[0m08:45:34.625426 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:45:34.625530 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m08:45:34.625652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ab9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104127920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c37d0>]}
[0m08:45:34.625787 [debug] [MainThread]: Flushing usage events
[0m08:45:34.783948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:45:35.410235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109130620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c46b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c4200>]}


============================== 08:45:35.412117 | 989e2a60-66d8-4cbd-b1d3-a335d8ccf46f ==============================
[0m08:45:35.412117 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:45:35.412365 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m08:45:35.493966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '989e2a60-66d8-4cbd-b1d3-a335d8ccf46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c5b80>]}
[0m08:45:35.512557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '989e2a60-66d8-4cbd-b1d3-a335d8ccf46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109133740>]}
[0m08:49:23.433191 [error] [MainThread]: Encountered an error:

[0m08:49:23.437319 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m08:49:23.438549 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 228.07071, "process_in_blocks": "0", "process_kernel_time": 0.097363, "process_mem_max_rss": "107692032", "process_out_blocks": "0", "process_user_time": 0.578222}
[0m08:49:23.438981 [debug] [MainThread]: Command `dbt docs serve` failed at 08:49:23.438909 after 228.07 seconds
[0m08:49:23.439337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096932f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10974f4a0>]}
[0m08:49:23.439600 [debug] [MainThread]: Flushing usage events
[0m08:49:23.592619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:44.021490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106429670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cc350>]}


============================== 08:51:44.023859 | 97a04ea3-5533-4e74-8ce6-bb868175253c ==============================
[0m08:51:44.023859 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:51:44.024125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:51:44.031910 [info ] [MainThread]: dbt version: 1.9.2
[0m08:51:44.032072 [info ] [MainThread]: python version: 3.12.3
[0m08:51:44.032199 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
[0m08:51:44.032320 [info ] [MainThread]: os info: macOS-15.3.1-arm64-arm-64bit
[0m08:51:44.094880 [info ] [MainThread]: Using profiles dir at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi
[0m08:51:44.095109 [info ] [MainThread]: Using profiles.yml file at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/profiles.yml
[0m08:51:44.095243 [info ] [MainThread]: Using dbt_project.yml file at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/dbt_project.yml
[0m08:51:44.097069 [info ] [MainThread]: adapter type: duckdb
[0m08:51:44.097267 [info ] [MainThread]: adapter version: 1.9.1
[0m08:51:44.128701 [info ] [MainThread]: Configuration:
[0m08:51:44.128977 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:51:44.129108 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:51:44.129242 [info ] [MainThread]: Required dependencies:
[0m08:51:44.129413 [debug] [MainThread]: Executing "git --help"
[0m08:51:44.138410 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:51:44.138870 [debug] [MainThread]: STDERR: "b''"
[0m08:51:44.139020 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:51:44.139160 [info ] [MainThread]: Connection:
[0m08:51:44.139309 [info ] [MainThread]:   database: dbt
[0m08:51:44.139428 [info ] [MainThread]:   schema: main
[0m08:51:44.139543 [info ] [MainThread]:   path: dbt.duckdb
[0m08:51:44.139653 [info ] [MainThread]:   config_options: None
[0m08:51:44.139762 [info ] [MainThread]:   extensions: None
[0m08:51:44.139873 [info ] [MainThread]:   settings: {}
[0m08:51:44.139981 [info ] [MainThread]:   external_root: .
[0m08:51:44.140090 [info ] [MainThread]:   use_credential_provider: None
[0m08:51:44.140198 [info ] [MainThread]:   attach: None
[0m08:51:44.140305 [info ] [MainThread]:   filesystems: None
[0m08:51:44.140411 [info ] [MainThread]:   remote: None
[0m08:51:44.140522 [info ] [MainThread]:   plugins: None
[0m08:51:44.140628 [info ] [MainThread]:   disable_transactions: False
[0m08:51:44.140953 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:51:44.184426 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:51:44.205591 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:51:44.205773 [debug] [MainThread]: On debug: select 1 as id
[0m08:51:44.205891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:44.250245 [debug] [MainThread]: SQL status: OK in 0.044 seconds
[0m08:51:44.250750 [debug] [MainThread]: On debug: Close
[0m08:51:44.252470 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:51:44.252654 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:51:44.253930 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.27196747, "process_in_blocks": "0", "process_kernel_time": 0.141592, "process_mem_max_rss": "120193024", "process_out_blocks": "0", "process_user_time": 0.587395}
[0m08:51:44.254220 [debug] [MainThread]: Command `dbt debug` succeeded at 08:51:44.254174 after 0.27 seconds
[0m08:51:44.254379 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:51:44.254539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106429670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108653ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea5e80>]}
[0m08:51:44.254725 [debug] [MainThread]: Flushing usage events
[0m08:51:44.422818 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:48.266061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bc7a0>]}


============================== 08:51:48.267825 | eb8aef43-4c5b-41c8-bc04-8b5ff91024a6 ==============================
[0m08:51:48.267825 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:51:48.268070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:51:48.355092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a6e750>]}
[0m08:51:48.373646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae46e0>]}
[0m08:51:48.375032 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:51:48.425881 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:51:48.469016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:51:48.469217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:51:48.482597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ddde80>]}
[0m08:51:48.506734 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:51:48.507716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:51:48.514889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dddb50>]}
[0m08:51:48.515095 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:51:48.515242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0fda0>]}
[0m08:51:48.516026 [info ] [MainThread]: 
[0m08:51:48.516195 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:51:48.516318 [info ] [MainThread]: 
[0m08:51:48.516537 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:51:48.518506 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m08:51:48.540205 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m08:51:48.540422 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m08:51:48.540547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:48.547860 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:51:48.548411 [debug] [ThreadPool]: On list_dbt: Close
[0m08:51:48.549371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m08:51:48.549560 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m08:51:48.552061 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:51:48.552190 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m08:51:48.552296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:48.556481 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:51:48.556996 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:51:48.557108 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m08:51:48.557268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:51:48.557367 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:51:48.557471 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m08:51:48.557718 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:51:48.558066 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:51:48.558190 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:51:48.558296 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:51:48.558469 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:51:48.558577 [debug] [ThreadPool]: On create_dbt_main: Close
[0m08:51:48.559706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m08:51:48.561765 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:51:48.561883 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:51:48.561983 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:51:48.565982 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:51:48.566100 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:51:48.566210 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:51:48.575156 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m08:51:48.575679 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:51:48.576544 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:51:48.576674 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:51:48.577911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8ba9f0>]}
[0m08:51:48.578150 [debug] [MainThread]: Using duckdb connection "master"
[0m08:51:48.578278 [debug] [MainThread]: On master: BEGIN
[0m08:51:48.578387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:51:48.582345 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:51:48.582507 [debug] [MainThread]: On master: COMMIT
[0m08:51:48.582635 [debug] [MainThread]: Using duckdb connection "master"
[0m08:51:48.582739 [debug] [MainThread]: On master: COMMIT
[0m08:51:48.582893 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:51:48.583012 [debug] [MainThread]: On master: Close
[0m08:51:48.584241 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:51:48.584498 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:51:48.584702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:51:48.584853 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:51:48.587946 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:51:48.588555 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:51:48.601152 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:51:48.601576 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:51:48.601720 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m08:51:48.601846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:48.606355 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:51:48.606558 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:51:48.606702 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:51:48.608030 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:51:48.610359 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:51:48.610503 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:51:48.610816 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:48.611873 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:51:48.612016 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:51:48.612243 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:48.617666 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:51:48.617813 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:51:48.617940 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:51:48.618908 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:51:48.620771 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:51:48.620934 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:51:48.621254 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:48.622147 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m08:51:48.626996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc028a0>]}
[0m08:51:48.627278 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:51:48.627501 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:51:48.627667 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:51:48.627900 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m08:51:48.628123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:51:48.628304 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:51:48.629416 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:51:48.629913 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:51:48.631006 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:51:48.631457 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:51:48.631601 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m08:51:48.631730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:48.635977 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:51:48.636158 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:51:48.636307 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m08:51:50.047651 [debug] [Thread-1 (]: SQL status: OK in 1.411 seconds
[0m08:51:50.048964 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:51:50.049118 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m08:51:50.049445 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.050451 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:51:50.050582 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m08:51:50.050810 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.051427 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:51:50.051552 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:51:50.051666 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:51:50.058776 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m08:51:50.059813 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:51:50.059964 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m08:51:50.060661 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:51:50.061195 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m08:51:50.069907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2118e0>]}
[0m08:51:50.070205 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.44s]
[0m08:51:50.070417 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:51:50.070592 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:51:50.070806 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m08:51:50.070983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:51:50.071181 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:51:50.072096 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:51:50.072432 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:51:50.079988 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:51:50.080418 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:51:50.080569 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m08:51:50.080700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:50.085579 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:51:50.085773 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:51:50.085912 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m08:51:50.086583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:51:50.087690 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:51:50.087848 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m08:51:50.088193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.089570 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:51:50.089782 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m08:51:50.090115 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.090709 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:51:50.090844 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:51:50.090965 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:51:50.091353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.092119 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:51:50.092250 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m08:51:50.092506 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.092950 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m08:51:50.097004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c22f140>]}
[0m08:51:50.097268 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.03s]
[0m08:51:50.097480 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:51:50.097638 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:51:50.097838 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:51:50.098013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:51:50.098187 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:51:50.099344 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:51:50.099636 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:51:50.100766 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:51:50.101028 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:51:50.101156 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m08:51:50.101275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:51:50.105405 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:51:50.105570 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:51:50.105702 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:51:50.105958 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.106983 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:51:50.107114 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:51:50.107381 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.108265 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:51:50.108392 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:51:50.108592 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.109207 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:51:50.109335 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:51:50.109451 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:51:50.109794 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.110557 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:51:50.110750 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:51:50.111018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:51:50.111457 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m08:51:50.115556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb8aef43-4c5b-41c8-bc04-8b5ff91024a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc0dd00>]}
[0m08:51:50.115820 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m08:51:50.116024 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:51:50.116563 [debug] [MainThread]: Using duckdb connection "master"
[0m08:51:50.116729 [debug] [MainThread]: On master: BEGIN
[0m08:51:50.116854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:51:50.120963 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:51:50.121139 [debug] [MainThread]: On master: COMMIT
[0m08:51:50.121266 [debug] [MainThread]: Using duckdb connection "master"
[0m08:51:50.121382 [debug] [MainThread]: On master: COMMIT
[0m08:51:50.121555 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:51:50.121682 [debug] [MainThread]: On master: Close
[0m08:51:50.122630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:51:50.122783 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m08:51:50.122948 [info ] [MainThread]: 
[0m08:51:50.123081 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m08:51:50.123479 [debug] [MainThread]: Command end result
[0m08:51:50.131420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:51:50.132209 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:51:50.134374 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:51:50.134504 [info ] [MainThread]: 
[0m08:51:50.134651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:51:50.134783 [info ] [MainThread]: 
[0m08:51:50.134923 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:51:50.135703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9085582, "process_in_blocks": "0", "process_kernel_time": 0.364872, "process_mem_max_rss": "489537536", "process_out_blocks": "0", "process_user_time": 3.281963}
[0m08:51:50.136019 [debug] [MainThread]: Command `dbt run` succeeded at 08:51:50.135969 after 1.91 seconds
[0m08:51:50.136213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097bc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080643b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c293bf0>]}
[0m08:51:50.136385 [debug] [MainThread]: Flushing usage events
[0m08:51:50.282575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:04.161993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df3e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d83fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db4530>]}


============================== 08:52:04.163737 | 9d82bd8f-d03b-46e0-93e7-2867fcc792f0 ==============================
[0m08:52:04.163737 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:04.163992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:04.244875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102df3e30>]}
[0m08:52:04.263488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c3b30>]}
[0m08:52:04.264846 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:52:04.302489 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:52:04.339211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:04.339408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:04.352616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa7d40>]}
[0m08:52:04.376436 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:52:04.377200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:52:04.383019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050d1760>]}
[0m08:52:04.383259 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:52:04.383410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a0e90>]}
[0m08:52:04.384203 [info ] [MainThread]: 
[0m08:52:04.384366 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:52:04.384484 [info ] [MainThread]: 
[0m08:52:04.384701 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:52:04.386544 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m08:52:04.404928 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m08:52:04.405111 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m08:52:04.405227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:04.410684 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:52:04.411203 [debug] [ThreadPool]: On list_dbt: Close
[0m08:52:04.412139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m08:52:04.412314 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m08:52:04.414784 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:04.414906 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m08:52:04.415009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:04.419149 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:52:04.419707 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:04.419834 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m08:52:04.420012 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:04.420114 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:04.420216 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m08:52:04.420393 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:04.420678 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:52:04.420793 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:04.420890 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:52:04.421041 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:04.421143 [debug] [ThreadPool]: On create_dbt_main: Close
[0m08:52:04.422284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m08:52:04.424425 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:52:04.424580 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:52:04.424686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:04.428776 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:52:04.428905 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:52:04.429019 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:52:04.436134 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:52:04.436655 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:52:04.437120 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:52:04.437229 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:52:04.438428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e706e0>]}
[0m08:52:04.438630 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:04.438745 [debug] [MainThread]: On master: BEGIN
[0m08:52:04.438844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:04.442578 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:52:04.442703 [debug] [MainThread]: On master: COMMIT
[0m08:52:04.442810 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:04.442906 [debug] [MainThread]: On master: COMMIT
[0m08:52:04.443088 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:04.443251 [debug] [MainThread]: On master: Close
[0m08:52:04.444412 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:04.444611 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:52:04.444781 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:52:04.444924 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:04.447810 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:04.448190 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:04.460686 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:04.461097 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:04.461269 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m08:52:04.461426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:04.465527 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:04.465673 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:04.465824 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:52:04.466251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:04.468783 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:04.468969 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:52:04.469337 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:04.470611 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:04.470775 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:52:04.471032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:04.476771 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:52:04.476950 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:04.477084 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:52:04.477579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:04.479216 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:04.479349 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:52:04.479689 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:04.480722 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m08:52:04.485626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040aa3f0>]}
[0m08:52:04.485933 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:52:04.486165 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:04.486328 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:04.486607 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m08:52:04.486832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:52:04.486993 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:04.488015 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:04.488293 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:04.489345 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:04.489592 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:04.489730 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m08:52:04.489864 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:04.494291 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:04.494459 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:04.494592 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m08:52:05.514716 [debug] [Thread-1 (]: SQL status: OK in 1.020 seconds
[0m08:52:05.517003 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:05.517245 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m08:52:05.517631 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.519321 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:05.519842 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m08:52:05.520524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.521505 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:52:05.521662 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:05.521785 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:52:05.544205 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m08:52:05.545229 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:05.545370 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m08:52:05.546022 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:05.546535 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m08:52:05.555086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9f1a0>]}
[0m08:52:05.555379 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.07s]
[0m08:52:05.555594 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:05.555757 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:05.555964 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m08:52:05.556140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:52:05.556287 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:05.557125 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:05.557488 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:05.565103 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:05.565403 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:05.565536 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m08:52:05.565654 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:05.570072 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:05.570267 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:05.570418 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m08:52:05.570835 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.571933 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:05.572070 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m08:52:05.572302 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.573316 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:05.573463 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m08:52:05.573700 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.574273 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:52:05.574418 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:05.574544 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:52:05.574920 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.575690 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:05.575817 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m08:52:05.576065 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.576507 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m08:52:05.580691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105756450>]}
[0m08:52:05.580929 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m08:52:05.581127 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:05.581278 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:05.581466 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:52:05.581631 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:52:05.581768 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:05.582885 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:05.583172 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:05.584365 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:05.584645 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:05.584779 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m08:52:05.584908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:05.589035 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:05.589196 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:05.589336 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:52:05.589591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.590594 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:05.590752 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:52:05.591041 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.592010 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:05.592152 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:52:05.592353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.592960 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:52:05.593091 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:05.593205 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:52:05.593573 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.594319 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:05.594515 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:52:05.594776 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:05.595225 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m08:52:05.599804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d82bd8f-d03b-46e0-93e7-2867fcc792f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f7d70>]}
[0m08:52:05.600043 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m08:52:05.600308 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:05.600995 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:05.601189 [debug] [MainThread]: On master: BEGIN
[0m08:52:05.601320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:05.605461 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:52:05.605602 [debug] [MainThread]: On master: COMMIT
[0m08:52:05.605721 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:05.605825 [debug] [MainThread]: On master: COMMIT
[0m08:52:05.605977 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:05.606092 [debug] [MainThread]: On master: Close
[0m08:52:05.606927 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:05.607069 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m08:52:05.607247 [info ] [MainThread]: 
[0m08:52:05.607391 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m08:52:05.607802 [debug] [MainThread]: Command end result
[0m08:52:05.615365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:52:05.616008 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:52:05.618262 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:52:05.618388 [info ] [MainThread]: 
[0m08:52:05.618536 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:05.618651 [info ] [MainThread]: 
[0m08:52:05.618780 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:52:05.619862 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4966165, "process_in_blocks": "0", "process_kernel_time": 0.25624, "process_mem_max_rss": "515817472", "process_out_blocks": "0", "process_user_time": 2.234884}
[0m08:52:05.620113 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:05.620074 after 1.50 seconds
[0m08:52:05.620282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bfb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105787da0>]}
[0m08:52:05.620438 [debug] [MainThread]: Flushing usage events
[0m08:52:05.765237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:12.180488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ef9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108094890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080943e0>]}


============================== 08:52:12.182418 | 5f16caa5-4938-4776-a9c7-df9d0879618f ==============================
[0m08:52:12.182418 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:12.182683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:12.265423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba7b60>]}
[0m08:52:12.284239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107141700>]}
[0m08:52:12.285588 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:52:12.322947 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:52:12.359868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:12.360049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:12.373256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082628d0>]}
[0m08:52:12.398326 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:52:12.399116 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:52:12.404796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084dc080>]}
[0m08:52:12.405004 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:52:12.405152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082689e0>]}
[0m08:52:12.405948 [info ] [MainThread]: 
[0m08:52:12.406116 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:52:12.406272 [info ] [MainThread]: 
[0m08:52:12.406566 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:52:12.408621 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m08:52:12.426690 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m08:52:12.426881 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m08:52:12.427000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:12.432359 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:52:12.432884 [debug] [ThreadPool]: On list_dbt: Close
[0m08:52:12.433833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m08:52:12.434049 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m08:52:12.436591 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:12.436727 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m08:52:12.436836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:12.441407 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:52:12.441925 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:12.442048 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m08:52:12.442211 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:12.442305 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:12.442403 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m08:52:12.442578 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:12.442855 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:52:12.442964 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:12.443060 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:52:12.443207 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:12.443308 [debug] [ThreadPool]: On create_dbt_main: Close
[0m08:52:12.444511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m08:52:12.446603 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:52:12.446752 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:52:12.446857 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:12.450953 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:52:12.451086 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:52:12.451204 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:52:12.458615 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:52:12.459145 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:52:12.459623 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:52:12.459739 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:52:12.460962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a7260>]}
[0m08:52:12.461152 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:12.461258 [debug] [MainThread]: On master: BEGIN
[0m08:52:12.461354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:12.465219 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:52:12.465356 [debug] [MainThread]: On master: COMMIT
[0m08:52:12.465466 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:12.465567 [debug] [MainThread]: On master: COMMIT
[0m08:52:12.465716 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:12.465820 [debug] [MainThread]: On master: Close
[0m08:52:12.467066 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:12.467268 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:52:12.467437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:52:12.467575 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:12.470409 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:12.470726 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:12.483000 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:12.483385 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:12.483517 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m08:52:12.483640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:12.487695 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:12.487846 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:12.487990 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:52:12.488404 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:12.490883 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:12.491067 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:52:12.491357 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:12.492347 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:12.492475 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:52:12.492677 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:12.498001 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:52:12.498140 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:12.498259 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:52:12.498699 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:12.500545 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:12.500694 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:52:12.501018 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:12.501880 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m08:52:12.506624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10826a120>]}
[0m08:52:12.506920 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:52:12.507154 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:12.507324 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:12.507585 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m08:52:12.507776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:52:12.508010 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:12.509135 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:12.509453 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:12.510522 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:12.510783 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:12.510908 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m08:52:12.511026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:12.515192 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:12.515350 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:12.515484 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m08:52:13.529191 [debug] [Thread-1 (]: SQL status: OK in 1.013 seconds
[0m08:52:13.533332 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:13.533509 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m08:52:13.533845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.534804 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:13.534934 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m08:52:13.535153 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.535753 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:52:13.535876 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:13.535988 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:52:13.558016 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m08:52:13.559107 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:13.559257 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m08:52:13.559983 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:13.560496 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m08:52:13.570234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080e20f0>]}
[0m08:52:13.570592 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.06s]
[0m08:52:13.570817 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:13.570983 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:13.571196 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m08:52:13.571373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:52:13.571520 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:13.572283 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:13.572585 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:13.580159 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:13.580460 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:13.580605 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m08:52:13.580738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:13.585111 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:13.585301 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:13.585452 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m08:52:13.585850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.586944 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:13.587076 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m08:52:13.587299 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.588272 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:13.588398 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m08:52:13.588600 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.589129 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:52:13.589254 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:13.589367 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:52:13.589746 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.590546 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:13.590687 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m08:52:13.590951 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.591402 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m08:52:13.595391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090625a0>]}
[0m08:52:13.595647 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m08:52:13.595858 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:13.596011 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:13.596221 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:52:13.596401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:52:13.596719 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:13.598046 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:13.598373 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:13.599498 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:13.599748 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:13.599877 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m08:52:13.599996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:13.604141 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:13.604317 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:13.604460 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:52:13.604715 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.605730 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:13.605863 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:52:13.606135 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.607054 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:13.607194 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:52:13.607402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.608032 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:52:13.608159 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:13.608271 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:52:13.608636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.609343 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:13.609534 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:52:13.609800 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:13.610277 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m08:52:13.614383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f16caa5-4938-4776-a9c7-df9d0879618f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108af8110>]}
[0m08:52:13.614703 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m08:52:13.614939 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:13.615488 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:13.615634 [debug] [MainThread]: On master: BEGIN
[0m08:52:13.615756 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:13.619912 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:52:13.620070 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.620199 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:13.620301 [debug] [MainThread]: On master: COMMIT
[0m08:52:13.620481 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:13.620666 [debug] [MainThread]: On master: Close
[0m08:52:13.621463 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:13.621577 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m08:52:13.621725 [info ] [MainThread]: 
[0m08:52:13.621859 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m08:52:13.622280 [debug] [MainThread]: Command end result
[0m08:52:13.630128 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:52:13.630755 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:52:13.633187 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:52:13.633344 [info ] [MainThread]: 
[0m08:52:13.633489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:13.633606 [info ] [MainThread]: 
[0m08:52:13.633735 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:52:13.634537 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4927987, "process_in_blocks": "0", "process_kernel_time": 0.270498, "process_mem_max_rss": "475086848", "process_out_blocks": "0", "process_user_time": 3.149188}
[0m08:52:13.634815 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:13.634774 after 1.49 seconds
[0m08:52:13.634982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10817b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109093cb0>]}
[0m08:52:13.635137 [debug] [MainThread]: Flushing usage events
[0m08:52:13.782361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:19.600861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c0f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c04a0>]}


============================== 08:52:19.602743 | 503967de-b2e1-4cd1-b982-244cdff4229f ==============================
[0m08:52:19.602743 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:19.603012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:19.683226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572da60>]}
[0m08:52:19.701546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10570c110>]}
[0m08:52:19.702870 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:52:19.740628 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:52:19.777947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:19.778138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:19.791716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b7e30>]}
[0m08:52:19.816529 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:52:19.817260 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:52:19.822921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac8650>]}
[0m08:52:19.823128 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:52:19.823265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10557d9a0>]}
[0m08:52:19.824028 [info ] [MainThread]: 
[0m08:52:19.824190 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:52:19.824309 [info ] [MainThread]: 
[0m08:52:19.824524 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:52:19.826584 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m08:52:19.845146 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m08:52:19.845349 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m08:52:19.845498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:19.850979 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:52:19.851537 [debug] [ThreadPool]: On list_dbt: Close
[0m08:52:19.852459 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m08:52:19.852628 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m08:52:19.855123 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:19.855243 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m08:52:19.855346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:19.859287 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:52:19.859762 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:19.859872 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m08:52:19.860022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:19.860116 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:19.860213 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m08:52:19.860382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:19.860658 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:52:19.860770 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:52:19.860863 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:52:19.861006 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:52:19.861111 [debug] [ThreadPool]: On create_dbt_main: Close
[0m08:52:19.862204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m08:52:19.864428 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:52:19.864577 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:52:19.864682 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:52:19.869003 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:52:19.869127 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:52:19.869239 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:52:19.876387 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:52:19.876920 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:52:19.877389 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:52:19.877500 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:52:19.878713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10551cbc0>]}
[0m08:52:19.878946 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:19.879069 [debug] [MainThread]: On master: BEGIN
[0m08:52:19.879164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:52:19.882968 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:52:19.883094 [debug] [MainThread]: On master: COMMIT
[0m08:52:19.883201 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:19.883296 [debug] [MainThread]: On master: COMMIT
[0m08:52:19.883442 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:19.883541 [debug] [MainThread]: On master: Close
[0m08:52:19.884793 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:19.884991 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:52:19.885165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:52:19.885303 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:19.888235 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:19.888591 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:19.900918 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:19.901313 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:19.901447 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m08:52:19.901566 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:19.905743 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:19.905893 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:19.906034 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:52:19.906444 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:19.908666 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:19.908803 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:52:19.909032 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:19.909972 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:19.910097 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:52:19.910302 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:19.915790 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:52:19.915959 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:19.916079 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:52:19.916581 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:19.918213 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:19.918345 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:52:19.918659 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:19.919550 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m08:52:19.924037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e037d0>]}
[0m08:52:19.924284 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:52:19.924498 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:19.924660 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:19.924935 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m08:52:19.925136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:52:19.925284 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:19.926304 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:19.926593 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:19.927648 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:19.927878 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:19.928002 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m08:52:19.928129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:19.932558 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:19.932725 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:19.932853 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m08:52:20.952754 [debug] [Thread-1 (]: SQL status: OK in 1.020 seconds
[0m08:52:20.954087 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:20.954240 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m08:52:20.954572 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:20.955502 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:20.955632 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m08:52:20.955862 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:20.956424 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:52:20.956554 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:20.956674 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:52:20.984670 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m08:52:20.985670 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:20.985818 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m08:52:20.986508 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:52:20.987026 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m08:52:20.995982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0d070>]}
[0m08:52:20.996347 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.07s]
[0m08:52:20.996605 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:20.996781 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:20.997016 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m08:52:20.997207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:52:20.997366 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:20.998113 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:20.998427 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:21.005808 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:21.006164 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:21.006305 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m08:52:21.006428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:21.010865 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:21.011066 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:21.011205 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m08:52:21.011579 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.012645 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:21.012778 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m08:52:21.013010 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.014061 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:21.014193 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m08:52:21.014421 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.014956 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:52:21.015085 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:21.015203 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:52:21.015569 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.016327 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:21.016454 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m08:52:21.016702 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.017138 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m08:52:21.021313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b50770>]}
[0m08:52:21.021668 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m08:52:21.021902 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:21.022069 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:21.022289 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:52:21.022476 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:52:21.022687 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:21.023932 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:21.024238 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:21.025368 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:21.025624 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:21.025751 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m08:52:21.025870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:52:21.029982 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:52:21.030156 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:21.030308 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:52:21.030602 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.031655 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:21.031788 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:52:21.032062 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.032933 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:21.033060 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:52:21.033256 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.033855 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:52:21.033990 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:21.034104 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:52:21.034454 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.035131 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:21.035301 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:52:21.035575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:52:21.036067 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m08:52:21.041028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503967de-b2e1-4cd1-b982-244cdff4229f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e0c260>]}
[0m08:52:21.041368 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m08:52:21.041594 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:21.042097 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:21.042242 [debug] [MainThread]: On master: BEGIN
[0m08:52:21.042359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:52:21.046464 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:52:21.046604 [debug] [MainThread]: On master: COMMIT
[0m08:52:21.046723 [debug] [MainThread]: Using duckdb connection "master"
[0m08:52:21.046834 [debug] [MainThread]: On master: COMMIT
[0m08:52:21.047013 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:52:21.047155 [debug] [MainThread]: On master: Close
[0m08:52:21.047989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:21.048151 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m08:52:21.048309 [info ] [MainThread]: 
[0m08:52:21.048444 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.22 seconds (1.22s).
[0m08:52:21.048857 [debug] [MainThread]: Command end result
[0m08:52:21.056662 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:52:21.057358 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:52:21.059491 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:52:21.059609 [info ] [MainThread]: 
[0m08:52:21.059745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:21.059860 [info ] [MainThread]: 
[0m08:52:21.059988 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:52:21.060956 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5011925, "process_in_blocks": "0", "process_kernel_time": 0.278383, "process_mem_max_rss": "505184256", "process_out_blocks": "0", "process_user_time": 3.150063}
[0m08:52:21.061225 [debug] [MainThread]: Command `dbt run` succeeded at 08:52:21.061185 after 1.50 seconds
[0m08:52:21.061398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045cfc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053465d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b93c20>]}
[0m08:52:21.061560 [debug] [MainThread]: Flushing usage events
[0m08:52:21.204666 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:32.211007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ac0590>]}


============================== 08:52:32.212814 | a93b0b63-090e-44f1-a5ca-52c17cc6fbac ==============================
[0m08:52:32.212814 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:32.213060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:52:32.293333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a93b0b63-090e-44f1-a5ca-52c17cc6fbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c05dc0>]}
[0m08:52:32.311994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a93b0b63-090e-44f1-a5ca-52c17cc6fbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066894c0>]}
[0m08:52:32.313320 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:52:32.351844 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:52:32.389653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:52:32.389853 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:52:32.403440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a93b0b63-090e-44f1-a5ca-52c17cc6fbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8b200>]}
[0m08:52:32.409498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a93b0b63-090e-44f1-a5ca-52c17cc6fbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c35f0>]}
[0m08:52:32.409697 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:52:32.409835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a93b0b63-090e-44f1-a5ca-52c17cc6fbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1f230>]}
[0m08:52:32.410720 [info ] [MainThread]: 
[0m08:52:32.410891 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:52:32.411022 [info ] [MainThread]: 
[0m08:52:32.411248 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:52:32.413341 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt_main'
[0m08:52:32.432597 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:52:32.432806 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:52:32.432929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:32.437924 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:52:32.438062 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:52:32.438183 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:52:32.445600 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:52:32.446270 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:52:32.446765 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:52:32.446886 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:52:32.448232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a93b0b63-090e-44f1-a5ca-52c17cc6fbac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7c590>]}
[0m08:52:32.449284 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:32.449453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:52:32.449588 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:32.452315 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:52:32.452613 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:32.452844 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:52:32.452981 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:32.453117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:52:32.453292 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:32.454174 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:52:32.454392 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:32.454599 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:52:32.454730 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:32.454858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:52:32.455012 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:32.456286 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:52:32.456556 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:32.456821 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:52:32.456974 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:32.457136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:52:32.457271 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:32.458119 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:52:32.458337 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:32.458549 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:52:32.458694 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:52:32.458890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_second_dbt_model, now test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710)
[0m08:52:32.459033 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:52:32.463073 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:52:32.463313 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:52:32.463532 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:52:32.463668 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:52:32.463808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710, now test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321)
[0m08:52:32.463929 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:52:32.465866 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321"
[0m08:52:32.466077 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:52:32.466281 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:52:32.466410 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:52:32.466541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321, now test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778)
[0m08:52:32.466661 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:52:32.467831 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778"
[0m08:52:32.468037 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:52:32.468242 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:52:32.468368 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:52:32.468497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778, now test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:52:32.468616 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:52:32.469757 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:52:32.469957 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:52:32.470157 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:52:32.470550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:32.470732 [debug] [MainThread]: Connection 'test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:52:32.471245 [debug] [MainThread]: Command end result
[0m08:52:32.495284 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:52:32.496008 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:52:32.498340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:52:32.499612 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m08:52:32.499727 [info ] [MainThread]: Building catalog
[0m08:52:32.502733 [debug] [ThreadPool]: Acquiring new duckdb connection 'dbt.information_schema'
[0m08:52:32.505322 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m08:52:32.505451 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m08:52:32.505550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:32.509806 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:52:32.509928 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m08:52:32.510053 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dbt'
    )
    select
        'dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m08:52:32.519757 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:52:32.527559 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m08:52:32.527952 [debug] [ThreadPool]: Failed to rollback 'dbt.information_schema'
[0m08:52:32.528063 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m08:52:32.538182 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m08:52:32.545679 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:52:32.546284 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:52:32.546404 [info ] [MainThread]: Catalog written to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m08:52:32.547130 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.37515375, "process_in_blocks": "0", "process_kernel_time": 0.111941, "process_mem_max_rss": "142082048", "process_out_blocks": "0", "process_user_time": 0.758138}
[0m08:52:32.547392 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:52:32.547350 after 0.38 seconds
[0m08:52:32.547532 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:52:32.547642 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m08:52:32.547786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d1520>]}
[0m08:52:32.547939 [debug] [MainThread]: Flushing usage events
[0m08:52:32.692604 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:33.299755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10807c440>]}


============================== 08:52:33.301658 | 35b0905e-66df-4c8c-8768-842afcce1ec1 ==============================
[0m08:52:33.301658 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:52:33.301918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:52:33.383909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35b0905e-66df-4c8c-8768-842afcce1ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108018380>]}
[0m08:52:33.403529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35b0905e-66df-4c8c-8768-842afcce1ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d4110>]}
[0m08:54:13.336493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10076f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104360ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043606e0>]}


============================== 08:54:13.339060 | cf113da2-6b5e-4d78-a008-bd88e9618e66 ==============================
[0m08:54:13.339060 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:54:13.339325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:54:13.438846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043fa870>]}
[0m08:54:13.457111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104125fa0>]}
[0m08:54:13.458886 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:54:13.501120 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:54:13.544698 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:54:13.544883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:54:13.558181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451e690>]}
[0m08:54:13.582418 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:54:13.583131 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:54:13.594191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048520c0>]}
[0m08:54:13.594400 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:54:13.594535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10474cce0>]}
[0m08:54:13.595291 [info ] [MainThread]: 
[0m08:54:13.595448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:54:13.595562 [info ] [MainThread]: 
[0m08:54:13.595772 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:54:13.597565 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m08:54:13.621952 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m08:54:13.622173 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m08:54:13.622316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:54:13.668084 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m08:54:13.668720 [debug] [ThreadPool]: On list_dbt: Close
[0m08:54:13.670548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m08:54:13.670775 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m08:54:13.673666 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:54:13.673827 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m08:54:13.673950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:54:13.678292 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:54:13.678853 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:54:13.678967 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m08:54:13.679124 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:54:13.679231 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:54:13.679341 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m08:54:13.679565 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:54:13.679876 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:54:13.679994 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:54:13.680088 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:54:13.680228 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:54:13.680343 [debug] [ThreadPool]: On create_dbt_main: Close
[0m08:54:13.681413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m08:54:13.683556 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:54:13.683683 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:54:13.683785 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:54:13.687759 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:54:13.687887 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:54:13.688001 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:54:13.696855 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m08:54:13.697418 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:54:13.698152 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:54:13.698273 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:54:13.699576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104420560>]}
[0m08:54:13.699784 [debug] [MainThread]: Using duckdb connection "master"
[0m08:54:13.699902 [debug] [MainThread]: On master: BEGIN
[0m08:54:13.700000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:54:13.703903 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:54:13.704036 [debug] [MainThread]: On master: COMMIT
[0m08:54:13.704153 [debug] [MainThread]: Using duckdb connection "master"
[0m08:54:13.704259 [debug] [MainThread]: On master: COMMIT
[0m08:54:13.704458 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:54:13.704645 [debug] [MainThread]: On master: Close
[0m08:54:13.705972 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:54:13.706232 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:54:13.706425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:54:13.706576 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:54:13.709407 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:54:13.709727 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:54:13.722215 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:54:13.722649 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:54:13.722796 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m08:54:13.722923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:13.727168 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:54:13.727327 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:54:13.727465 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:54:13.728555 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:13.730910 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:54:13.731055 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:54:13.731317 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:13.732292 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:54:13.732420 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:54:13.732620 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:13.737915 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:54:13.738051 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:54:13.738190 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:54:13.739053 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:13.740716 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:54:13.740848 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:54:13.741112 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:13.741959 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m08:54:13.746928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba1940>]}
[0m08:54:13.747190 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:54:13.747412 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:54:13.747579 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:54:13.747829 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m08:54:13.748016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:54:13.748164 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:54:13.749118 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:54:13.749376 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:54:13.750399 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:54:13.750645 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:54:13.750766 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m08:54:13.750880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:13.754992 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:54:13.755156 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:54:13.755299 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m08:54:14.927097 [debug] [Thread-1 (]: SQL status: OK in 1.172 seconds
[0m08:54:14.928397 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:54:14.928550 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m08:54:14.928864 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:14.929820 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:54:14.929950 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m08:54:14.930183 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:14.930773 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:54:14.930893 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:54:14.931003 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:54:14.952667 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m08:54:14.953635 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:54:14.953779 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m08:54:14.954447 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:14.954977 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m08:54:14.963829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb5af0>]}
[0m08:54:14.964116 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.22s]
[0m08:54:14.964322 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:54:14.964484 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:54:14.964689 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m08:54:14.964859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:54:14.965001 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:54:14.965691 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:54:14.965961 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:54:14.973324 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:54:14.973611 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:54:14.973741 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m08:54:14.973875 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:14.978967 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:54:14.979225 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:54:14.979391 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m08:54:14.980297 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:54:14.981690 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:54:14.981866 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m08:54:14.982188 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:14.983301 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:54:14.983450 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m08:54:14.983684 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:14.984278 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:54:14.984420 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:54:14.984537 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:54:14.984936 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:14.985788 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:54:14.985947 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m08:54:14.986235 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:14.986712 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m08:54:14.990961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d06960>]}
[0m08:54:14.991341 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.03s]
[0m08:54:14.991597 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:54:14.991767 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:54:14.992015 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:54:14.992237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:54:14.992397 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:54:14.993540 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:54:14.993945 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:54:14.995607 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:54:14.996046 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:54:14.996196 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m08:54:14.996324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:54:15.000751 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:54:15.000949 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:54:15.001096 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:54:15.001386 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:15.002562 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:54:15.002712 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:54:15.003023 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:15.003996 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:54:15.004124 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:54:15.004330 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:15.004940 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:54:15.005090 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:54:15.005224 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:54:15.005691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:15.006593 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:54:15.006842 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:54:15.007272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:54:15.007800 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m08:54:15.011791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf113da2-6b5e-4d78-a008-bd88e9618e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb1040>]}
[0m08:54:15.012040 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m08:54:15.012248 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:54:15.012757 [debug] [MainThread]: Using duckdb connection "master"
[0m08:54:15.012884 [debug] [MainThread]: On master: BEGIN
[0m08:54:15.012994 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:54:15.017042 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:54:15.017188 [debug] [MainThread]: On master: COMMIT
[0m08:54:15.017309 [debug] [MainThread]: Using duckdb connection "master"
[0m08:54:15.017409 [debug] [MainThread]: On master: COMMIT
[0m08:54:15.017571 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:54:15.017705 [debug] [MainThread]: On master: Close
[0m08:54:15.018509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:54:15.018611 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m08:54:15.018749 [info ] [MainThread]: 
[0m08:54:15.018874 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m08:54:15.019279 [debug] [MainThread]: Command end result
[0m08:54:15.026993 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:54:15.027717 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:54:15.029889 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:54:15.030027 [info ] [MainThread]: 
[0m08:54:15.030167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:54:15.030287 [info ] [MainThread]: 
[0m08:54:15.030413 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:54:15.031155 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7337118, "process_in_blocks": "0", "process_kernel_time": 0.333067, "process_mem_max_rss": "522764288", "process_out_blocks": "0", "process_user_time": 2.383753}
[0m08:54:15.031377 [debug] [MainThread]: Command `dbt run` succeeded at 08:54:15.031339 after 1.73 seconds
[0m08:54:15.031548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103659ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a8aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d1bb0>]}
[0m08:54:15.031701 [debug] [MainThread]: Flushing usage events
[0m08:54:15.187252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:04.184131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105362f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c00e0>]}


============================== 08:55:04.185930 | 1ceb368d-f087-4a09-8fa6-546a2d52680a ==============================
[0m08:55:04.185930 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:55:04.186205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:04.190983 [info ] [MainThread]: dbt version: 1.9.2
[0m08:55:04.191126 [info ] [MainThread]: python version: 3.12.3
[0m08:55:04.191243 [info ] [MainThread]: python path: /Library/Frameworks/Python.framework/Versions/3.12/bin/python3
[0m08:55:04.191365 [info ] [MainThread]: os info: macOS-15.3.1-arm64-arm-64bit
[0m08:55:04.232927 [info ] [MainThread]: Using profiles dir at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi
[0m08:55:04.233159 [info ] [MainThread]: Using profiles.yml file at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/profiles.yml
[0m08:55:04.233294 [info ] [MainThread]: Using dbt_project.yml file at /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/dbt_project.yml
[0m08:55:04.234646 [info ] [MainThread]: adapter type: duckdb
[0m08:55:04.234770 [info ] [MainThread]: adapter version: 1.9.1
[0m08:55:04.266355 [info ] [MainThread]: Configuration:
[0m08:55:04.266625 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:55:04.266752 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:55:04.266879 [info ] [MainThread]: Required dependencies:
[0m08:55:04.267053 [debug] [MainThread]: Executing "git --help"
[0m08:55:04.282797 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:55:04.283210 [debug] [MainThread]: STDERR: "b''"
[0m08:55:04.283348 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:55:04.283472 [info ] [MainThread]: Connection:
[0m08:55:04.283620 [info ] [MainThread]:   database: dbt
[0m08:55:04.283733 [info ] [MainThread]:   schema: main
[0m08:55:04.283836 [info ] [MainThread]:   path: dbt.duckdb
[0m08:55:04.283944 [info ] [MainThread]:   config_options: None
[0m08:55:04.284045 [info ] [MainThread]:   extensions: None
[0m08:55:04.284150 [info ] [MainThread]:   settings: {}
[0m08:55:04.284252 [info ] [MainThread]:   external_root: .
[0m08:55:04.284352 [info ] [MainThread]:   use_credential_provider: None
[0m08:55:04.284457 [info ] [MainThread]:   attach: None
[0m08:55:04.284555 [info ] [MainThread]:   filesystems: None
[0m08:55:04.284656 [info ] [MainThread]:   remote: None
[0m08:55:04.284759 [info ] [MainThread]:   plugins: None
[0m08:55:04.284860 [info ] [MainThread]:   disable_transactions: False
[0m08:55:04.285150 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:55:04.321725 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m08:55:04.339580 [debug] [MainThread]: Using duckdb connection "debug"
[0m08:55:04.339779 [debug] [MainThread]: On debug: select 1 as id
[0m08:55:04.339897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:55:04.345212 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m08:55:04.345588 [debug] [MainThread]: On debug: Close
[0m08:55:04.346442 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:55:04.346577 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:55:04.347314 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.20260988, "process_in_blocks": "0", "process_kernel_time": 0.105467, "process_mem_max_rss": "120225792", "process_out_blocks": "0", "process_user_time": 0.572065}
[0m08:55:04.347576 [debug] [MainThread]: Command `dbt debug` succeeded at 08:55:04.347521 after 0.20 seconds
[0m08:55:04.347714 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:55:04.347858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105597890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105363410>]}
[0m08:55:04.348035 [debug] [MainThread]: Flushing usage events
[0m08:55:04.493754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:17.662676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102095ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5c530>]}


============================== 08:55:17.664507 | 377f003c-b244-4c41-837c-e07bb320e53c ==============================
[0m08:55:17.664507 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:55:17.664752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:17.745802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1d580>]}
[0m08:55:17.764020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a89130>]}
[0m08:55:17.765359 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:55:17.803356 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:55:17.841792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:55:17.841995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:55:17.855110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5e9f0>]}
[0m08:55:17.878844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:55:17.879602 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:55:17.885405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053440b0>]}
[0m08:55:17.885609 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:55:17.885759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053578c0>]}
[0m08:55:17.886511 [info ] [MainThread]: 
[0m08:55:17.886666 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:55:17.886782 [info ] [MainThread]: 
[0m08:55:17.886986 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:55:17.888790 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m08:55:17.907260 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m08:55:17.907469 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m08:55:17.907599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:17.913193 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m08:55:17.913768 [debug] [ThreadPool]: On list_dbt: Close
[0m08:55:17.914726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m08:55:17.914946 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m08:55:17.917505 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:55:17.917641 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m08:55:17.917763 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:17.922040 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:55:17.922501 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:55:17.922611 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m08:55:17.922776 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:17.922870 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:55:17.922968 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m08:55:17.923141 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:17.923419 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:55:17.923525 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:55:17.923620 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:55:17.923763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:17.923865 [debug] [ThreadPool]: On create_dbt_main: Close
[0m08:55:17.925080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m08:55:17.927267 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:55:17.927418 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:55:17.927526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:17.931791 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:55:17.931926 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:55:17.932050 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:55:17.939112 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:55:17.939589 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:55:17.940057 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:55:17.940162 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:55:17.941452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa4290>]}
[0m08:55:17.941659 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:17.941771 [debug] [MainThread]: On master: BEGIN
[0m08:55:17.941868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:55:17.945825 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:55:17.945957 [debug] [MainThread]: On master: COMMIT
[0m08:55:17.946064 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:17.946161 [debug] [MainThread]: On master: COMMIT
[0m08:55:17.946312 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:55:17.946414 [debug] [MainThread]: On master: Close
[0m08:55:17.947586 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:55:17.947807 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:55:17.947986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:55:17.948134 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:55:17.950936 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:17.951283 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:55:17.963596 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:17.963994 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:17.964128 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m08:55:17.964242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:17.968472 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:55:17.968623 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:17.968761 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:55:17.969165 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:17.971416 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:17.971551 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:55:17.971782 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:17.972715 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:17.972844 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:55:17.973049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:17.978555 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:55:17.978728 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:17.978845 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:55:17.979329 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:17.980944 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:17.981093 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:55:17.981388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:17.982303 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m08:55:17.987147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105754080>]}
[0m08:55:17.987395 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:55:17.987619 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:55:17.987777 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:55:17.988059 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m08:55:17.988256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:55:17.988409 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:55:17.989389 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:17.989657 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:55:17.990693 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:17.990946 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:17.991070 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m08:55:17.991198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:17.995534 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:55:17.995728 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:17.995862 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m08:55:19.141378 [debug] [Thread-1 (]: SQL status: OK in 1.144 seconds
[0m08:55:19.142688 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:19.142838 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m08:55:19.143155 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.144394 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:19.144562 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m08:55:19.144848 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.145461 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:55:19.145590 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:19.145707 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:55:19.167484 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m08:55:19.168490 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:19.168629 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m08:55:19.169353 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m08:55:19.169966 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m08:55:19.178201 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574f9b0>]}
[0m08:55:19.178604 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.19s]
[0m08:55:19.178850 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:55:19.179021 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:55:19.179228 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m08:55:19.179405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:55:19.179548 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:55:19.180278 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:19.180562 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:55:19.188235 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:19.188586 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:19.188731 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m08:55:19.188867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:19.193391 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:55:19.193596 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:19.193871 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m08:55:19.194413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.195690 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:19.195868 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m08:55:19.196196 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.197305 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:19.197445 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m08:55:19.197672 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.198234 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:55:19.198362 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:19.198477 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:55:19.198857 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.199625 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:19.199752 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m08:55:19.199996 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.200448 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m08:55:19.205407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a66f60>]}
[0m08:55:19.205694 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.03s]
[0m08:55:19.205910 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:55:19.206070 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:55:19.206315 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:55:19.206537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:55:19.206695 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:55:19.207803 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:19.208081 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:55:19.209193 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:19.209432 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:19.209556 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m08:55:19.209673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:19.214130 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:55:19.214337 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:19.214479 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:55:19.214750 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.215883 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:19.216011 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:55:19.216279 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.217165 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:19.217287 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:55:19.217479 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.218085 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:55:19.218225 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:19.218354 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:55:19.218760 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.219524 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:19.219713 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:55:19.219990 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:19.220468 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m08:55:19.224943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '377f003c-b244-4c41-837c-e07bb320e53c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10574f380>]}
[0m08:55:19.225213 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m08:55:19.225423 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:55:19.225967 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:19.226117 [debug] [MainThread]: On master: BEGIN
[0m08:55:19.226238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:55:19.230602 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:55:19.230785 [debug] [MainThread]: On master: COMMIT
[0m08:55:19.230909 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:19.231013 [debug] [MainThread]: On master: COMMIT
[0m08:55:19.231185 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:55:19.231330 [debug] [MainThread]: On master: Close
[0m08:55:19.232102 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:55:19.232205 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m08:55:19.232348 [info ] [MainThread]: 
[0m08:55:19.232473 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m08:55:19.232871 [debug] [MainThread]: Command end result
[0m08:55:19.240466 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:55:19.241191 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:55:19.243358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:55:19.243503 [info ] [MainThread]: 
[0m08:55:19.243657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:55:19.243774 [info ] [MainThread]: 
[0m08:55:19.243902 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:55:19.244811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6195183, "process_in_blocks": "0", "process_kernel_time": 0.264871, "process_mem_max_rss": "511492096", "process_out_blocks": "0", "process_user_time": 2.342387}
[0m08:55:19.245080 [debug] [MainThread]: Command `dbt run` succeeded at 08:55:19.245038 after 1.62 seconds
[0m08:55:19.245276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104349130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a92f00>]}
[0m08:55:19.245450 [debug] [MainThread]: Flushing usage events
[0m08:55:19.391405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:29.630712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d38890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d384a0>]}


============================== 08:55:29.632492 | 5df8ae96-4e58-4af3-9180-e2b5d99980f8 ==============================
[0m08:55:29.632492 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:55:29.632741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:55:29.713204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702c350>]}
[0m08:55:29.731378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063991c0>]}
[0m08:55:29.732682 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:55:29.770049 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:55:29.806984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:55:29.807173 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:55:29.820380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602f380>]}
[0m08:55:29.844262 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:55:29.844992 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:55:29.850667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e20f0>]}
[0m08:55:29.850879 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:55:29.851013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b6edb0>]}
[0m08:55:29.851785 [info ] [MainThread]: 
[0m08:55:29.851935 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:55:29.852051 [info ] [MainThread]: 
[0m08:55:29.852256 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:55:29.854131 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m08:55:29.872694 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m08:55:29.872911 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m08:55:29.873032 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:29.878667 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m08:55:29.879237 [debug] [ThreadPool]: On list_dbt: Close
[0m08:55:29.880204 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m08:55:29.880407 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m08:55:29.882924 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:55:29.883057 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m08:55:29.883164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:29.887248 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:55:29.887729 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:55:29.887839 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m08:55:29.888000 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:29.888094 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:55:29.888194 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m08:55:29.888371 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:29.888651 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:55:29.888759 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:55:29.888854 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:55:29.889003 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:55:29.889104 [debug] [ThreadPool]: On create_dbt_main: Close
[0m08:55:29.890165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m08:55:29.892132 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:55:29.892291 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:55:29.892443 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:55:29.896653 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:55:29.896799 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:55:29.896918 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:55:29.904102 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:55:29.904597 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:55:29.905072 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:55:29.905181 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:55:29.906385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107008440>]}
[0m08:55:29.906576 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:29.906681 [debug] [MainThread]: On master: BEGIN
[0m08:55:29.906776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:55:29.910835 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:55:29.910975 [debug] [MainThread]: On master: COMMIT
[0m08:55:29.911083 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:29.911179 [debug] [MainThread]: On master: COMMIT
[0m08:55:29.911326 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:55:29.911428 [debug] [MainThread]: On master: Close
[0m08:55:29.912687 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:55:29.912909 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:55:29.913083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:55:29.913229 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:55:29.915987 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:29.916302 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:55:29.928642 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:29.929019 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:29.929152 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m08:55:29.929269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:29.933341 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:55:29.933504 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:29.933651 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:55:29.934031 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:29.936297 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:29.936436 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:55:29.936664 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:29.937627 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:29.937756 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:55:29.937956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:29.943267 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:55:29.943418 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:29.943538 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:55:29.943991 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:29.945712 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:55:29.945846 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:55:29.946139 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:29.947020 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m08:55:29.951728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107700d40>]}
[0m08:55:29.951993 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:55:29.952205 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:55:29.952365 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:55:29.952656 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m08:55:29.952866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:55:29.953015 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:55:29.954033 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:29.954288 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:55:29.955321 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:29.955564 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:29.955688 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m08:55:29.955800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:29.959975 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:55:29.960175 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:29.960349 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m08:55:31.031426 [debug] [Thread-1 (]: SQL status: OK in 1.070 seconds
[0m08:55:31.032701 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:31.032851 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m08:55:31.033178 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.034097 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:31.034226 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m08:55:31.034453 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.035019 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:55:31.035149 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:31.035260 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:55:31.041414 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m08:55:31.042130 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:55:31.042254 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m08:55:31.042798 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.043228 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m08:55:31.053692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742deb0>]}
[0m08:55:31.054042 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.10s]
[0m08:55:31.054280 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:55:31.054454 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:55:31.054669 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m08:55:31.054849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:55:31.054994 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:55:31.055703 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:31.055982 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:55:31.063300 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:31.063603 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:31.063736 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m08:55:31.063859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:31.068090 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:55:31.068261 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:31.068411 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m08:55:31.068812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.069981 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:31.070120 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m08:55:31.070353 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.071323 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:31.071453 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m08:55:31.071655 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.072182 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:55:31.072314 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:31.072428 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:55:31.072787 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.073537 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:55:31.073662 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m08:55:31.073898 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.074330 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m08:55:31.078383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a62840>]}
[0m08:55:31.078722 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m08:55:31.078973 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:55:31.079146 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:55:31.079359 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:55:31.079545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:55:31.079693 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:55:31.080812 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:31.081096 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:55:31.082220 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:31.082457 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:31.082581 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m08:55:31.082697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:55:31.086864 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:55:31.087016 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:31.087155 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:55:31.087413 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.088413 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:31.088552 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:55:31.088867 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.089890 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:31.090035 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:55:31.090264 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.090881 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:55:31.091010 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:31.091126 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:55:31.091459 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.092161 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:55:31.092334 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:55:31.092652 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:55:31.093272 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m08:55:31.097688 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5df8ae96-4e58-4af3-9180-e2b5d99980f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770d4f0>]}
[0m08:55:31.097990 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m08:55:31.098202 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:55:31.098723 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:31.098867 [debug] [MainThread]: On master: BEGIN
[0m08:55:31.098984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:55:31.103111 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:55:31.103272 [debug] [MainThread]: On master: COMMIT
[0m08:55:31.103398 [debug] [MainThread]: Using duckdb connection "master"
[0m08:55:31.103497 [debug] [MainThread]: On master: COMMIT
[0m08:55:31.103648 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:55:31.103766 [debug] [MainThread]: On master: Close
[0m08:55:31.104554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:55:31.104665 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m08:55:31.104815 [info ] [MainThread]: 
[0m08:55:31.104962 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m08:55:31.105359 [debug] [MainThread]: Command end result
[0m08:55:31.113179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:55:31.113890 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:55:31.116036 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:55:31.116156 [info ] [MainThread]: 
[0m08:55:31.116290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:55:31.116405 [info ] [MainThread]: 
[0m08:55:31.116532 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:55:31.117251 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5245938, "process_in_blocks": "0", "process_kernel_time": 0.267608, "process_mem_max_rss": "505659392", "process_out_blocks": "0", "process_user_time": 3.151058}
[0m08:55:31.117461 [debug] [MainThread]: Command `dbt run` succeeded at 08:55:31.117425 after 1.52 seconds
[0m08:55:31.117622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a92f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a92e70>]}
[0m08:55:31.117758 [debug] [MainThread]: Flushing usage events
[0m08:55:31.266828 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:05.201456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c97b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cf4230>]}


============================== 08:59:05.203313 | 5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b ==============================
[0m08:59:05.203313 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:59:05.203559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:59:05.286079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e13d0>]}
[0m08:59:05.304768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0f350>]}
[0m08:59:05.306156 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:59:05.344598 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:59:05.382874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:59:05.383083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:59:05.396332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d52180>]}
[0m08:59:05.420268 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:59:05.421039 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:59:05.426834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0dcec0>]}
[0m08:59:05.427040 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:59:05.427191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108db2a50>]}
[0m08:59:05.427989 [info ] [MainThread]: 
[0m08:59:05.428154 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:05.428269 [info ] [MainThread]: 
[0m08:59:05.428493 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:59:05.430440 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m08:59:05.452595 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m08:59:05.452823 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m08:59:05.452950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:05.458267 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m08:59:05.458782 [debug] [ThreadPool]: On list_dbt: Close
[0m08:59:05.459703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m08:59:05.459913 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m08:59:05.462902 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:59:05.463110 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m08:59:05.463220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:05.467603 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:59:05.468142 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:59:05.468268 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m08:59:05.468436 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:05.468532 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:59:05.468630 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m08:59:05.468802 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:05.469081 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:59:05.469187 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m08:59:05.469281 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m08:59:05.469423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m08:59:05.469527 [debug] [ThreadPool]: On create_dbt_main: Close
[0m08:59:05.470604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m08:59:05.472663 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:59:05.472773 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:59:05.472868 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:59:05.476736 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:59:05.476887 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:59:05.477015 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:59:05.484234 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:59:05.484826 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:59:05.485329 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:59:05.485449 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:59:05.486656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41bfe0>]}
[0m08:59:05.486886 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:05.487011 [debug] [MainThread]: On master: BEGIN
[0m08:59:05.487114 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:59:05.491180 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m08:59:05.491303 [debug] [MainThread]: On master: COMMIT
[0m08:59:05.491409 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:05.491508 [debug] [MainThread]: On master: COMMIT
[0m08:59:05.491657 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:59:05.491759 [debug] [MainThread]: On master: Close
[0m08:59:05.492921 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:59:05.493126 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m08:59:05.493293 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:59:05.493434 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:59:05.496391 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:05.496773 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:59:05.509141 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:05.509552 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:05.509691 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m08:59:05.509809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:05.514564 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m08:59:05.514838 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:05.514980 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m08:59:05.515427 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:05.517870 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:05.518017 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m08:59:05.518260 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:05.519238 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:05.519366 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m08:59:05.519570 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:05.524919 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:59:05.525063 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:05.525178 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m08:59:05.525612 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:05.527197 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:05.527344 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m08:59:05.527624 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:05.528806 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m08:59:05.533741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0dce00>]}
[0m08:59:05.534036 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m08:59:05.534251 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:59:05.534414 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:59:05.534706 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m08:59:05.534922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:59:05.535073 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:59:05.536126 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:05.536402 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:59:05.537472 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:05.537719 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:05.537843 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m08:59:05.537959 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:05.541998 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:59:05.542149 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:05.542279 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m08:59:06.577004 [debug] [Thread-1 (]: SQL status: OK in 1.035 seconds
[0m08:59:06.578324 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:06.578503 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m08:59:06.578826 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.579776 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:06.579917 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m08:59:06.580145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.580722 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:59:06.580845 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:06.580958 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m08:59:06.602253 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m08:59:06.603194 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:06.603333 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m08:59:06.603963 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.604470 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m08:59:06.612998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a42c7d0>]}
[0m08:59:06.613344 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.08s]
[0m08:59:06.613573 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:59:06.613746 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:59:06.613967 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m08:59:06.614151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:59:06.614297 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:59:06.615017 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:06.615323 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:59:06.622974 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:06.623269 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:06.623399 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m08:59:06.623518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:06.627720 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:59:06.627896 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:06.628080 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m08:59:06.628499 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.629882 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:06.630108 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m08:59:06.630448 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.631583 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:06.631748 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m08:59:06.632004 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.632589 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:59:06.632732 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:06.632864 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m08:59:06.633294 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.634175 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:06.634319 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m08:59:06.634605 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.635069 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m08:59:06.639808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab630b0>]}
[0m08:59:06.640061 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.03s]
[0m08:59:06.640266 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:59:06.640423 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:59:06.640639 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m08:59:06.640823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:59:06.640969 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:59:06.642022 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:06.642295 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:59:06.643380 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:06.643610 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:06.643732 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m08:59:06.643847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:59:06.648154 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m08:59:06.648370 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:06.648508 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m08:59:06.648777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.649889 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:06.650023 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m08:59:06.650298 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.651204 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:06.651331 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m08:59:06.651529 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.652132 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:59:06.652255 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:06.652366 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m08:59:06.652734 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.653424 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:06.653589 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m08:59:06.653836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m08:59:06.654302 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m08:59:06.658495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c82b0e0-e477-42d8-9a7a-ff2f9b7f119b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7191c0>]}
[0m08:59:06.658771 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m08:59:06.658973 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:59:06.659477 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:06.659613 [debug] [MainThread]: On master: BEGIN
[0m08:59:06.659727 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:59:06.665105 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m08:59:06.665392 [debug] [MainThread]: On master: COMMIT
[0m08:59:06.665544 [debug] [MainThread]: Using duckdb connection "master"
[0m08:59:06.665668 [debug] [MainThread]: On master: COMMIT
[0m08:59:06.665857 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m08:59:06.665980 [debug] [MainThread]: On master: Close
[0m08:59:06.666911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:06.667023 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m08:59:06.667170 [info ] [MainThread]: 
[0m08:59:06.667302 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m08:59:06.667700 [debug] [MainThread]: Command end result
[0m08:59:06.675367 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:59:06.676020 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:59:06.678133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:59:06.678268 [info ] [MainThread]: 
[0m08:59:06.678414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:59:06.678528 [info ] [MainThread]: 
[0m08:59:06.678663 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m08:59:06.679890 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5170827, "process_in_blocks": "0", "process_kernel_time": 0.285648, "process_mem_max_rss": "523468800", "process_out_blocks": "0", "process_user_time": 3.133141}
[0m08:59:06.680194 [debug] [MainThread]: Command `dbt run` succeeded at 08:59:06.680157 after 1.52 seconds
[0m08:59:06.680381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10898a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815c500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab92db0>]}
[0m08:59:06.680544 [debug] [MainThread]: Flushing usage events
[0m08:59:06.846113 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:07.471468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec0560>]}


============================== 08:59:07.473317 | d2941c95-fa85-49a2-9b5f-59a72d9f111d ==============================
[0m08:59:07.473317 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:59:07.473564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:59:07.554449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2941c95-fa85-49a2-9b5f-59a72d9f111d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec2600>]}
[0m08:59:07.573088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2941c95-fa85-49a2-9b5f-59a72d9f111d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106908080>]}
[0m08:59:07.574506 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m08:59:07.613279 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m08:59:07.651027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:59:07.651222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:59:07.664825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2941c95-fa85-49a2-9b5f-59a72d9f111d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ade8a0>]}
[0m08:59:07.671515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2941c95-fa85-49a2-9b5f-59a72d9f111d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbf500>]}
[0m08:59:07.671709 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m08:59:07.671850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2941c95-fa85-49a2-9b5f-59a72d9f111d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b447d0>]}
[0m08:59:07.672724 [info ] [MainThread]: 
[0m08:59:07.672871 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:07.673004 [info ] [MainThread]: 
[0m08:59:07.673226 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m08:59:07.675008 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt_main'
[0m08:59:07.694360 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:59:07.694585 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m08:59:07.694703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:07.700663 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m08:59:07.700879 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m08:59:07.701003 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m08:59:07.708288 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m08:59:07.708908 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m08:59:07.709389 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m08:59:07.709506 [debug] [ThreadPool]: On list_dbt_main: Close
[0m08:59:07.710849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2941c95-fa85-49a2-9b5f-59a72d9f111d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031af2c0>]}
[0m08:59:07.711877 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:59:07.712034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m08:59:07.712162 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:59:07.715519 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m08:59:07.716179 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:59:07.716532 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m08:59:07.716690 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:59:07.716898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m08:59:07.717081 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:59:07.718008 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m08:59:07.718252 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:59:07.718495 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m08:59:07.718649 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:59:07.718807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m08:59:07.718932 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:59:07.720117 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m08:59:07.720356 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:59:07.720598 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m08:59:07.720745 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:59:07.720901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m08:59:07.721034 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:59:07.721829 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m08:59:07.722029 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:59:07.722242 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m08:59:07.722381 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:59:07.722563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_second_dbt_model, now test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710)
[0m08:59:07.722696 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:59:07.726827 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:59:07.727061 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:59:07.727301 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:59:07.727442 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:59:07.727591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710, now test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321)
[0m08:59:07.727713 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:59:07.729922 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321"
[0m08:59:07.730243 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:59:07.730492 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m08:59:07.730647 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:59:07.730796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321, now test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778)
[0m08:59:07.730922 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:59:07.732251 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778"
[0m08:59:07.732477 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:59:07.732690 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m08:59:07.732829 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:59:07.732968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778, now test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:59:07.733089 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:59:07.734301 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:59:07.734510 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:59:07.734712 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m08:59:07.735097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:07.735230 [debug] [MainThread]: Connection 'test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:59:07.735739 [debug] [MainThread]: Command end result
[0m08:59:07.759618 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:59:07.760328 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:59:07.762531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m08:59:07.763856 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m08:59:07.764000 [info ] [MainThread]: Building catalog
[0m08:59:07.766991 [debug] [ThreadPool]: Acquiring new duckdb connection 'dbt.information_schema'
[0m08:59:07.769530 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m08:59:07.769666 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m08:59:07.769765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:07.773903 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m08:59:07.774029 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m08:59:07.774164 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dbt'
    )
    select
        'dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m08:59:07.784087 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m08:59:07.791852 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m08:59:07.792232 [debug] [ThreadPool]: Failed to rollback 'dbt.information_schema'
[0m08:59:07.792349 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m08:59:07.803118 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m08:59:07.810181 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m08:59:07.810777 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m08:59:07.810899 [info ] [MainThread]: Catalog written to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m08:59:07.811650 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.38003066, "process_in_blocks": "0", "process_kernel_time": 0.105398, "process_mem_max_rss": "139755520", "process_out_blocks": "0", "process_user_time": 0.740938}
[0m08:59:07.811899 [debug] [MainThread]: Command `dbt docs generate` succeeded at 08:59:07.811857 after 0.38 seconds
[0m08:59:07.812042 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m08:59:07.812143 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m08:59:07.812269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106add3d0>]}
[0m08:59:07.812406 [debug] [MainThread]: Flushing usage events
[0m08:59:07.952806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:08.561114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10583bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581a3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065483e0>]}


============================== 08:59:08.562884 | 9d71e02b-fb93-4c74-a928-efbe60eb8156 ==============================
[0m08:59:08.562884 [info ] [MainThread]: Running with dbt=1.9.2
[0m08:59:08.563178 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:59:08.643683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d71e02b-fb93-4c74-a928-efbe60eb8156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628f20>]}
[0m08:59:08.661943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d71e02b-fb93-4c74-a928-efbe60eb8156', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106306420>]}
[0m11:40:00.419738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a57530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfcad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfc5c0>]}


============================== 11:40:00.422243 | 55cec998-8aa4-407e-98bd-4bf941afab20 ==============================
[0m11:40:00.422243 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:40:00.422495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:40:01.031999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c48c50>]}
[0m11:40:01.050716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106354890>]}
[0m11:40:01.052490 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:40:01.108020 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:40:01.153676 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:40:01.153981 [debug] [MainThread]: Partial parsing: updated file: nyc_yellow_taxi://models/taxi_rides/model_properties.yml
[0m11:40:01.254729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbf710>]}
[0m11:40:01.278488 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:40:01.279570 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:40:01.290689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a4da0>]}
[0m11:40:01.290936 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m11:40:01.291095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b77b00>]}
[0m11:40:01.291958 [info ] [MainThread]: 
[0m11:40:01.292146 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:40:01.292271 [info ] [MainThread]: 
[0m11:40:01.292481 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:40:01.294275 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m11:40:01.329058 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m11:40:01.329267 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m11:40:01.329392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:01.340784 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:40:01.341366 [debug] [ThreadPool]: On list_dbt: Close
[0m11:40:01.342425 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m11:40:01.342613 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m11:40:01.345152 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:40:01.345279 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m11:40:01.345384 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:01.349501 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:40:01.349977 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:40:01.350085 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m11:40:01.350236 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:40:01.350341 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:40:01.350450 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m11:40:01.350680 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:40:01.350992 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m11:40:01.351115 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:40:01.351218 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m11:40:01.351360 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:40:01.351473 [debug] [ThreadPool]: On create_dbt_main: Close
[0m11:40:01.352626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m11:40:01.355326 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:40:01.355451 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m11:40:01.355557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:01.359828 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:40:01.359982 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:40:01.360094 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m11:40:01.367381 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:40:01.367915 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m11:40:01.368787 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m11:40:01.368937 [debug] [ThreadPool]: On list_dbt_main: Close
[0m11:40:01.370228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb8620>]}
[0m11:40:01.370443 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:01.370570 [debug] [MainThread]: On master: BEGIN
[0m11:40:01.370669 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:01.374727 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m11:40:01.374873 [debug] [MainThread]: On master: COMMIT
[0m11:40:01.375007 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:01.375140 [debug] [MainThread]: On master: COMMIT
[0m11:40:01.375307 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:40:01.375421 [debug] [MainThread]: On master: Close
[0m11:40:01.376648 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m11:40:01.376840 [info ] [Thread-1 (]: 1 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:40:01.377001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m11:40:01.377135 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m11:40:01.379872 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:01.380191 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m11:40:01.391823 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:01.392353 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:01.392543 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: BEGIN
[0m11:40:01.392683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:01.397071 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:40:01.397240 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:01.397378 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */

  
    
    

    create  table
      "dbt"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:40:01.397997 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:01.400426 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:01.400568 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:40:01.400836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:01.401777 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:01.401903 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
alter table "dbt"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:40:01.402114 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:01.407413 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m11:40:01.407551 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:01.407665 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: COMMIT
[0m11:40:01.408170 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:01.410118 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:01.410292 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_first_dbt_model"} */
drop table if exists "dbt"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:40:01.410661 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:01.411651 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_first_dbt_model: Close
[0m11:40:01.416705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e55670>]}
[0m11:40:01.416981 [info ] [Thread-1 (]: 1 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m11:40:01.417200 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m11:40:01.417368 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:40:01.417589 [info ] [Thread-1 (]: 2 of 4 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m11:40:01.417826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m11:40:01.417991 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:40:01.419050 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:01.419337 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:40:01.420413 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:01.420672 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:01.420799 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m11:40:01.420915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:01.424927 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:40:01.425074 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:01.425216 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m11:40:02.695396 [debug] [Thread-1 (]: SQL status: OK in 1.270 seconds
[0m11:40:02.696700 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:02.696849 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m11:40:02.697158 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.698835 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:02.698976 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m11:40:02.699199 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.699804 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m11:40:02.699927 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:02.700039 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m11:40:02.722072 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m11:40:02.722957 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:02.723084 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m11:40:02.723668 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.724146 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m11:40:02.732145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080ef0e0>]}
[0m11:40:02.732480 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.31s]
[0m11:40:02.732709 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:40:02.732878 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:40:02.733083 [info ] [Thread-1 (]: 3 of 4 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m11:40:02.733260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m11:40:02.733403 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:40:02.734056 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:02.734335 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:40:02.740788 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:02.741229 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:02.741362 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m11:40:02.741485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:02.745641 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:40:02.745811 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:02.745962 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m11:40:02.746400 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.747645 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:02.747815 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m11:40:02.748093 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.749183 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:02.749329 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m11:40:02.749554 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.750099 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m11:40:02.750228 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:02.750342 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m11:40:02.750719 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.751484 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:02.751610 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m11:40:02.751850 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.752288 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m11:40:02.756263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080067b0>]}
[0m11:40:02.756560 [info ] [Thread-1 (]: 3 of 4 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m11:40:02.756790 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:40:02.756951 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m11:40:02.757153 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:40:02.757326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m11:40:02.757470 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m11:40:02.758517 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:02.758816 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m11:40:02.760016 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:02.760348 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:02.760484 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: BEGIN
[0m11:40:02.760611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:40:02.764838 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:40:02.765000 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:02.765141 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */

  
  create view "dbt"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dbt"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:40:02.765403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.766478 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:02.766612 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:40:02.766829 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.767801 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:02.767925 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
alter view "dbt"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:40:02.768119 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.768659 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m11:40:02.768779 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:02.768890 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: COMMIT
[0m11:40:02.769223 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.769957 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:02.770080 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.my_second_dbt_model"} */
drop view if exists "dbt"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:40:02.770332 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:40:02.770797 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.my_second_dbt_model: Close
[0m11:40:02.774958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55cec998-8aa4-407e-98bd-4bf941afab20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108007b30>]}
[0m11:40:02.775220 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.02s]
[0m11:40:02.775434 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m11:40:02.776360 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:02.776586 [debug] [MainThread]: On master: BEGIN
[0m11:40:02.776726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:40:02.781595 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m11:40:02.781772 [debug] [MainThread]: On master: COMMIT
[0m11:40:02.781901 [debug] [MainThread]: Using duckdb connection "master"
[0m11:40:02.782006 [debug] [MainThread]: On master: COMMIT
[0m11:40:02.782156 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:40:02.782273 [debug] [MainThread]: On master: Close
[0m11:40:02.783130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:02.783248 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.my_second_dbt_model' was properly closed.
[0m11:40:02.783393 [info ] [MainThread]: 
[0m11:40:02.783518 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m11:40:02.783917 [debug] [MainThread]: Command end result
[0m11:40:02.791722 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:40:02.792360 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:40:02.795206 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m11:40:02.795376 [info ] [MainThread]: 
[0m11:40:02.795525 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:40:02.795647 [info ] [MainThread]: 
[0m11:40:02.795772 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:40:02.797438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.421506, "process_in_blocks": "0", "process_kernel_time": 0.407402, "process_mem_max_rss": "490143744", "process_out_blocks": "0", "process_user_time": 2.380358}
[0m11:40:02.797655 [debug] [MainThread]: Command `dbt run` succeeded at 11:40:02.797620 after 2.42 seconds
[0m11:40:02.797811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfc5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c321e0>]}
[0m11:40:02.797952 [debug] [MainThread]: Flushing usage events
[0m11:40:02.945955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:03.573886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e25a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c0cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c07d0>]}


============================== 11:40:03.575666 | 7ea51fc6-4476-4d98-b086-42d5570c5c12 ==============================
[0m11:40:03.575666 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:40:03.575918 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:40:03.656384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ea51fc6-4476-4d98-b086-42d5570c5c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f1c40>]}
[0m11:40:03.674672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ea51fc6-4476-4d98-b086-42d5570c5c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bbdd0>]}
[0m11:40:03.676011 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:40:03.714404 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:40:03.751301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:03.751506 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:03.765052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ea51fc6-4476-4d98-b086-42d5570c5c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692b8f0>]}
[0m11:40:03.770939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ea51fc6-4476-4d98-b086-42d5570c5c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac7650>]}
[0m11:40:03.771150 [info ] [MainThread]: Found 4 models, 4 data tests, 426 macros
[0m11:40:03.771301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea51fc6-4476-4d98-b086-42d5570c5c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f1d60>]}
[0m11:40:03.772191 [info ] [MainThread]: 
[0m11:40:03.772355 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:40:03.772477 [info ] [MainThread]: 
[0m11:40:03.772682 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:40:03.774501 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt_main'
[0m11:40:03.793911 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:40:03.794151 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m11:40:03.794295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:03.799423 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:40:03.799603 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:40:03.799729 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m11:40:03.806942 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:40:03.807585 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m11:40:03.808091 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m11:40:03.808217 [debug] [ThreadPool]: On list_dbt_main: Close
[0m11:40:03.809424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ea51fc6-4476-4d98-b086-42d5570c5c12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677a780>]}
[0m11:40:03.810528 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_first_dbt_model
[0m11:40:03.810735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.my_first_dbt_model)
[0m11:40:03.810879 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_first_dbt_model
[0m11:40:03.813600 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_first_dbt_model"
[0m11:40:03.813891 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_first_dbt_model
[0m11:40:03.814126 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_first_dbt_model
[0m11:40:03.814274 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:40:03.814463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_first_dbt_model, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m11:40:03.814619 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:40:03.815527 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:40:03.815766 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:40:03.815990 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:40:03.816128 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:40:03.816273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m11:40:03.816395 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:40:03.817580 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:40:03.817789 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:40:03.818002 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:40:03.818136 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.my_second_dbt_model
[0m11:40:03.818272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_creditcard_riders_by_day, now model.nyc_yellow_taxi.my_second_dbt_model)
[0m11:40:03.818391 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.my_second_dbt_model
[0m11:40:03.819162 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.my_second_dbt_model"
[0m11:40:03.819357 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.my_second_dbt_model
[0m11:40:03.819561 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.my_second_dbt_model
[0m11:40:03.819701 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:40:03.819874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.my_second_dbt_model, now test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710)
[0m11:40:03.820013 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:40:03.824093 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710"
[0m11:40:03.824338 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:40:03.824557 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710
[0m11:40:03.824694 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m11:40:03.824833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_first_dbt_model_id.5fb22c2710, now test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321)
[0m11:40:03.824955 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m11:40:03.826956 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321"
[0m11:40:03.827165 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m11:40:03.827375 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321
[0m11:40:03.827521 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m11:40:03.827708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.unique_my_first_dbt_model_id.16e066b321, now test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778)
[0m11:40:03.827894 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m11:40:03.829255 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778"
[0m11:40:03.829505 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m11:40:03.829730 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778
[0m11:40:03.829868 [debug] [Thread-1 (]: Began running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m11:40:03.830014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.nyc_yellow_taxi.not_null_my_second_dbt_model_id.151b76d778, now test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493)
[0m11:40:03.830139 [debug] [Thread-1 (]: Began compiling node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m11:40:03.831356 [debug] [Thread-1 (]: Writing injected SQL for node "test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:40:03.831580 [debug] [Thread-1 (]: Began executing node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m11:40:03.831786 [debug] [Thread-1 (]: Finished running node test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493
[0m11:40:03.832154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:03.832274 [debug] [MainThread]: Connection 'test.nyc_yellow_taxi.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:40:03.832761 [debug] [MainThread]: Command end result
[0m11:40:03.856252 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:40:03.856953 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:40:03.859119 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m11:40:03.860318 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m11:40:03.860443 [info ] [MainThread]: Building catalog
[0m11:40:03.863361 [debug] [ThreadPool]: Acquiring new duckdb connection 'dbt.information_schema'
[0m11:40:03.865861 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m11:40:03.865994 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m11:40:03.866095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:03.870110 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:40:03.870240 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m11:40:03.870366 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dbt'
    )
    select
        'dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m11:40:03.879290 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m11:40:03.886808 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m11:40:03.887196 [debug] [ThreadPool]: Failed to rollback 'dbt.information_schema'
[0m11:40:03.887312 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m11:40:03.897801 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m11:40:03.904792 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:40:03.905414 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:40:03.905541 [info ] [MainThread]: Catalog written to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m11:40:03.906241 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.37166804, "process_in_blocks": "0", "process_kernel_time": 0.10935, "process_mem_max_rss": "139493376", "process_out_blocks": "0", "process_user_time": 0.738619}
[0m11:40:03.906488 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:40:03.906446 after 0.37 seconds
[0m11:40:03.906627 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:40:03.906735 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m11:40:03.906866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a87fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8f1a0>]}
[0m11:40:03.907001 [debug] [MainThread]: Flushing usage events
[0m11:40:04.053041 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:40:04.667137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106435100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a88f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a84d0>]}


============================== 11:40:04.668942 | d53bfebf-dc7b-424f-92b5-773f6145d7f2 ==============================
[0m11:40:04.668942 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:40:04.669196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:40:04.750263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd53bfebf-dc7b-424f-92b5-773f6145d7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ea510>]}
[0m11:40:04.768515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd53bfebf-dc7b-424f-92b5-773f6145d7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589b950>]}
[0m11:44:07.677604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105563bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c01a0>]}


============================== 11:44:07.680022 | 48eed09f-227c-43d2-ad9f-eae549885964 ==============================
[0m11:44:07.680022 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:44:07.680277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:07.793625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48eed09f-227c-43d2-ad9f-eae549885964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c1c70>]}
[0m11:44:07.812422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48eed09f-227c-43d2-ad9f-eae549885964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de9940>]}
[0m11:44:07.814073 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:44:07.858217 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:44:07.900932 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m11:44:07.901216 [debug] [MainThread]: Partial parsing: deleted file: nyc_yellow_taxi://models/example/my_first_dbt_model.sql
[0m11:44:07.901342 [debug] [MainThread]: Partial parsing: deleted file: nyc_yellow_taxi://models/example/my_second_dbt_model.sql
[0m11:44:07.920247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m11:44:07.922393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48eed09f-227c-43d2-ad9f-eae549885964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e7a3f0>]}
[0m11:44:07.941490 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:44:07.942259 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:44:07.953198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48eed09f-227c-43d2-ad9f-eae549885964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9f7a0>]}
[0m11:44:07.953431 [info ] [MainThread]: Found 2 models, 426 macros
[0m11:44:07.953572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48eed09f-227c-43d2-ad9f-eae549885964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10578dd60>]}
[0m11:44:07.954261 [info ] [MainThread]: 
[0m11:44:07.954407 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:44:07.954523 [info ] [MainThread]: 
[0m11:44:07.954727 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:44:07.956471 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m11:44:07.980814 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m11:44:07.981036 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m11:44:07.981160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:08.041153 [debug] [ThreadPool]: SQL status: OK in 0.060 seconds
[0m11:44:08.042178 [debug] [ThreadPool]: On list_dbt: Close
[0m11:44:08.043857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m11:44:08.044069 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m11:44:08.046751 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:44:08.046882 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m11:44:08.046987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:08.051136 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:44:08.051691 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:44:08.051805 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m11:44:08.051962 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:08.052069 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:44:08.052182 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m11:44:08.052767 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:08.053081 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m11:44:08.053196 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:44:08.053291 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m11:44:08.053433 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:44:08.053546 [debug] [ThreadPool]: On create_dbt_main: Close
[0m11:44:08.054685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m11:44:08.056709 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:44:08.056823 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m11:44:08.056917 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:44:08.060708 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:44:08.060834 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:44:08.060955 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m11:44:08.070755 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m11:44:08.071298 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m11:44:08.072087 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m11:44:08.072251 [debug] [ThreadPool]: On list_dbt_main: Close
[0m11:44:08.073536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48eed09f-227c-43d2-ad9f-eae549885964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059455b0>]}
[0m11:44:08.073735 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:08.073847 [debug] [MainThread]: On master: BEGIN
[0m11:44:08.073947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:44:08.077958 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m11:44:08.078093 [debug] [MainThread]: On master: COMMIT
[0m11:44:08.078212 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:08.078324 [debug] [MainThread]: On master: COMMIT
[0m11:44:08.078493 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:08.078605 [debug] [MainThread]: On master: Close
[0m11:44:08.079859 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:44:08.080080 [info ] [Thread-1 (]: 1 of 2 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m11:44:08.080247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m11:44:08.080391 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:44:08.083155 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:08.083455 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:44:08.095789 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:08.096226 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:08.096393 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m11:44:08.096542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:08.100666 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:44:08.100824 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:08.100966 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m11:44:09.155590 [debug] [Thread-1 (]: SQL status: OK in 1.054 seconds
[0m11:44:09.158237 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:09.158397 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m11:44:09.159207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:09.160312 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:09.160454 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m11:44:09.160741 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:09.166420 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m11:44:09.166589 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:09.166718 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m11:44:09.188027 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m11:44:09.189884 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:09.190031 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m11:44:09.190680 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:09.191592 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m11:44:09.204355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48eed09f-227c-43d2-ad9f-eae549885964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e79670>]}
[0m11:44:09.204673 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.12s]
[0m11:44:09.204895 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:44:09.205063 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:44:09.205318 [info ] [Thread-1 (]: 2 of 2 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m11:44:09.205519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m11:44:09.205669 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:44:09.206330 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:09.206615 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:44:09.213266 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:09.213653 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:09.213780 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m11:44:09.213894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:44:09.218241 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:44:09.218435 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:09.218583 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m11:44:09.220181 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m11:44:09.221427 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:09.221579 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m11:44:09.221998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:09.222934 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:09.223067 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m11:44:09.223272 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:09.223795 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m11:44:09.223922 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:09.224042 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m11:44:09.224402 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:09.225220 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:09.225353 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m11:44:09.225627 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:44:09.226112 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m11:44:09.230231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48eed09f-227c-43d2-ad9f-eae549885964', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa6f60>]}
[0m11:44:09.230564 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m11:44:09.230797 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:44:09.231341 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:09.231514 [debug] [MainThread]: On master: BEGIN
[0m11:44:09.231640 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:44:09.235700 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m11:44:09.235858 [debug] [MainThread]: On master: COMMIT
[0m11:44:09.235974 [debug] [MainThread]: Using duckdb connection "master"
[0m11:44:09.236201 [debug] [MainThread]: On master: COMMIT
[0m11:44:09.236366 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:44:09.236509 [debug] [MainThread]: On master: Close
[0m11:44:09.237265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:09.237399 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.total_creditcard_riders_by_day' was properly closed.
[0m11:44:09.237522 [info ] [MainThread]: 
[0m11:44:09.237647 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m11:44:09.237961 [debug] [MainThread]: Command end result
[0m11:44:09.245188 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:44:09.245894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:44:09.248260 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m11:44:09.248393 [info ] [MainThread]: 
[0m11:44:09.248552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:44:09.248670 [info ] [MainThread]: 
[0m11:44:09.248798 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:44:09.249703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6115106, "process_in_blocks": "0", "process_kernel_time": 0.360968, "process_mem_max_rss": "483885056", "process_out_blocks": "0", "process_user_time": 3.146145}
[0m11:44:09.249919 [debug] [MainThread]: Command `dbt run` succeeded at 11:44:09.249883 after 1.61 seconds
[0m11:44:09.250068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10592b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f0b590>]}
[0m11:44:09.250203 [debug] [MainThread]: Flushing usage events
[0m11:44:09.437413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:10.078420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104928c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104928830>]}


============================== 11:44:10.080440 | 1bb947a1-dc77-4076-9679-ae3e48c96f1e ==============================
[0m11:44:10.080440 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:44:10.080729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:10.161663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bb947a1-dc77-4076-9679-ae3e48c96f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104996ae0>]}
[0m11:44:10.180311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bb947a1-dc77-4076-9679-ae3e48c96f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034b6d80>]}
[0m11:44:10.181778 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:44:10.220389 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:44:10.252123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:44:10.252333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:44:10.254594 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m11:44:10.262132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bb947a1-dc77-4076-9679-ae3e48c96f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498a1e0>]}
[0m11:44:10.268364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bb947a1-dc77-4076-9679-ae3e48c96f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ddf920>]}
[0m11:44:10.268604 [info ] [MainThread]: Found 2 models, 426 macros
[0m11:44:10.268765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bb947a1-dc77-4076-9679-ae3e48c96f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b23920>]}
[0m11:44:10.269538 [info ] [MainThread]: 
[0m11:44:10.269697 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:44:10.269812 [info ] [MainThread]: 
[0m11:44:10.270020 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:44:10.272339 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt_main'
[0m11:44:10.292184 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:44:10.292419 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m11:44:10.292541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:10.298367 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m11:44:10.298593 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:44:10.298751 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m11:44:10.305939 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:44:10.306556 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m11:44:10.307051 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m11:44:10.307172 [debug] [ThreadPool]: On list_dbt_main: Close
[0m11:44:10.308516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bb947a1-dc77-4076-9679-ae3e48c96f1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e87a0>]}
[0m11:44:10.309559 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:44:10.309771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m11:44:10.309922 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:44:10.312609 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:44:10.312914 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:44:10.313180 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:44:10.313335 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:44:10.313497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m11:44:10.313748 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:44:10.314639 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:44:10.315012 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:44:10.315278 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:44:10.315730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:44:10.315848 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.total_creditcard_riders_by_day' was properly closed.
[0m11:44:10.316117 [debug] [MainThread]: Command end result
[0m11:44:10.335600 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:44:10.336406 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:44:10.338692 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m11:44:10.340146 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m11:44:10.340271 [info ] [MainThread]: Building catalog
[0m11:44:10.343184 [debug] [ThreadPool]: Acquiring new duckdb connection 'dbt.information_schema'
[0m11:44:10.345847 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m11:44:10.345978 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m11:44:10.346084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:44:10.350418 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:44:10.350571 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m11:44:10.350718 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dbt'
    )
    select
        'dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m11:44:10.361490 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m11:44:10.369596 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m11:44:10.370028 [debug] [ThreadPool]: Failed to rollback 'dbt.information_schema'
[0m11:44:10.370140 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m11:44:10.380361 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m11:44:10.386992 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:44:10.387601 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:44:10.387729 [info ] [MainThread]: Catalog written to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m11:44:10.388454 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.3501984, "process_in_blocks": "0", "process_kernel_time": 0.105477, "process_mem_max_rss": "140492800", "process_out_blocks": "0", "process_user_time": 0.710129}
[0m11:44:10.388696 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:44:10.388654 after 0.35 seconds
[0m11:44:10.388835 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:44:10.388934 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m11:44:10.389068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104761ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103976270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102aa5370>]}
[0m11:44:10.389206 [debug] [MainThread]: Flushing usage events
[0m11:44:10.534600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:44:11.146755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031c2720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d4740>]}


============================== 11:44:11.148743 | 0c98311b-41f9-4fe8-a21b-be11ccb4275c ==============================
[0m11:44:11.148743 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:44:11.149002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:44:11.228043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c98311b-41f9-4fe8-a21b-be11ccb4275c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d6720>]}
[0m11:44:11.246244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c98311b-41f9-4fe8-a21b-be11ccb4275c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043479e0>]}
[0m11:44:52.165596 [error] [MainThread]: Encountered an error:

[0m11:44:52.169398 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 240, in serve_forever
    self._handle_request_noblock()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 318, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 349, in process_request
    self.finish_request(request, client_address)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 362, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/server.py", line 672, in __init__
    super().__init__(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 761, in __init__
    self.handle()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/server.py", line 436, in handle
    self.handle_one_request()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/http/server.py", line 404, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socket.py", line 707, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:44:52.170589 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 41.06258, "process_in_blocks": "0", "process_kernel_time": 0.075399, "process_mem_max_rss": "107970560", "process_out_blocks": "0", "process_user_time": 0.550515}
[0m11:44:52.170973 [debug] [MainThread]: Command `dbt docs serve` failed at 11:44:52.170913 after 41.06 seconds
[0m11:44:52.171296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f083b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104863b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10473d700>]}
[0m11:44:52.171552 [debug] [MainThread]: Flushing usage events
[0m11:44:52.332669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:01.924518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c04a0>]}


============================== 11:46:01.926397 | 24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6 ==============================
[0m11:46:01.926397 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:46:01.926646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:46:02.006799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055baa20>]}
[0m11:46:02.025103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a2a570>]}
[0m11:46:02.026450 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:46:02.063879 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:46:02.095436 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:02.095612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:02.097802 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m11:46:02.105035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dc380>]}
[0m11:46:02.124501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:46:02.125307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:46:02.131537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676b2f0>]}
[0m11:46:02.131736 [info ] [MainThread]: Found 2 models, 426 macros
[0m11:46:02.131871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065dc3b0>]}
[0m11:46:02.132600 [info ] [MainThread]: 
[0m11:46:02.132748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:02.132859 [info ] [MainThread]: 
[0m11:46:02.133068 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:46:02.134791 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m11:46:02.156771 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m11:46:02.157017 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m11:46:02.157145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:02.162605 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:46:02.163149 [debug] [ThreadPool]: On list_dbt: Close
[0m11:46:02.164081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m11:46:02.164255 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m11:46:02.166778 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:46:02.166909 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m11:46:02.167013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:02.170976 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:46:02.171451 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:46:02.171562 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m11:46:02.171714 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:02.171836 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:46:02.171945 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m11:46:02.172186 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:02.172523 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m11:46:02.172639 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m11:46:02.172740 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m11:46:02.172914 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m11:46:02.173016 [debug] [ThreadPool]: On create_dbt_main: Close
[0m11:46:02.174055 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m11:46:02.176052 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:46:02.176167 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m11:46:02.176260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:02.180029 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:46:02.180143 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:46:02.180252 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m11:46:02.187271 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:46:02.187840 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m11:46:02.188392 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m11:46:02.188538 [debug] [ThreadPool]: On list_dbt_main: Close
[0m11:46:02.190152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10640a120>]}
[0m11:46:02.190363 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:02.190472 [debug] [MainThread]: On master: BEGIN
[0m11:46:02.190571 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:02.194689 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m11:46:02.194814 [debug] [MainThread]: On master: COMMIT
[0m11:46:02.194920 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:02.195019 [debug] [MainThread]: On master: COMMIT
[0m11:46:02.195208 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:02.195369 [debug] [MainThread]: On master: Close
[0m11:46:02.196620 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:46:02.196820 [info ] [Thread-1 (]: 1 of 2 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m11:46:02.196980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m11:46:02.197117 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:46:02.199869 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:02.200194 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:46:02.211939 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:02.212318 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:02.212454 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m11:46:02.212573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:02.216752 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m11:46:02.216921 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:02.217059 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m11:46:04.022137 [debug] [Thread-1 (]: SQL status: OK in 1.805 seconds
[0m11:46:04.024890 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:04.025054 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m11:46:04.025388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:04.026373 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:04.026499 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m11:46:04.026712 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:04.032662 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m11:46:04.032806 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:04.032933 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m11:46:04.041211 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m11:46:04.043052 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:04.043199 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m11:46:04.043836 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:04.044799 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m11:46:04.053918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b2390>]}
[0m11:46:04.054261 [info ] [Thread-1 (]: 1 of 2 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.86s]
[0m11:46:04.054485 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:46:04.054660 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:46:04.054884 [info ] [Thread-1 (]: 2 of 2 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m11:46:04.055081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m11:46:04.055235 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:46:04.055949 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:04.056203 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:46:04.063231 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:04.063540 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:04.063687 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m11:46:04.063819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:04.069059 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m11:46:04.069264 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:04.069405 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m11:46:04.069768 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:04.070925 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:04.071057 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m11:46:04.071274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:04.072163 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:04.072292 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m11:46:04.072491 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:04.073092 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m11:46:04.073213 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:04.073342 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m11:46:04.073711 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:04.074480 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:04.074683 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m11:46:04.074977 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m11:46:04.075474 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m11:46:04.079894 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24f49ff3-89ff-4a8d-833c-c8e2ef7e1db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107373560>]}
[0m11:46:04.080136 [info ] [Thread-1 (]: 2 of 2 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m11:46:04.080346 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:46:04.080854 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:04.081014 [debug] [MainThread]: On master: BEGIN
[0m11:46:04.081137 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:04.085250 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m11:46:04.085401 [debug] [MainThread]: On master: COMMIT
[0m11:46:04.085525 [debug] [MainThread]: Using duckdb connection "master"
[0m11:46:04.085626 [debug] [MainThread]: On master: COMMIT
[0m11:46:04.085775 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m11:46:04.085917 [debug] [MainThread]: On master: Close
[0m11:46:04.086691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:04.086821 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.total_creditcard_riders_by_day' was properly closed.
[0m11:46:04.086942 [info ] [MainThread]: 
[0m11:46:04.087073 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.95 seconds (1.95s).
[0m11:46:04.087388 [debug] [MainThread]: Command end result
[0m11:46:04.094894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:46:04.095581 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:46:04.097659 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m11:46:04.097783 [info ] [MainThread]: 
[0m11:46:04.097940 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:04.098056 [info ] [MainThread]: 
[0m11:46:04.098182 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:46:04.099094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.213489, "process_in_blocks": "0", "process_kernel_time": 0.319439, "process_mem_max_rss": "497664000", "process_out_blocks": "0", "process_user_time": 2.387832}
[0m11:46:04.099317 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:04.099280 after 2.21 seconds
[0m11:46:04.099469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608fe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032af410>]}
[0m11:46:04.099605 [debug] [MainThread]: Flushing usage events
[0m11:46:04.260233 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:04.891400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b1640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108850b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108850740>]}


============================== 11:46:04.893271 | 5dd943cd-2a9c-4c75-8ddf-eca4d5fc0fd6 ==============================
[0m11:46:04.893271 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:46:04.893529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:46:04.973219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dd943cd-2a9c-4c75-8ddf-eca4d5fc0fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bf2f0>]}
[0m11:46:04.991532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dd943cd-2a9c-4c75-8ddf-eca4d5fc0fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e6ba0>]}
[0m11:46:04.992916 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m11:46:05.030517 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m11:46:05.061623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:05.061825 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:05.064037 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m11:46:05.071370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dd943cd-2a9c-4c75-8ddf-eca4d5fc0fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b70ef0>]}
[0m11:46:05.077853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dd943cd-2a9c-4c75-8ddf-eca4d5fc0fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d07770>]}
[0m11:46:05.078070 [info ] [MainThread]: Found 2 models, 426 macros
[0m11:46:05.078203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd943cd-2a9c-4c75-8ddf-eca4d5fc0fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b06b0>]}
[0m11:46:05.078915 [info ] [MainThread]: 
[0m11:46:05.079056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:05.079176 [info ] [MainThread]: 
[0m11:46:05.079403 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:46:05.081643 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt_main'
[0m11:46:05.101204 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:46:05.101406 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m11:46:05.101521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:05.106528 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m11:46:05.106676 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m11:46:05.106796 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m11:46:05.114291 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m11:46:05.114969 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m11:46:05.115483 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m11:46:05.115602 [debug] [ThreadPool]: On list_dbt_main: Close
[0m11:46:05.117026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dd943cd-2a9c-4c75-8ddf-eca4d5fc0fd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b736e0>]}
[0m11:46:05.118045 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:46:05.118237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m11:46:05.118377 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:46:05.121039 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m11:46:05.121365 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:46:05.121603 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m11:46:05.121741 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:46:05.121879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m11:46:05.122007 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:46:05.122627 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m11:46:05.122868 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:46:05.123095 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m11:46:05.123476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:05.123643 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.total_creditcard_riders_by_day' was properly closed.
[0m11:46:05.123945 [debug] [MainThread]: Command end result
[0m11:46:05.143378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:46:05.144183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:46:05.146429 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m11:46:05.147863 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m11:46:05.147991 [info ] [MainThread]: Building catalog
[0m11:46:05.150871 [debug] [ThreadPool]: Acquiring new duckdb connection 'dbt.information_schema'
[0m11:46:05.153542 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m11:46:05.153672 [debug] [ThreadPool]: On dbt.information_schema: BEGIN
[0m11:46:05.153778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:05.158112 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m11:46:05.158278 [debug] [ThreadPool]: Using duckdb connection "dbt.information_schema"
[0m11:46:05.158429 [debug] [ThreadPool]: On dbt.information_schema: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "dbt.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'dbt'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'dbt'
    )
    select
        'dbt' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m11:46:05.167103 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m11:46:05.175136 [debug] [ThreadPool]: On dbt.information_schema: ROLLBACK
[0m11:46:05.175635 [debug] [ThreadPool]: Failed to rollback 'dbt.information_schema'
[0m11:46:05.175791 [debug] [ThreadPool]: On dbt.information_schema: Close
[0m11:46:05.186176 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m11:46:05.193377 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m11:46:05.194266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m11:46:05.194417 [info ] [MainThread]: Catalog written to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/catalog.json
[0m11:46:05.195183 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.34459513, "process_in_blocks": "0", "process_kernel_time": 0.105374, "process_mem_max_rss": "140509184", "process_out_blocks": "0", "process_user_time": 0.718983}
[0m11:46:05.195433 [debug] [MainThread]: Command `dbt docs generate` succeeded at 11:46:05.195390 after 0.34 seconds
[0m11:46:05.195578 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m11:46:05.195681 [debug] [MainThread]: Connection 'dbt.information_schema' was properly closed.
[0m11:46:05.195815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108850890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087d7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa6240>]}
[0m11:46:05.195968 [debug] [MainThread]: Flushing usage events
[0m11:46:05.339522 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:46:05.955904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081601a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c4b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c4680>]}


============================== 11:46:05.957715 | 52408a4e-1c2b-4410-89d3-22c9687af7c2 ==============================
[0m11:46:05.957715 [info ] [MainThread]: Running with dbt=1.9.2
[0m11:46:05.957973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:46:06.038346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52408a4e-1c2b-4410-89d3-22c9687af7c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083db110>]}
[0m11:46:06.056544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52408a4e-1c2b-4410-89d3-22c9687af7c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eceba0>]}
[0m11:46:17.793406 [error] [MainThread]: Encountered an error:

[0m11:46:17.796789 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m11:46:17.798402 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 11.882899, "process_in_blocks": "0", "process_kernel_time": 0.074132, "process_mem_max_rss": "105938944", "process_out_blocks": "0", "process_user_time": 0.550159}
[0m11:46:17.798837 [debug] [MainThread]: Command `dbt docs serve` failed at 11:46:17.798767 after 11.88 seconds
[0m11:46:17.799182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081601a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108357cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849c2f0>]}
[0m11:46:17.799461 [debug] [MainThread]: Flushing usage events
[0m11:46:17.950836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:38.902810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c36a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589d460>]}


============================== 19:44:38.905273 | e0b0b568-db5a-48b3-b341-184a7ed0c3ce ==============================
[0m19:44:38.905273 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:44:38.905528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:44:39.025066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0b0b568-db5a-48b3-b341-184a7ed0c3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106387b90>]}
[0m19:44:39.043565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0b0b568-db5a-48b3-b341-184a7ed0c3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651bbc0>]}
[0m19:44:39.045166 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:44:39.085717 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:44:39.123160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:44:39.123379 [debug] [MainThread]: Partial parsing: added file: nyc_yellow_taxi://models/taxi_rides/total_amounts.sql
[0m19:44:39.198644 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m19:44:39.200358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0b0b568-db5a-48b3-b341-184a7ed0c3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a37b90>]}
[0m19:44:39.218586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m19:44:39.219543 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m19:44:39.236305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0b0b568-db5a-48b3-b341-184a7ed0c3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0b080>]}
[0m19:44:39.236538 [info ] [MainThread]: Found 3 models, 426 macros
[0m19:44:39.236674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0b0b568-db5a-48b3-b341-184a7ed0c3ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106935a90>]}
[0m19:44:39.237337 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m19:44:39.237553 [debug] [MainThread]: Command end result
[0m19:44:39.244231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m19:44:39.244740 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m19:44:39.246035 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m19:44:39.246867 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.38536072, "process_in_blocks": "0", "process_kernel_time": 0.123199, "process_mem_max_rss": "118685696", "process_out_blocks": "0", "process_user_time": 0.714958}
[0m19:44:39.247087 [debug] [MainThread]: Command `dbt test` succeeded at 19:44:39.247052 after 0.39 seconds
[0m19:44:39.247224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069346b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106385fa0>]}
[0m19:44:39.247344 [debug] [MainThread]: Flushing usage events
[0m19:44:39.406902 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:44:45.621313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105603770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dbdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063080b0>]}


============================== 19:44:45.623053 | 485f3f47-b9a6-4e75-a08f-250d27b97bcb ==============================
[0m19:44:45.623053 [info ] [MainThread]: Running with dbt=1.9.2
[0m19:44:45.623302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:44:45.700557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458e660>]}
[0m19:44:45.718709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105557530>]}
[0m19:44:45.719963 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m19:44:45.756343 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m19:44:45.786729 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:44:45.786885 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:44:45.789016 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m19:44:45.796069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106629220>]}
[0m19:44:45.816013 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m19:44:45.816702 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m19:44:45.822094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f50740>]}
[0m19:44:45.822288 [info ] [MainThread]: Found 3 models, 426 macros
[0m19:44:45.822422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b6990>]}
[0m19:44:45.823069 [info ] [MainThread]: 
[0m19:44:45.823205 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:44:45.823312 [info ] [MainThread]: 
[0m19:44:45.823504 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:44:45.825290 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m19:44:45.851223 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m19:44:45.851402 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m19:44:45.851515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:44:45.892964 [debug] [ThreadPool]: SQL status: OK in 0.041 seconds
[0m19:44:45.893536 [debug] [ThreadPool]: On list_dbt: Close
[0m19:44:45.894877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m19:44:45.895088 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m19:44:45.897615 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m19:44:45.897748 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m19:44:45.897845 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:45.901096 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:44:45.901598 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m19:44:45.901696 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m19:44:45.901842 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:44:45.901960 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m19:44:45.902062 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m19:44:45.902470 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:44:45.902771 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m19:44:45.902870 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m19:44:45.902963 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m19:44:45.903102 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:44:45.903217 [debug] [ThreadPool]: On create_dbt_main: Close
[0m19:44:45.904049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m19:44:45.906025 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m19:44:45.906126 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m19:44:45.906211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:44:45.909248 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m19:44:45.909364 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m19:44:45.909476 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m19:44:45.915158 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m19:44:45.915617 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m19:44:45.916332 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m19:44:45.916428 [debug] [ThreadPool]: On list_dbt_main: Close
[0m19:44:45.917296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106844440>]}
[0m19:44:45.917488 [debug] [MainThread]: Using duckdb connection "master"
[0m19:44:45.917584 [debug] [MainThread]: On master: BEGIN
[0m19:44:45.917670 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:44:45.920755 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:44:45.920868 [debug] [MainThread]: On master: COMMIT
[0m19:44:45.920968 [debug] [MainThread]: Using duckdb connection "master"
[0m19:44:45.921056 [debug] [MainThread]: On master: COMMIT
[0m19:44:45.921180 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:44:45.921279 [debug] [MainThread]: On master: Close
[0m19:44:45.922199 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m19:44:45.922405 [info ] [Thread-1 (]: 1 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m19:44:45.922577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m19:44:45.922706 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m19:44:45.925264 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m19:44:45.925951 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m19:44:45.937297 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m19:44:45.937579 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m19:44:45.937694 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m19:44:45.937798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:45.940780 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:44:45.940911 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m19:44:45.941034 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m19:44:47.091107 [debug] [Thread-1 (]: SQL status: OK in 1.150 seconds
[0m19:44:47.093651 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m19:44:47.093806 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m19:44:47.094150 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.095090 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m19:44:47.095209 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m19:44:47.095403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.101141 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m19:44:47.101274 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m19:44:47.101380 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m19:44:47.123541 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m19:44:47.125422 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m19:44:47.125557 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m19:44:47.126078 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.126975 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m19:44:47.137855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c17e30>]}
[0m19:44:47.138160 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.21s]
[0m19:44:47.138382 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m19:44:47.138541 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_amounts
[0m19:44:47.138733 [info ] [Thread-1 (]: 2 of 3 START sql view model main.total_amounts ................................. [RUN]
[0m19:44:47.138897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_amounts)
[0m19:44:47.139024 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_amounts
[0m19:44:47.140182 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_amounts"
[0m19:44:47.140447 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_amounts
[0m19:44:47.146567 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_amounts"
[0m19:44:47.146823 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m19:44:47.146936 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: BEGIN
[0m19:44:47.147041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:47.150262 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:44:47.150390 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m19:44:47.150515 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */

  
  create view "dbt"."main"."total_amounts__dbt_tmp" as (
    select

  fare_amount,

  tip_amount,

  tolls_amount,

  total_amount

from taxi_rides_raw
  );

[0m19:44:47.150743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.151712 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m19:44:47.151883 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
alter view "dbt"."main"."total_amounts__dbt_tmp" rename to "total_amounts"
[0m19:44:47.152081 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.152544 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: COMMIT
[0m19:44:47.152656 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m19:44:47.152764 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: COMMIT
[0m19:44:47.153057 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.153764 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m19:44:47.153875 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
drop view if exists "dbt"."main"."total_amounts__dbt_backup" cascade
[0m19:44:47.154075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.154609 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: Close
[0m19:44:47.158221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbcbc0>]}
[0m19:44:47.158447 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.total_amounts ............................ [[32mOK[0m in 0.02s]
[0m19:44:47.158650 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_amounts
[0m19:44:47.158795 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m19:44:47.158983 [info ] [Thread-1 (]: 3 of 3 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m19:44:47.159141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_amounts, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m19:44:47.159267 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m19:44:47.159800 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m19:44:47.160024 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m19:44:47.161061 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m19:44:47.161279 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m19:44:47.161388 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m19:44:47.161491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:44:47.164636 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m19:44:47.164780 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m19:44:47.164913 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from taxi_rides_raw
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m19:44:47.165514 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.166547 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m19:44:47.166670 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m19:44:47.166851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.167767 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m19:44:47.167897 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m19:44:47.168071 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.168605 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m19:44:47.168723 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m19:44:47.168825 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m19:44:47.169280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.169991 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m19:44:47.170106 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m19:44:47.170301 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:44:47.170727 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m19:44:47.175155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485f3f47-b9a6-4e75-a08f-250d27b97bcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aabdd0>]}
[0m19:44:47.175429 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m19:44:47.175646 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m19:44:47.176112 [debug] [MainThread]: Using duckdb connection "master"
[0m19:44:47.176230 [debug] [MainThread]: On master: BEGIN
[0m19:44:47.176328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:44:47.179522 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m19:44:47.179679 [debug] [MainThread]: On master: COMMIT
[0m19:44:47.179797 [debug] [MainThread]: Using duckdb connection "master"
[0m19:44:47.179900 [debug] [MainThread]: On master: COMMIT
[0m19:44:47.180073 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:44:47.180243 [debug] [MainThread]: On master: Close
[0m19:44:47.180786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:44:47.180895 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.total_creditcard_riders_by_day' was properly closed.
[0m19:44:47.181026 [info ] [MainThread]: 
[0m19:44:47.181145 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m19:44:47.181472 [debug] [MainThread]: Command end result
[0m19:44:47.188766 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m19:44:47.189477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m19:44:47.191553 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m19:44:47.191667 [info ] [MainThread]: 
[0m19:44:47.191798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:44:47.191903 [info ] [MainThread]: 
[0m19:44:47.192024 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:44:47.192675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6089867, "process_in_blocks": "0", "process_kernel_time": 0.342087, "process_mem_max_rss": "502513664", "process_out_blocks": "0", "process_user_time": 2.176828}
[0m19:44:47.192877 [debug] [MainThread]: Command `dbt run` succeeded at 19:44:47.192843 after 1.61 seconds
[0m19:44:47.193010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105603770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105602450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109017380>]}
[0m19:44:47.193148 [debug] [MainThread]: Flushing usage events
[0m19:44:47.340401 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:30:55.553526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a55040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc04a0>]}


============================== 07:30:55.556023 | 49efa2c5-7d2b-4da5-8184-cb08ec6dd80b ==============================
[0m07:30:55.556023 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:30:55.556298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'debug': 'False', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:30:55.675064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0e180>]}
[0m07:30:55.694238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106261700>]}
[0m07:30:55.696168 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:30:55.738660 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m07:30:55.777706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:30:55.777993 [debug] [MainThread]: Partial parsing: updated file: nyc_yellow_taxi://models/taxi_rides/total_creditcard_riders_by_day.sql
[0m07:30:55.854815 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m07:30:55.856740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed94c0>]}
[0m07:30:55.876938 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m07:30:55.878351 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m07:30:55.889822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d1910>]}
[0m07:30:55.890065 [info ] [MainThread]: Found 3 models, 426 macros
[0m07:30:55.890195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073eb9e0>]}
[0m07:30:55.890960 [info ] [MainThread]: 
[0m07:30:55.891113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:30:55.891228 [info ] [MainThread]: 
[0m07:30:55.891434 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:30:55.893259 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m07:30:55.917682 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m07:30:55.917884 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m07:30:55.918005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:30:55.964996 [debug] [ThreadPool]: SQL status: OK in 0.047 seconds
[0m07:30:55.965681 [debug] [ThreadPool]: On list_dbt: Close
[0m07:30:55.967550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m07:30:55.967775 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m07:30:55.970488 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m07:30:55.970635 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m07:30:55.970743 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:55.975229 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:30:55.975794 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m07:30:55.975911 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m07:30:55.976071 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:30:55.976181 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m07:30:55.976292 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m07:30:55.976558 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:30:55.976933 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m07:30:55.977052 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m07:30:55.977156 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m07:30:55.977315 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:30:55.977431 [debug] [ThreadPool]: On create_dbt_main: Close
[0m07:30:55.978543 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m07:30:55.980654 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m07:30:55.980779 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m07:30:55.980877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:30:55.984882 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:30:55.985026 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m07:30:55.985142 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m07:30:55.993635 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m07:30:55.994199 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m07:30:55.994931 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m07:30:55.995045 [debug] [ThreadPool]: On list_dbt_main: Close
[0m07:30:55.996442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107345490>]}
[0m07:30:55.996660 [debug] [MainThread]: Using duckdb connection "master"
[0m07:30:55.996784 [debug] [MainThread]: On master: BEGIN
[0m07:30:55.996885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:30:56.000873 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m07:30:56.001014 [debug] [MainThread]: On master: COMMIT
[0m07:30:56.001135 [debug] [MainThread]: Using duckdb connection "master"
[0m07:30:56.001245 [debug] [MainThread]: On master: COMMIT
[0m07:30:56.001395 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:30:56.001511 [debug] [MainThread]: On master: Close
[0m07:30:56.003472 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m07:30:56.003696 [info ] [Thread-1 (]: 1 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m07:30:56.003874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m07:30:56.004019 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m07:30:56.006773 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:30:56.007377 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m07:30:56.019110 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:30:56.019518 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:30:56.019666 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m07:30:56.019796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:56.024448 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m07:30:56.024652 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:30:56.024779 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m07:30:57.164182 [debug] [Thread-1 (]: SQL status: OK in 1.139 seconds
[0m07:30:57.166727 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:30:57.166882 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m07:30:57.167245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.168213 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:30:57.168359 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m07:30:57.168587 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.173969 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m07:30:57.174113 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:30:57.174233 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m07:30:57.185491 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m07:30:57.187446 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:30:57.187598 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m07:30:57.188193 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.189141 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m07:30:57.198550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2e5d0>]}
[0m07:30:57.198852 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.19s]
[0m07:30:57.199068 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m07:30:57.199232 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_amounts
[0m07:30:57.199544 [info ] [Thread-1 (]: 2 of 3 START sql view model main.total_amounts ................................. [RUN]
[0m07:30:57.199785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_amounts)
[0m07:30:57.199947 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_amounts
[0m07:30:57.201202 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_amounts"
[0m07:30:57.201465 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_amounts
[0m07:30:57.207954 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_amounts"
[0m07:30:57.208292 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:30:57.208428 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: BEGIN
[0m07:30:57.208550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:57.212840 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:30:57.213091 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:30:57.213257 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */

  
  create view "dbt"."main"."total_amounts__dbt_tmp" as (
    select

  fare_amount,

  tip_amount,

  tolls_amount,

  total_amount

from taxi_rides_raw
  );

[0m07:30:57.213582 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.214684 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:30:57.214813 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
alter view "dbt"."main"."total_amounts" rename to "total_amounts__dbt_backup"
[0m07:30:57.215048 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.215989 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:30:57.216114 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
alter view "dbt"."main"."total_amounts__dbt_tmp" rename to "total_amounts"
[0m07:30:57.216310 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.216832 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: COMMIT
[0m07:30:57.216953 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:30:57.217066 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: COMMIT
[0m07:30:57.217437 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.218892 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:30:57.219027 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
drop view if exists "dbt"."main"."total_amounts__dbt_backup" cascade
[0m07:30:57.219319 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.219849 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: Close
[0m07:30:57.224217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118357410>]}
[0m07:30:57.224529 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.total_amounts ............................ [[32mOK[0m in 0.02s]
[0m07:30:57.224738 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_amounts
[0m07:30:57.224896 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m07:30:57.225160 [info ] [Thread-1 (]: 3 of 3 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m07:30:57.225387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_amounts, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m07:30:57.225547 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m07:30:57.226667 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:30:57.226943 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m07:30:57.228079 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:30:57.228310 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:30:57.228439 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m07:30:57.228559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:30:57.232624 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:30:57.232782 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:30:57.232919 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from "dbt"."main"."taxi_rides_raw"
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m07:30:57.233559 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m07:30:57.234609 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:30:57.234748 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m07:30:57.234976 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.235918 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:30:57.236053 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m07:30:57.236258 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.237010 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m07:30:57.237187 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:30:57.237334 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m07:30:57.237767 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.238746 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:30:57.238946 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m07:30:57.239276 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:30:57.239780 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m07:30:57.243788 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49efa2c5-7d2b-4da5-8184-cb08ec6dd80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11835df70>]}
[0m07:30:57.244040 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m07:30:57.244246 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m07:30:57.244721 [debug] [MainThread]: Using duckdb connection "master"
[0m07:30:57.244847 [debug] [MainThread]: On master: BEGIN
[0m07:30:57.244957 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:30:57.249587 [debug] [MainThread]: SQL status: OK in 0.005 seconds
[0m07:30:57.249730 [debug] [MainThread]: On master: COMMIT
[0m07:30:57.249845 [debug] [MainThread]: Using duckdb connection "master"
[0m07:30:57.249939 [debug] [MainThread]: On master: COMMIT
[0m07:30:57.250086 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:30:57.250198 [debug] [MainThread]: On master: Close
[0m07:30:57.251031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:30:57.251173 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.total_creditcard_riders_by_day' was properly closed.
[0m07:30:57.251327 [info ] [MainThread]: 
[0m07:30:57.251459 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.36 seconds (1.36s).
[0m07:30:57.251825 [debug] [MainThread]: Command end result
[0m07:30:57.259365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m07:30:57.260184 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m07:30:57.262446 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m07:30:57.262572 [info ] [MainThread]: 
[0m07:30:57.262707 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:30:57.262826 [info ] [MainThread]: 
[0m07:30:57.262957 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:30:57.263895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.753009, "process_in_blocks": "0", "process_kernel_time": 0.348702, "process_mem_max_rss": "521797632", "process_out_blocks": "0", "process_user_time": 2.398254}
[0m07:30:57.264114 [debug] [MainThread]: Command `dbt run` succeeded at 07:30:57.264078 after 1.75 seconds
[0m07:30:57.264266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a55040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a563c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a56300>]}
[0m07:30:57.264403 [debug] [MainThread]: Flushing usage events
[0m07:30:57.423694 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:35:33.662925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106008ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d109e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d105f0>]}


============================== 07:35:33.664797 | 77261d92-e5cd-4a90-bc3c-ef59bda6f4e7 ==============================
[0m07:35:33.664797 [info ] [MainThread]: Running with dbt=1.9.2
[0m07:35:33.665062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'version_check': 'True', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:35:33.746289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e42330>]}
[0m07:35:33.766247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfaae0>]}
[0m07:35:33.767579 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m07:35:33.804902 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m07:35:33.837035 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:35:33.837227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:35:33.839406 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m07:35:33.847018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d73800>]}
[0m07:35:33.866860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m07:35:33.867655 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m07:35:33.873373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e8530>]}
[0m07:35:33.873575 [info ] [MainThread]: Found 3 models, 426 macros
[0m07:35:33.873707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107032540>]}
[0m07:35:33.874426 [info ] [MainThread]: 
[0m07:35:33.874574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:35:33.874691 [info ] [MainThread]: 
[0m07:35:33.874903 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m07:35:33.876722 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m07:35:33.898540 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m07:35:33.898749 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m07:35:33.898877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:35:33.904542 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m07:35:33.905139 [debug] [ThreadPool]: On list_dbt: Close
[0m07:35:33.906100 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m07:35:33.906313 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m07:35:33.908933 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m07:35:33.909069 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m07:35:33.909176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:35:33.913402 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:35:33.913910 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m07:35:33.914027 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m07:35:33.914194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:35:33.914288 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m07:35:33.914385 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m07:35:33.914567 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:35:33.914900 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m07:35:33.915022 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m07:35:33.915122 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m07:35:33.915276 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m07:35:33.915385 [debug] [ThreadPool]: On create_dbt_main: Close
[0m07:35:33.916513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m07:35:33.918587 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m07:35:33.918732 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m07:35:33.918837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:35:33.922893 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m07:35:33.923024 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m07:35:33.923139 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m07:35:33.930279 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m07:35:33.930763 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m07:35:33.931295 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m07:35:33.931417 [debug] [ThreadPool]: On list_dbt_main: Close
[0m07:35:33.932695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10502f860>]}
[0m07:35:33.932898 [debug] [MainThread]: Using duckdb connection "master"
[0m07:35:33.933013 [debug] [MainThread]: On master: BEGIN
[0m07:35:33.933111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:35:33.936913 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m07:35:33.937032 [debug] [MainThread]: On master: COMMIT
[0m07:35:33.937136 [debug] [MainThread]: Using duckdb connection "master"
[0m07:35:33.937232 [debug] [MainThread]: On master: COMMIT
[0m07:35:33.937413 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:35:33.937577 [debug] [MainThread]: On master: Close
[0m07:35:33.938763 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m07:35:33.938975 [info ] [Thread-1 (]: 1 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m07:35:33.939143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m07:35:33.939281 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m07:35:33.942014 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:35:33.942328 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m07:35:33.953952 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:35:33.954325 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:35:33.954454 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m07:35:33.954567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:33.958595 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:35:33.958759 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:35:33.958895 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m07:35:35.055454 [debug] [Thread-1 (]: SQL status: OK in 1.096 seconds
[0m07:35:35.058031 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:35:35.058192 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw" rename to "taxi_rides_raw__dbt_backup"
[0m07:35:35.058524 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.059483 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:35:35.059630 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m07:35:35.059853 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.065673 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m07:35:35.065838 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:35:35.065958 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m07:35:35.087760 [debug] [Thread-1 (]: SQL status: OK in 0.022 seconds
[0m07:35:35.089733 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m07:35:35.089893 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m07:35:35.090501 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.091409 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m07:35:35.100785 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfb980>]}
[0m07:35:35.101094 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.16s]
[0m07:35:35.101311 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m07:35:35.101474 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_amounts
[0m07:35:35.101723 [info ] [Thread-1 (]: 2 of 3 START sql view model main.total_amounts ................................. [RUN]
[0m07:35:35.101908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_amounts)
[0m07:35:35.102048 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_amounts
[0m07:35:35.103259 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_amounts"
[0m07:35:35.103506 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_amounts
[0m07:35:35.109649 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_amounts"
[0m07:35:35.109907 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:35:35.110033 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: BEGIN
[0m07:35:35.110149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:35.114305 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:35:35.114464 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:35:35.114604 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */

  
  create view "dbt"."main"."total_amounts__dbt_tmp" as (
    select

  fare_amount,

  tip_amount,

  tolls_amount,

  total_amount

from taxi_rides_raw
  );

[0m07:35:35.114909 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.116047 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:35:35.116232 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
alter view "dbt"."main"."total_amounts" rename to "total_amounts__dbt_backup"
[0m07:35:35.116623 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.117849 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:35:35.118004 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
alter view "dbt"."main"."total_amounts__dbt_tmp" rename to "total_amounts"
[0m07:35:35.118232 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.118787 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: COMMIT
[0m07:35:35.118912 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:35:35.119026 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: COMMIT
[0m07:35:35.119403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.120213 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m07:35:35.120354 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
drop view if exists "dbt"."main"."total_amounts__dbt_backup" cascade
[0m07:35:35.120613 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.121077 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: Close
[0m07:35:35.125271 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607920>]}
[0m07:35:35.125568 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.total_amounts ............................ [[32mOK[0m in 0.02s]
[0m07:35:35.125797 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_amounts
[0m07:35:35.125964 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m07:35:35.126196 [info ] [Thread-1 (]: 3 of 3 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m07:35:35.126376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_amounts, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m07:35:35.126516 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m07:35:35.127570 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:35:35.127820 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m07:35:35.128907 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:35:35.129404 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:35:35.129525 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m07:35:35.129639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:35:35.133969 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m07:35:35.134176 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:35:35.134333 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from "dbt"."main"."taxi_rides_raw"
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m07:35:35.134703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.135807 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:35:35.135938 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day" rename to "total_creditcard_riders_by_day__dbt_backup"
[0m07:35:35.136163 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.137086 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:35:35.137211 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m07:35:35.137403 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.137971 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m07:35:35.138096 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:35:35.138208 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m07:35:35.138537 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.139979 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m07:35:35.140128 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m07:35:35.140393 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m07:35:35.140852 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m07:35:35.144777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77261d92-e5cd-4a90-bc3c-ef59bda6f4e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080274a0>]}
[0m07:35:35.145071 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.02s]
[0m07:35:35.145297 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m07:35:35.145783 [debug] [MainThread]: Using duckdb connection "master"
[0m07:35:35.145925 [debug] [MainThread]: On master: BEGIN
[0m07:35:35.146040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:35:35.150224 [debug] [MainThread]: SQL status: OK in 0.004 seconds
[0m07:35:35.150382 [debug] [MainThread]: On master: COMMIT
[0m07:35:35.150508 [debug] [MainThread]: Using duckdb connection "master"
[0m07:35:35.150617 [debug] [MainThread]: On master: COMMIT
[0m07:35:35.150800 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m07:35:35.150947 [debug] [MainThread]: On master: Close
[0m07:35:35.151756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:35:35.151865 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.total_creditcard_riders_by_day' was properly closed.
[0m07:35:35.152002 [info ] [MainThread]: 
[0m07:35:35.152125 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m07:35:35.152461 [debug] [MainThread]: Command end result
[0m07:35:35.159155 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m07:35:35.159784 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m07:35:35.161909 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m07:35:35.162022 [info ] [MainThread]: 
[0m07:35:35.162155 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:35:35.162263 [info ] [MainThread]: 
[0m07:35:35.162397 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m07:35:35.163108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5392119, "process_in_blocks": "0", "process_kernel_time": 0.260105, "process_mem_max_rss": "518569984", "process_out_blocks": "0", "process_user_time": 2.372046}
[0m07:35:35.163324 [debug] [MainThread]: Command `dbt run` succeeded at 07:35:35.163285 after 1.54 seconds
[0m07:35:35.163473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10617c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d10770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d105f0>]}
[0m07:35:35.163606 [debug] [MainThread]: Flushing usage events
[0m07:35:35.324855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:35.234612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d71460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b77da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b77e00>]}


============================== 16:13:35.236561 | 42965cae-0b5f-4eb7-bca3-3bde6eeef8c4 ==============================
[0m16:13:35.236561 [info ] [MainThread]: Running with dbt=1.9.2
[0m16:13:35.236849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi', 'log_path': '/Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:13:35.352905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6a4b0>]}
[0m16:13:35.371489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106013410>]}
[0m16:13:35.373252 [info ] [MainThread]: Registered adapter: duckdb=1.9.1
[0m16:13:35.414130 [debug] [MainThread]: checksum: 12b12750b70de726cfd89136b8e24afc3f3e77597a97bff40ab7e5f9b39d5e18, vars: {}, profile: , target: , version: 1.9.2
[0m16:13:35.452675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:13:35.452832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:13:35.455093 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.nyc_yellow_taxi.example
[0m16:13:35.462482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d74140>]}
[0m16:13:35.481822 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m16:13:35.482852 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m16:13:35.493320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107053bf0>]}
[0m16:13:35.493550 [info ] [MainThread]: Found 3 models, 426 macros
[0m16:13:35.493697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec4500>]}
[0m16:13:35.494391 [info ] [MainThread]: 
[0m16:13:35.494528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:13:35.494628 [info ] [MainThread]: 
[0m16:13:35.494825 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m16:13:35.496562 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dbt'
[0m16:13:35.521526 [debug] [ThreadPool]: Using duckdb connection "list_dbt"
[0m16:13:35.521691 [debug] [ThreadPool]: On list_dbt: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"dbt"'
    
  
  
[0m16:13:35.521801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:35.563779 [debug] [ThreadPool]: SQL status: OK in 0.042 seconds
[0m16:13:35.564596 [debug] [ThreadPool]: On list_dbt: Close
[0m16:13:35.565667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt, now create_dbt_main)
[0m16:13:35.565878 [debug] [ThreadPool]: Creating schema "database: "dbt"
schema: "main"
"
[0m16:13:35.568368 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m16:13:35.568490 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='dbt'
        and type='sqlite'
    
  
[0m16:13:35.568587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:35.571689 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:13:35.572217 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m16:13:35.572323 [debug] [ThreadPool]: On create_dbt_main: BEGIN
[0m16:13:35.572515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:13:35.572684 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m16:13:35.572804 [debug] [ThreadPool]: On create_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "create_dbt_main"} */

    
    
        create schema if not exists "dbt"."main"
    
[0m16:13:35.573058 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:13:35.573406 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m16:13:35.573517 [debug] [ThreadPool]: Using duckdb connection "create_dbt_main"
[0m16:13:35.573610 [debug] [ThreadPool]: On create_dbt_main: COMMIT
[0m16:13:35.573750 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m16:13:35.573852 [debug] [ThreadPool]: On create_dbt_main: Close
[0m16:13:35.574562 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_main, now list_dbt_main)
[0m16:13:35.576518 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m16:13:35.576623 [debug] [ThreadPool]: On list_dbt_main: BEGIN
[0m16:13:35.576710 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:35.579638 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m16:13:35.579743 [debug] [ThreadPool]: Using duckdb connection "list_dbt_main"
[0m16:13:35.579852 [debug] [ThreadPool]: On list_dbt_main: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "connection_name": "list_dbt_main"} */
select
      'dbt' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'dbt'
  
[0m16:13:35.585803 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m16:13:35.586328 [debug] [ThreadPool]: On list_dbt_main: ROLLBACK
[0m16:13:35.587063 [debug] [ThreadPool]: Failed to rollback 'list_dbt_main'
[0m16:13:35.587179 [debug] [ThreadPool]: On list_dbt_main: Close
[0m16:13:35.587850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070dc7a0>]}
[0m16:13:35.588029 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:35.588126 [debug] [MainThread]: On master: BEGIN
[0m16:13:35.588215 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:35.591056 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:13:35.591203 [debug] [MainThread]: On master: COMMIT
[0m16:13:35.591320 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:35.591422 [debug] [MainThread]: On master: COMMIT
[0m16:13:35.591554 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:13:35.591655 [debug] [MainThread]: On master: Close
[0m16:13:35.592464 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.taxi_rides_raw
[0m16:13:35.592672 [info ] [Thread-1 (]: 1 of 3 START sql table model main.taxi_rides_raw ............................... [RUN]
[0m16:13:35.592927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_main, now model.nyc_yellow_taxi.taxi_rides_raw)
[0m16:13:35.593060 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.taxi_rides_raw
[0m16:13:35.595716 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m16:13:35.596162 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.taxi_rides_raw
[0m16:13:35.607419 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.taxi_rides_raw"
[0m16:13:35.607810 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m16:13:35.607929 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: BEGIN
[0m16:13:35.608036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:35.610934 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:13:35.611083 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m16:13:35.611220 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */

  
    
    

    create  table
      "dbt"."main"."taxi_rides_raw__dbt_tmp"
  
    as (
      
with source_data as
(select * from read_parquet('https://d37ci6vzurychx.cloudfront.net/trip-data/yellow_tripdata_2024-02.parquet'))

select * from source_data
    );
  
  
[0m16:13:36.759676 [debug] [Thread-1 (]: SQL status: OK in 1.148 seconds
[0m16:13:36.762881 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m16:13:36.763025 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
alter table "dbt"."main"."taxi_rides_raw__dbt_tmp" rename to "taxi_rides_raw"
[0m16:13:36.763763 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:13:36.768643 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m16:13:36.768788 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m16:13:36.768901 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: COMMIT
[0m16:13:36.772489 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:13:36.774712 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.taxi_rides_raw"
[0m16:13:36.774835 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.taxi_rides_raw"} */
drop table if exists "dbt"."main"."taxi_rides_raw__dbt_backup" cascade
[0m16:13:36.775051 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:36.776126 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.taxi_rides_raw: Close
[0m16:13:36.781174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c93c20>]}
[0m16:13:36.781491 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.taxi_rides_raw .......................... [[32mOK[0m in 1.19s]
[0m16:13:36.781718 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.taxi_rides_raw
[0m16:13:36.781873 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_amounts
[0m16:13:36.782137 [info ] [Thread-1 (]: 2 of 3 START sql view model main.total_amounts ................................. [RUN]
[0m16:13:36.782308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.taxi_rides_raw, now model.nyc_yellow_taxi.total_amounts)
[0m16:13:36.782437 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_amounts
[0m16:13:36.783617 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_amounts"
[0m16:13:36.784049 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_amounts
[0m16:13:36.790668 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_amounts"
[0m16:13:36.790923 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m16:13:36.791041 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: BEGIN
[0m16:13:36.791151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:36.794319 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:13:36.794465 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m16:13:36.794596 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */

  
  create view "dbt"."main"."total_amounts__dbt_tmp" as (
    select

  fare_amount,

  tip_amount,

  tolls_amount,

  total_amount

from taxi_rides_raw
  );

[0m16:13:36.794841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:36.795848 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m16:13:36.795977 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
alter view "dbt"."main"."total_amounts__dbt_tmp" rename to "total_amounts"
[0m16:13:36.796267 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:36.796828 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: COMMIT
[0m16:13:36.796948 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m16:13:36.797054 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: COMMIT
[0m16:13:36.797681 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m16:13:36.798372 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_amounts"
[0m16:13:36.798495 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_amounts"} */
drop view if exists "dbt"."main"."total_amounts__dbt_backup" cascade
[0m16:13:36.798695 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:36.799292 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_amounts: Close
[0m16:13:36.803094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073c31a0>]}
[0m16:13:36.803326 [info ] [Thread-1 (]: 2 of 3 OK created sql view model main.total_amounts ............................ [[32mOK[0m in 0.02s]
[0m16:13:36.803534 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_amounts
[0m16:13:36.803680 [debug] [Thread-1 (]: Began running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m16:13:36.803864 [info ] [Thread-1 (]: 3 of 3 START sql view model main.total_creditcard_riders_by_day ................ [RUN]
[0m16:13:36.804019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.nyc_yellow_taxi.total_amounts, now model.nyc_yellow_taxi.total_creditcard_riders_by_day)
[0m16:13:36.804145 [debug] [Thread-1 (]: Began compiling node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m16:13:36.805048 [debug] [Thread-1 (]: Writing injected SQL for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m16:13:36.805417 [debug] [Thread-1 (]: Began executing node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m16:13:36.806461 [debug] [Thread-1 (]: Writing runtime sql for node "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m16:13:36.806661 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m16:13:36.806776 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: BEGIN
[0m16:13:36.806882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:13:36.810003 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m16:13:36.810138 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m16:13:36.810270 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */

  
  create view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" as (
    select 
  date_part('day', tpep_pickup_datetime) as day,
  count(*) as total_cc_riders
from "dbt"."main"."taxi_rides_raw"
-- Refer to the Payment_type in schema doc
where payment_type = 1
group by day
  );

[0m16:13:36.810703 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:36.811703 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m16:13:36.811824 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
alter view "dbt"."main"."total_creditcard_riders_by_day__dbt_tmp" rename to "total_creditcard_riders_by_day"
[0m16:13:36.812001 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:36.812467 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m16:13:36.812579 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m16:13:36.812682 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: COMMIT
[0m16:13:36.812954 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:36.813677 [debug] [Thread-1 (]: Using duckdb connection "model.nyc_yellow_taxi.total_creditcard_riders_by_day"
[0m16:13:36.813801 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: /* {"app": "dbt", "dbt_version": "1.9.2", "profile_name": "nyc_yellow_taxi", "target_name": "dev", "node_id": "model.nyc_yellow_taxi.total_creditcard_riders_by_day"} */
drop view if exists "dbt"."main"."total_creditcard_riders_by_day__dbt_backup" cascade
[0m16:13:36.813962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m16:13:36.814401 [debug] [Thread-1 (]: On model.nyc_yellow_taxi.total_creditcard_riders_by_day: Close
[0m16:13:36.818267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42965cae-0b5f-4eb7-bca3-3bde6eeef8c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e1340>]}
[0m16:13:36.818517 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.total_creditcard_riders_by_day ........... [[32mOK[0m in 0.01s]
[0m16:13:36.818725 [debug] [Thread-1 (]: Finished running node model.nyc_yellow_taxi.total_creditcard_riders_by_day
[0m16:13:36.819211 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:36.819342 [debug] [MainThread]: On master: BEGIN
[0m16:13:36.819446 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:36.822714 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m16:13:36.822839 [debug] [MainThread]: On master: COMMIT
[0m16:13:36.822943 [debug] [MainThread]: Using duckdb connection "master"
[0m16:13:36.823041 [debug] [MainThread]: On master: COMMIT
[0m16:13:36.823220 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m16:13:36.823394 [debug] [MainThread]: On master: Close
[0m16:13:36.823879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:36.823988 [debug] [MainThread]: Connection 'model.nyc_yellow_taxi.total_creditcard_riders_by_day' was properly closed.
[0m16:13:36.824125 [info ] [MainThread]: 
[0m16:13:36.824246 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.33 seconds (1.33s).
[0m16:13:36.824576 [debug] [MainThread]: Command end result
[0m16:13:36.831640 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/manifest.json
[0m16:13:36.832283 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/semantic_manifest.json
[0m16:13:36.834521 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/williampetrosino/Git/DataCamp/analytics_engineer/nyc_yellow_taxi/target/run_results.json
[0m16:13:36.834624 [info ] [MainThread]: 
[0m16:13:36.834751 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:13:36.834855 [info ] [MainThread]: 
[0m16:13:36.834973 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:13:36.836076 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6406455, "process_in_blocks": "0", "process_kernel_time": 0.361139, "process_mem_max_rss": "506118144", "process_out_blocks": "0", "process_user_time": 2.209473}
[0m16:13:36.836297 [debug] [MainThread]: Command `dbt run` succeeded at 16:13:36.836263 after 1.64 seconds
[0m16:13:36.836437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b323f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba4260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba4290>]}
[0m16:13:36.836563 [debug] [MainThread]: Flushing usage events
[0m16:13:36.977759 [debug] [MainThread]: An error was encountered while trying to flush usage events
